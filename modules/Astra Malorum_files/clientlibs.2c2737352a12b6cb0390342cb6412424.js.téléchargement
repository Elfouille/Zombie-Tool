// api.js 

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

/**
 * API module for fetching map data and marker details.
 */
ATVI.components.mapguide.api = (() => {
    /**
     * Get the base URL depending on the environment.
     * @returns {string} The base API URL.
     */
    const getBaseUrl = () => {
        return window.location.hostname === "cmsauthor"
            ? "https://dev-map-vnext-server.kube.activision.com"
            : "https://map-vnext-server.infra-ext.activision.com";
    };

    /**
     * Fetch JSON data from a given URL.
     * @param {string} url - The API endpoint URL.
     * @returns {Promise<Object|undefined>} Parsed JSON response or undefined on error.
     */
    const fetchJson = async (url) => {
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`Response status: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            console.error(error.message);
        }
    };

    /**
     * Normalize mapPath for AEM rewrites.
     * @param {string} mapPath - Original map path.
     * @returns {string} Normalized map path.
     */
    const normalizeMapPath = (mapPath) => {
        if (mapPath.startsWith("aem:")) {
            mapPath = mapPath.replace("aem:", "");
            if (mapPath.startsWith("/guides/")) {
                mapPath = mapPath.replace("/guides/", "/content/atvi/callofduty/guides/web/en/");
            }
        }
        return mapPath;
    };

    return {
        /**
         * Fetch map data for a given path.
         * @param {string} mapPath - The map path to fetch data for.
         * @returns {Promise<Object|undefined>} Map data JSON or undefined on error.
         */
        getMapData: async (mapPath) => {
            console.log("Fetching map data for path:", mapPath);
            const normalizedPath = normalizeMapPath(mapPath);
            const url = `${getBaseUrl()}/mapdata/all?mapPath=${encodeURIComponent(normalizedPath)}`;
            return await fetchJson(url);
        },

        /**
         * Fetch marker details by marker ID.
         * @param {string} markerId - The marker ID.
         * @returns {Promise<Object|undefined>} Marker details JSON or undefined on error.
         */
        getMarkerDetails: async (markerId) => {
            const url = `${getBaseUrl()}/mapdata/details?mapId=${markerId}`;
            return await fetchJson(url);
        },
    };
})();

// icons.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

// Create icon registry under the same namespace
ATVI.components.mapguide.icons = {
    "icon-ammo": `
        <svg class="icon icon-ammo" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12.3545 1.07812C12.5486 1.07812 12.7267 1.17213 12.8379 1.32324L12.8818 1.3916L13.1973 1.98926C13.4925 2.5717 13.727 3.11989 13.9014 3.74023C14.1334 4.56613 14.2534 5.49594 14.2969 6.78027C14.3014 6.91563 14.2504 7.04716 14.1562 7.14453C14.0621 7.2419 13.9324 7.29688 13.7969 7.29688H10.2188C10.081 7.29688 9.94897 7.23991 9.85449 7.13965C9.76025 7.0395 9.71167 6.90485 9.71973 6.76758C9.79215 5.54904 9.92422 4.60405 10.1758 3.75488C10.4288 2.90071 10.7959 2.16433 11.3145 1.35449L11.3594 1.29395C11.472 1.15897 11.6402 1.07812 11.8203 1.07812H12.3545ZM14.5781 21.9219C14.5781 22.4742 14.1304 22.9219 13.5781 22.9219H10.4219C9.86959 22.9219 9.42188 22.4742 9.42188 21.9219V9.67188C9.42188 9.62773 9.42791 9.58363 9.43945 9.54102L9.8457 8.04102C9.90479 7.82317 10.1024 7.67188 10.3281 7.67188H13.7969C14.0375 7.67188 14.2437 7.84359 14.2881 8.08008L14.5693 9.58008C14.575 9.61037 14.5781 9.64106 14.5781 9.67188V21.9219Z" fill="white" stroke="black" stroke-linejoin="round"/>
            <path d="M19.041 4.29688C19.2274 4.29688 19.3983 4.38722 19.5049 4.53223L19.5469 4.59668L19.7871 5.05176C20.0126 5.49641 20.1926 5.9187 20.3271 6.39746C20.5062 7.03449 20.5979 7.74779 20.6309 8.72363C20.6354 8.85901 20.5844 8.9905 20.4902 9.08789C20.396 9.18518 20.2663 9.24023 20.1309 9.24023H17.4277C17.29 9.24023 17.158 9.18327 17.0635 9.08301C16.9692 8.98284 16.9206 8.84829 16.9287 8.71094C16.9837 7.78565 17.0845 7.06141 17.2783 6.40723C17.4736 5.74814 17.7562 5.18115 18.1523 4.5625C18.2574 4.3984 18.4403 4.29688 18.6377 4.29688H19.041ZM20.8438 20.1689C20.8438 20.6537 20.4506 21.0469 19.9658 21.0469H17.5811C17.0963 21.0469 16.7031 20.6537 16.7031 20.1689V10.9131C16.7031 10.869 16.7092 10.8248 16.7207 10.7822L17.0273 9.64844L17.0557 9.57031C17.1361 9.39529 17.3122 9.27943 17.5098 9.2793H20.1309L20.2197 9.28711C20.421 9.32321 20.5843 9.48064 20.623 9.6875L20.835 10.8203C20.8407 10.8507 20.8438 10.8822 20.8438 10.9131V20.1689Z" fill="white" stroke="black" stroke-linejoin="round"/>
            <path d="M5.49426 4.29688C5.68067 4.29688 5.85155 4.38722 5.95813 4.53223L6.00012 4.59668L6.24036 5.05176C6.4658 5.49641 6.64585 5.9187 6.7804 6.39746C6.95941 7.03449 7.0511 7.74779 7.08411 8.72363C7.08862 8.85901 7.03763 8.9905 6.94348 9.08789C6.84929 9.18518 6.71953 9.24023 6.58411 9.24023H3.88098C3.74322 9.24023 3.6112 9.18327 3.51672 9.08301C3.4224 8.98284 3.37388 8.84829 3.38196 8.71094C3.43695 7.78565 3.53778 7.06141 3.73157 6.40723C3.92682 5.74814 4.20948 5.18115 4.60559 4.5625C4.71067 4.3984 4.89359 4.29688 5.09094 4.29688H5.49426ZM7.297 20.1689C7.297 20.6537 6.90387 21.0469 6.41907 21.0469H4.0343C3.5495 21.0469 3.15637 20.6537 3.15637 20.1689V10.9131C3.15637 10.869 3.16244 10.8248 3.17395 10.7822L3.48059 9.64844L3.50891 9.57031C3.5893 9.39529 3.76547 9.27943 3.96301 9.2793H6.58411L6.67297 9.28711C6.87421 9.32321 7.03751 9.48064 7.07629 9.6875L7.28821 10.8203C7.29391 10.8507 7.297 10.8822 7.297 10.9131V20.1689Z" fill="white" stroke="black" stroke-linejoin="round"/>
        </svg>
    `,
    "icon-armor": `
        <svg class="icon icon-armor" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.8467 12.2744H20.5889V15.1201H19.8486V16.209H20.5889V19.0547H19.8486V21.1348L19.7021 21.2812C19.4268 21.5565 18.9764 21.7402 18.5039 21.877C18.008 22.0205 17.3962 22.1364 16.7168 22.2275C15.3557 22.41 13.674 22.5 12.001 22.5C10.3279 22.5 8.64629 22.41 7.28516 22.2275C6.60555 22.1364 5.99311 22.0205 5.49707 21.877C5.02464 21.7402 4.57408 21.5565 4.29883 21.2812L4.15234 21.1348V19.0547H3.41113V16.209H4.15234V15.1201H3.41113V12.2744H4.15234V10.251L4.33301 10.1006C5.17995 9.39394 5.72412 8.38948 5.85254 7.29395C5.98095 6.19814 5.68339 5.09437 5.02246 4.21094L4.63867 3.69824L5.23047 3.4502L5.70312 3.25293L5.92871 3.1582L5.8252 2.90527L5.63477 2.44238L6.09766 2.25293L7.80566 1.55176L8.26758 1.3623L8.45801 1.8252L8.55371 2.05957L8.77148 1.96875L9.11719 1.82324L9.53027 1.65137L9.74805 2.04199C9.97121 2.44367 10.2973 2.77866 10.6934 3.01172C11.0893 3.24472 11.5406 3.36712 12 3.36719C12.4596 3.36719 12.9115 3.24478 13.3076 3.01172C13.7036 2.77866 14.0298 2.44365 14.2529 2.04199L14.4697 1.65234L14.8809 1.82324L15.2168 1.96191L15.4453 2.05566L15.5547 1.80273L15.7529 1.34277L16.2119 1.54102L17.9082 2.27051L18.3672 2.46875L18.1689 2.92773L18.0713 3.15332L18.2871 3.24414L18.7695 3.44629L19.3613 3.69434L18.9775 4.20703C18.3166 5.09047 18.0191 6.19423 18.1475 7.29004C18.2759 8.38561 18.82 9.39003 19.667 10.0967L19.8467 10.2471V12.2744Z" fill="white" stroke="white"/>
            <path d="M16.0144 2.00004L14.4423 5.65209L16.138 6.38197L17.71 2.72992L16.0144 2.00004ZM7.99513 2.0146L6.28729 2.71536L7.79665 6.39372L9.50449 5.69296L7.99513 2.0146ZM9.31057 2.28494L8.96432 2.42978L10.1892 5.41559L10.4701 6.10077L9.78556 6.37988L8.07785 7.08064L7.39271 7.36163L7.11173 6.67662L5.89566 3.71393L5.42309 3.91164C6.16072 4.89759 6.49201 6.12894 6.3487 7.35192C6.20539 8.57489 5.59839 9.69629 4.65281 10.485V12.0377H8.63386V15.3604H4.65276V15.9677H8.63382V19.2952H4.65276V20.9274C5.368 21.6426 8.68427 22 12.0006 22C15.3169 22 18.6332 21.6426 19.3485 20.9274V19.2952H15.3673V15.9683H19.3485V15.3604H15.3661V12.0334H19.347V10.4811C18.4014 9.69241 17.7944 8.57101 17.6511 7.34804C17.5078 6.12507 17.8391 4.89372 18.5767 3.90776L18.094 3.70554L16.8168 6.67232L16.5237 7.3529L15.8432 7.05987L14.1499 6.33356L13.4694 6.04053L13.7624 5.35999L15.0262 2.42369L14.6902 2.2849C14.4237 2.76459 14.0338 3.16429 13.5608 3.44257C13.0879 3.72086 12.5491 3.8676 12.0004 3.8676C11.4516 3.8676 10.9129 3.72086 10.4399 3.44257C9.96698 3.16429 9.57706 2.76463 9.31057 2.28494ZM3.91113 12.7741V14.6202H7.89359V12.7741H3.91113ZM16.1066 12.7741V14.6202H20.0891V12.7741H16.1066ZM3.91113 16.7089V18.555H7.89359V16.7088L3.91113 16.7089ZM16.1066 16.7089V18.555H20.0891V16.7088L16.1066 16.7089Z" fill="black"/>
        </svg>
    `,
    "icon-arsenal": `
        <svg class="icon icon-arsenal" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1465_3088)">
            <circle cx="12" cy="12" r="11.35" fill="white" stroke="black" stroke-width="1.3"/>
            <path d="M13 3.5C14.9469 5.52936 16.268 6.13831 19.2812 5.71875V14.7188C19.0601 16.4143 17.2542 18.0899 14.958 19.0479L13.7236 15.8076C13.794 15.6812 13.8638 15.595 13.9395 15.5254C14.0509 15.423 14.2041 15.3293 14.4648 15.2158C14.6473 15.1364 14.7656 14.9568 14.7656 14.7578V14.1104C14.7695 14.1068 14.7744 14.1042 14.7783 14.1006C14.8328 14.0499 14.9018 13.9794 14.9609 13.8975C15.0082 13.832 15.1094 13.679 15.1094 13.4766C15.1094 13.3533 15.0667 13.2594 15.0459 13.2178C15.021 13.1679 14.9926 13.1254 14.9697 13.0947C14.9236 13.033 14.8675 12.9734 14.8164 12.9219C14.7121 12.8167 14.5807 12.7012 14.459 12.5986C14.3537 12.5098 14.2491 12.4249 14.1641 12.3574V12.1641C14.1641 11.9173 13.9841 11.7075 13.7402 11.6699L12.7715 11.5215C12.6576 11.504 12.5407 11.5265 12.4414 11.585L12.1211 11.7744L6.875 11.7822V5.71875C9.92045 6.08085 11.2251 5.5261 13 3.5Z" fill="black"/>
            <path d="M13.6641 12.1641V12.6016C13.6641 12.6016 14.6094 13.3203 14.6094 13.4766C14.6094 13.6328 14.2656 13.875 14.2656 13.875V14.7578C13.7011 15.0036 13.4215 15.2346 13.1797 15.7812L14.9062 20.3125L11.5547 21.375L10.5781 16.9766H7.71875L7.48438 15.6016L7.16406 15.3047H5.69531V14.9922H2.63281V13.8828H2.33594V12.9297L2.78125 12.2891L12.2578 12.2734L12.6953 12.0156L13.6641 12.1641ZM8.41602 14.9688C8.1951 14.9688 8.01562 15.1482 8.01562 15.3691V15.9902C8.01562 16.2111 8.1951 16.3906 8.41602 16.3906H10.0215C10.2424 16.3906 10.4219 16.2111 10.4219 15.9902V15.3691C10.4219 15.1482 10.2424 14.9688 10.0215 14.9688H9.89062C9.89738 15.5061 9.81241 15.7908 9.32812 16.2031H8.57812C9.1708 15.9715 9.29698 15.7189 9.07812 14.9688H8.41602Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1465_3088">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-crafting-table": `
        <svg class="icon icon-crafting-table" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1465_6577)">
            <circle cx="12" cy="12" r="11.35" fill="white" stroke="black" stroke-width="1.3"/>
            <path d="M18.2507 12.0313C18.3759 12.0108 18.6256 12.0699 18.6257 12.4688V14.125C17.7925 14.2813 15.9946 15.0628 15.4695 16.9375L15.488 16.9766H14.946C14.6096 16.9766 14.3369 17.2496 14.3367 17.586C14.3369 17.9223 14.6096 18.1953 14.946 18.1953H16.0525L16.0632 18.2188L16.8757 19.125C16.9483 19.323 16.8868 19.6871 16.0632 19.5625H7.50073C7.31323 19.5521 6.98187 19.4315 7.35229 18.9375C7.56336 18.6563 8.03198 18.2188 8.03198 18.2188V18.1953H8.78979C9.12587 18.195 9.39894 17.9221 9.39917 17.586C9.39897 17.2498 9.12588 16.977 8.78979 16.9766H8.03198V16.1563L3.72729 13.0782C3.39142 12.836 3.30793 12.5941 3.39135 12.375H7.80542C7.76668 12.25 7.93835 12.0459 8.21069 12.0459C8.66626 12.0459 15.096 12.0313 18.2507 12.0313ZM9.78881 3.16995C10.1106 3.0701 10.4373 3.31058 10.4373 3.64749V10.1748C10.4373 10.2853 10.3475 10.375 10.2371 10.375H8.19995C8.08951 10.375 7.99975 10.2853 7.99975 10.1748V5.25003L9.47338 3.3262C9.51116 3.27686 9.56345 3.24013 9.6228 3.22171L9.78881 3.16995ZM17.8435 6.40628C18.1196 6.40628 18.3435 6.63014 18.3435 6.90628V7.62503C18.3435 7.90116 18.1196 8.12503 17.8435 8.12503H11.0935V6.40628H17.8435Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1465_6577">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-door-buy": `
        <svg class="icon icon-door-buy" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1465_6621)">
            <path d="M22.2812 20.9062H23.7227V22.125H4.71875V20.9062H6.125V0.5625H22.2812V20.9062Z" fill="black"/>
            <rect x="7.21875" y="1.6875" width="13.9688" height="19.3125" fill="white"/>
            <path d="M20.1875 3.09375V21H8.28125V20H7.1875V3.9375H8.28125V2.9375H19.3086L20.1875 3.09375Z" fill="black"/>
            <mask id="path-4-outside-1_1465_6621" maskUnits="userSpaceOnUse" x="11.6562" y="0.21875" width="9" height="24" fill="black">
            <rect fill="white" x="11.6562" y="0.21875" width="9" height="24"/>
            <path d="M19.0938 3.9375V20.9375L13.6562 22.3125V2.21875L19.0938 3.9375ZM15.2344 10.9688C14.8806 10.9688 14.5938 11.3885 14.5938 11.9062C14.5938 12.424 14.8806 12.8438 15.2344 12.8438C15.5882 12.8438 15.875 12.424 15.875 11.9062C15.875 11.3885 15.5882 10.9688 15.2344 10.9688Z"/>
            </mask>
            <path d="M19.0938 3.9375V20.9375L13.6562 22.3125V2.21875L19.0938 3.9375ZM15.2344 10.9688C14.8806 10.9688 14.5938 11.3885 14.5938 11.9062C14.5938 12.424 14.8806 12.8438 15.2344 12.8438C15.5882 12.8438 15.875 12.424 15.875 11.9062C15.875 11.3885 15.5882 10.9688 15.2344 10.9688Z" fill="white"/>
            <path d="M19.0938 3.9375H20.2937V3.05829L19.4554 2.7933L19.0938 3.9375ZM19.0938 20.9375L19.3879 22.1009L20.2937 21.8718V20.9375H19.0938ZM13.6562 22.3125H12.4562V23.8537L13.9504 23.4759L13.6562 22.3125ZM13.6562 2.21875L14.0179 1.07455L12.4562 0.580918V2.21875H13.6562ZM19.0938 3.9375H17.8938V20.9375H19.0938H20.2937V3.9375H19.0938ZM19.0938 20.9375L18.7996 19.7741L13.3621 21.1491L13.6562 22.3125L13.9504 23.4759L19.3879 22.1009L19.0938 20.9375ZM13.6562 22.3125H14.8563V2.21875H13.6562H12.4562V22.3125H13.6562ZM13.6562 2.21875L13.2946 3.36295L18.7321 5.0817L19.0938 3.9375L19.4554 2.7933L14.0179 1.07455L13.6562 2.21875ZM15.2344 10.9688V9.76875C14.5452 9.76875 14.0557 10.1784 13.7906 10.5663C13.5215 10.9601 13.3937 11.4374 13.3937 11.9062H14.5938H15.7938C15.7938 11.8573 15.8094 11.8659 15.7722 11.9204C15.739 11.9689 15.5698 12.1687 15.2344 12.1687V10.9688ZM14.5938 11.9062H13.3937C13.3937 12.3751 13.5215 12.8524 13.7906 13.2462C14.0557 13.6341 14.5452 14.0437 15.2344 14.0437V12.8438V11.6438C15.5698 11.6438 15.739 11.8436 15.7722 11.8921C15.8094 11.9466 15.7938 11.9552 15.7938 11.9062H14.5938ZM15.2344 12.8438V14.0437C15.9236 14.0437 16.4131 13.6341 16.6781 13.2462C16.9472 12.8524 17.075 12.3751 17.075 11.9062H15.875H14.675C14.675 11.9552 14.6594 11.9466 14.6966 11.8921C14.7298 11.8436 14.899 11.6438 15.2344 11.6438V12.8438ZM15.875 11.9062H17.075C17.075 11.4374 16.9472 10.9601 16.6781 10.5663C16.4131 10.1784 15.9236 9.76875 15.2344 9.76875V10.9688V12.1687C14.899 12.1687 14.7298 11.9689 14.6966 11.9204C14.6594 11.8659 14.675 11.8573 14.675 11.9062H15.875Z" fill="black" mask="url(#path-4-outside-1_1465_6621)"/>
            <mask id="path-6-outside-2_1465_6621" maskUnits="userSpaceOnUse" x="-0.40625" y="3.1875" width="13" height="17" fill="black">
            <rect fill="white" x="-0.40625" y="3.1875" width="13" height="17"/>
            <path d="M5.4375 7.4375H7V5.1875H8.28125V7.4375H10.8438V8.875L8.28125 11.3506V15.125H10.8438V16.5H8.28125V18.75H7V16.5H5.4375V18.75H4.15625V16.5H1.59375V15.2812L4.15625 12.6123V8.875H1.59375V7.4375H4.15625V5.1875H5.4375V7.4375ZM5.4375 14.0977V15.125H7V12.5879L5.4375 14.0977ZM5.4375 11.2783L6.90625 9.75V8.875H5.4375V11.2783Z"/>
            </mask>
            <path d="M5.4375 7.4375H7V5.1875H8.28125V7.4375H10.8438V8.875L8.28125 11.3506V15.125H10.8438V16.5H8.28125V18.75H7V16.5H5.4375V18.75H4.15625V16.5H1.59375V15.2812L4.15625 12.6123V8.875H1.59375V7.4375H4.15625V5.1875H5.4375V7.4375ZM5.4375 14.0977V15.125H7V12.5879L5.4375 14.0977ZM5.4375 11.2783L6.90625 9.75V8.875H5.4375V11.2783Z" fill="white"/>
            <path d="M5.4375 7.4375H4.2375C4.2375 8.10024 4.77476 8.6375 5.4375 8.6375V7.4375ZM7 7.4375V8.6375C7.66274 8.6375 8.2 8.10024 8.2 7.4375H7ZM7 5.1875V3.9875C6.33726 3.9875 5.8 4.52476 5.8 5.1875H7ZM8.28125 5.1875H9.48125C9.48125 4.52476 8.94399 3.9875 8.28125 3.9875V5.1875ZM8.28125 7.4375H7.08125C7.08125 8.10024 7.61851 8.6375 8.28125 8.6375V7.4375ZM10.8438 7.4375H12.0437C12.0437 6.77476 11.5065 6.2375 10.8438 6.2375V7.4375ZM10.8438 8.875L11.6775 9.73804C11.9116 9.51192 12.0437 9.20044 12.0437 8.875H10.8438ZM8.28125 11.3506L7.44748 10.4875C7.21343 10.7137 7.08125 11.0251 7.08125 11.3506H8.28125ZM8.28125 15.125H7.08125C7.08125 15.7877 7.61851 16.325 8.28125 16.325V15.125ZM10.8438 15.125H12.0437C12.0437 14.4623 11.5065 13.925 10.8438 13.925V15.125ZM10.8438 16.5V17.7C11.5065 17.7 12.0437 17.1627 12.0437 16.5H10.8438ZM8.28125 16.5V15.3C7.61851 15.3 7.08125 15.8373 7.08125 16.5H8.28125ZM8.28125 18.75V19.95C8.94399 19.95 9.48125 19.4127 9.48125 18.75H8.28125ZM7 18.75H5.8C5.8 19.4127 6.33726 19.95 7 19.95V18.75ZM7 16.5H8.2C8.2 15.8373 7.66274 15.3 7 15.3V16.5ZM5.4375 16.5V15.3C4.77476 15.3 4.2375 15.8373 4.2375 16.5H5.4375ZM5.4375 18.75V19.95C6.10024 19.95 6.6375 19.4127 6.6375 18.75H5.4375ZM4.15625 18.75H2.95625C2.95625 19.4127 3.49351 19.95 4.15625 19.95V18.75ZM4.15625 16.5H5.35625C5.35625 15.8373 4.81899 15.3 4.15625 15.3V16.5ZM1.59375 16.5H0.39375C0.39375 17.1627 0.931008 17.7 1.59375 17.7L1.59375 16.5ZM1.59375 15.2812L0.728136 14.4502C0.51357 14.6736 0.39375 14.9714 0.39375 15.2812H1.59375ZM4.15625 12.6123L5.02186 13.4434C5.23643 13.2199 5.35625 12.9221 5.35625 12.6123H4.15625ZM4.15625 8.875H5.35625C5.35625 8.21226 4.81899 7.675 4.15625 7.675V8.875ZM1.59375 8.875H0.39375C0.39375 9.53774 0.931008 10.075 1.59375 10.075L1.59375 8.875ZM1.59375 7.4375V6.2375C0.931008 6.2375 0.39375 6.77476 0.39375 7.4375H1.59375ZM4.15625 7.4375V8.6375C4.81899 8.6375 5.35625 8.10024 5.35625 7.4375H4.15625ZM4.15625 5.1875V3.9875C3.49351 3.9875 2.95625 4.52476 2.95625 5.1875H4.15625ZM5.4375 5.1875H6.6375C6.6375 4.52476 6.10024 3.9875 5.4375 3.9875V5.1875ZM5.4375 14.0977L4.60366 13.2347C4.36965 13.4608 4.2375 13.7723 4.2375 14.0977H5.4375ZM5.4375 15.125H4.2375C4.2375 15.7877 4.77476 16.325 5.4375 16.325V15.125ZM7 15.125V16.325C7.66274 16.325 8.2 15.7877 8.2 15.125H7ZM7 12.5879H8.2C8.2 12.1063 7.91207 11.6713 7.46872 11.4832C7.02537 11.2951 6.5125 11.3903 6.16616 11.7249L7 12.5879ZM5.4375 11.2783H4.2375C4.2375 11.768 4.53506 12.2086 4.98932 12.3915C5.44358 12.5744 5.9634 12.4629 6.30272 12.1098L5.4375 11.2783ZM6.90625 9.75L7.77147 10.5815C7.98628 10.358 8.10625 10.06 8.10625 9.75H6.90625ZM6.90625 8.875H8.10625C8.10625 8.21226 7.56899 7.675 6.90625 7.675V8.875ZM5.4375 8.875V7.675C4.77476 7.675 4.2375 8.21226 4.2375 8.875H5.4375ZM5.4375 7.4375V8.6375H7V7.4375V6.2375H5.4375V7.4375ZM7 7.4375H8.2V5.1875H7H5.8V7.4375H7ZM7 5.1875V6.3875H8.28125V5.1875V3.9875H7V5.1875ZM8.28125 5.1875H7.08125V7.4375H8.28125H9.48125V5.1875H8.28125ZM8.28125 7.4375V8.6375H10.8438V7.4375V6.2375H8.28125V7.4375ZM10.8438 7.4375H9.64375V8.875H10.8438H12.0437V7.4375H10.8438ZM10.8438 8.875L10.01 8.01196L7.44748 10.4875L8.28125 11.3506L9.11502 12.2136L11.6775 9.73804L10.8438 8.875ZM8.28125 11.3506H7.08125V15.125H8.28125H9.48125V11.3506H8.28125ZM8.28125 15.125V16.325H10.8438V15.125V13.925H8.28125V15.125ZM10.8438 15.125H9.64375V16.5H10.8438H12.0437V15.125H10.8438ZM10.8438 16.5V15.3H8.28125V16.5V17.7H10.8438V16.5ZM8.28125 16.5H7.08125V18.75H8.28125H9.48125V16.5H8.28125ZM8.28125 18.75V17.55H7V18.75V19.95H8.28125V18.75ZM7 18.75H8.2V16.5H7H5.8V18.75H7ZM7 16.5V15.3H5.4375V16.5V17.7H7V16.5ZM5.4375 16.5H4.2375V18.75H5.4375H6.6375V16.5H5.4375ZM5.4375 18.75V17.55H4.15625V18.75V19.95H5.4375V18.75ZM4.15625 18.75H5.35625V16.5H4.15625H2.95625V18.75H4.15625ZM4.15625 16.5V15.3H1.59375V16.5V17.7H4.15625V16.5ZM1.59375 16.5H2.79375V15.2812H1.59375H0.39375V16.5H1.59375ZM1.59375 15.2812L2.45936 16.1123L5.02186 13.4434L4.15625 12.6123L3.29064 11.7812L0.728136 14.4502L1.59375 15.2812ZM4.15625 12.6123H5.35625V8.875H4.15625H2.95625V12.6123H4.15625ZM4.15625 8.875V7.675H1.59375V8.875V10.075H4.15625V8.875ZM1.59375 8.875H2.79375V7.4375H1.59375H0.39375V8.875H1.59375ZM1.59375 7.4375V8.6375H4.15625V7.4375V6.2375H1.59375V7.4375ZM4.15625 7.4375H5.35625V5.1875H4.15625H2.95625V7.4375H4.15625ZM4.15625 5.1875V6.3875H5.4375V5.1875V3.9875H4.15625V5.1875ZM5.4375 5.1875H4.2375V7.4375H5.4375H6.6375V5.1875H5.4375ZM5.4375 14.0977H4.2375V15.125H5.4375H6.6375V14.0977H5.4375ZM5.4375 15.125V16.325H7V15.125V13.925H5.4375V15.125ZM7 15.125H8.2V12.5879H7H5.8V15.125H7ZM7 12.5879L6.16616 11.7249L4.60366 13.2347L5.4375 14.0977L6.27134 14.9606L7.83384 13.4509L7 12.5879ZM5.4375 11.2783L6.30272 12.1098L7.77147 10.5815L6.90625 9.75L6.04103 8.9185L4.57228 10.4468L5.4375 11.2783ZM6.90625 9.75H8.10625V8.875H6.90625H5.70625V9.75H6.90625ZM6.90625 8.875V7.675H5.4375V8.875V10.075H6.90625V8.875ZM5.4375 8.875H4.2375V11.2783H5.4375H6.6375V8.875H5.4375Z" fill="black" mask="url(#path-6-outside-2_1465_6621)"/>
            </g>
            <defs>
            <clipPath id="clip0_1465_6621">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-exfil-radio": `
        <svg class="icon icon-exfil-radio" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <mask id="path-1-outside-1_1461_13330" maskUnits="userSpaceOnUse" x="6.54346" y="1" width="11" height="22" fill="black">
            <rect fill="white" x="6.54346" y="1" width="11" height="22"/>
            <path d="M16.2202 7.84473C16.3505 7.84492 16.4563 7.95077 16.4565 8.08105V16.6768C16.4565 16.729 16.4387 16.7799 16.4067 16.8213L15.5981 17.8672C15.5661 17.9085 15.5484 17.9594 15.5483 18.0117V21.7637C15.5483 21.8942 15.4426 22 15.312 22H8.52686C8.39364 22 8.28672 21.89 8.29053 21.7568L8.39795 18.0117C8.39938 17.9595 8.38285 17.9085 8.35205 17.8662L7.58936 16.8203C7.55981 16.7798 7.54346 16.7308 7.54346 16.6807V8.08105C7.54365 7.95068 7.64938 7.84477 7.77979 7.84473H16.2202ZM9.02881 2C9.23458 2 9.40186 2.16728 9.40186 2.37305V6.07324H9.8667V7.12109H8.18994V6.07324H8.65674V2.37305C8.65674 2.16735 8.82314 2.00012 9.02881 2ZM15.7349 7.12109H14.0591V6.07324H15.7349V7.12109Z"/>
            </mask>
            <path d="M16.2202 7.84473C16.3505 7.84492 16.4563 7.95077 16.4565 8.08105V16.6768C16.4565 16.729 16.4387 16.7799 16.4067 16.8213L15.5981 17.8672C15.5661 17.9085 15.5484 17.9594 15.5483 18.0117V21.7637C15.5483 21.8942 15.4426 22 15.312 22H8.52686C8.39364 22 8.28672 21.89 8.29053 21.7568L8.39795 18.0117C8.39938 17.9595 8.38285 17.9085 8.35205 17.8662L7.58936 16.8203C7.55981 16.7798 7.54346 16.7308 7.54346 16.6807V8.08105C7.54365 7.95068 7.64938 7.84477 7.77979 7.84473H16.2202ZM9.02881 2C9.23458 2 9.40186 2.16728 9.40186 2.37305V6.07324H9.8667V7.12109H8.18994V6.07324H8.65674V2.37305C8.65674 2.16735 8.82314 2.00012 9.02881 2ZM15.7349 7.12109H14.0591V6.07324H15.7349V7.12109Z" fill="white"/>
            <path d="M16.2202 7.84473L16.2217 6.84473H16.2202V7.84473ZM16.4565 8.08105H17.4565L17.4565 8.07957L16.4565 8.08105ZM16.4067 16.8213L17.1979 17.4329L17.1985 17.4322L16.4067 16.8213ZM15.5981 17.8672L16.3891 18.4791L16.3893 18.4788L15.5981 17.8672ZM15.5483 18.0117L14.5483 18.0108V18.0117H15.5483ZM15.5483 21.7637L16.5483 21.7639V21.7637H15.5483ZM8.29053 21.7568L7.29094 21.7282L7.29094 21.7282L8.29053 21.7568ZM8.39795 18.0117L9.39754 18.0404L9.39757 18.0391L8.39795 18.0117ZM8.35205 17.8662L9.16011 17.2771L9.16004 17.277L8.35205 17.8662ZM7.58936 16.8203L8.39734 16.2311L8.39703 16.2307L7.58936 16.8203ZM7.54346 8.08105L6.54346 8.07957V8.08105H7.54346ZM7.77979 7.84473V6.84473H7.77943L7.77979 7.84473ZM9.02881 2V1L9.02822 1L9.02881 2ZM9.40186 6.07324H8.40186V7.07324H9.40186V6.07324ZM9.8667 6.07324H10.8667V5.07324H9.8667V6.07324ZM9.8667 7.12109V8.12109H10.8667V7.12109H9.8667ZM8.18994 7.12109H7.18994V8.12109H8.18994V7.12109ZM8.18994 6.07324V5.07324H7.18994V6.07324H8.18994ZM8.65674 6.07324V7.07324H9.65674V6.07324H8.65674ZM15.7349 7.12109V8.12109H16.7349V7.12109H15.7349ZM14.0591 7.12109H13.0591V8.12109H14.0591V7.12109ZM14.0591 6.07324V5.07324H13.0591V6.07324H14.0591ZM15.7349 6.07324H16.7349V5.07324H15.7349V6.07324ZM16.2202 7.84473L16.2188 8.84473C15.7979 8.84411 15.4572 8.50335 15.4565 8.08254L16.4565 8.08105L17.4565 8.07957C17.4555 7.39819 16.9031 6.84572 16.2217 6.84473L16.2202 7.84473ZM16.4565 8.08105H15.4565V16.6768H16.4565H17.4565V8.08105H16.4565ZM16.4565 16.6768H15.4565C15.4565 16.5012 15.5161 16.3386 15.615 16.2104L16.4067 16.8213L17.1985 17.4322C17.3612 17.2212 17.4565 16.9568 17.4565 16.6768H16.4565ZM16.4067 16.8213L15.6156 16.2097L14.807 17.2556L15.5981 17.8672L16.3893 18.4788L17.1979 17.4329L16.4067 16.8213ZM15.5981 17.8672L14.8072 17.2553C14.6426 17.468 14.5486 17.7329 14.5483 18.0108L15.5483 18.0117L16.5483 18.0126C16.5482 18.186 16.4897 18.3491 16.3891 18.4791L15.5981 17.8672ZM15.5483 18.0117H14.5483V21.7637H15.5483H16.5483V18.0117H15.5483ZM15.5483 21.7637L14.5483 21.7635C14.5484 21.3421 14.8901 21 15.312 21V22V23C15.995 23 16.5482 22.4464 16.5483 21.7639L15.5483 21.7637ZM15.312 22V21H8.52686V22V23H15.312V22ZM8.52686 22V21C8.957 21 9.30243 21.3552 9.29012 21.7854L8.29053 21.7568L7.29094 21.7282C7.271 22.4248 7.83028 23 8.52686 23V22ZM8.29053 21.7568L9.29012 21.7855L9.39754 18.0404L8.39795 18.0117L7.39836 17.983L7.29094 21.7282L8.29053 21.7568ZM8.39795 18.0117L9.39757 18.0391C9.40531 17.757 9.31585 17.4907 9.16011 17.2771L8.35205 17.8662L7.54399 18.4553C7.44984 18.3262 7.39346 18.1619 7.39832 17.9843L8.39795 18.0117ZM8.35205 17.8662L9.16004 17.277L8.39734 16.2311L7.58936 16.8203L6.78137 17.4095L7.54407 18.4554L8.35205 17.8662ZM7.58936 16.8203L8.39703 16.2307C8.48969 16.3576 8.54346 16.5142 8.54346 16.6807H7.54346H6.54346C6.54346 16.9474 6.62993 17.2021 6.78168 17.4099L7.58936 16.8203ZM7.54346 16.6807H8.54346V8.08105H7.54346H6.54346V16.6807H7.54346ZM7.54346 8.08105L8.54346 8.08254C8.54283 8.50216 8.20286 8.84458 7.78014 8.84473L7.77979 7.84473L7.77943 6.84473C7.09589 6.84497 6.54447 7.3992 6.54346 8.07957L7.54346 8.08105ZM7.77979 7.84473V8.84473H16.2202V7.84473V6.84473H7.77979V7.84473ZM9.02881 2V3C8.6823 3 8.40186 2.71956 8.40186 2.37305H9.40186H10.4019C10.4019 1.61499 9.78686 1 9.02881 1V2ZM9.40186 2.37305H8.40186V6.07324H9.40186H10.4019V2.37305H9.40186ZM9.40186 6.07324V7.07324H9.8667V6.07324V5.07324H9.40186V6.07324ZM9.8667 6.07324H8.8667V7.12109H9.8667H10.8667V6.07324H9.8667ZM9.8667 7.12109V6.12109H8.18994V7.12109V8.12109H9.8667V7.12109ZM8.18994 7.12109H9.18994V6.07324H8.18994H7.18994V7.12109H8.18994ZM8.18994 6.07324V7.07324H8.65674V6.07324V5.07324H8.18994V6.07324ZM8.65674 6.07324H9.65674V2.37305H8.65674H7.65674V6.07324H8.65674ZM8.65674 2.37305H9.65674C9.65674 2.7168 9.37838 2.9998 9.02939 3L9.02881 2L9.02822 1C8.2679 1.00044 7.65674 1.6179 7.65674 2.37305H8.65674ZM15.7349 7.12109V6.12109H14.0591V7.12109V8.12109H15.7349V7.12109ZM14.0591 7.12109H15.0591V6.07324H14.0591H13.0591V7.12109H14.0591ZM14.0591 6.07324V7.07324H15.7349V6.07324V5.07324H14.0591V6.07324ZM15.7349 6.07324H14.7349V7.12109H15.7349H16.7349V6.07324H15.7349Z" fill="black" mask="url(#path-1-outside-1_1461_13330)"/>
            <rect x="9.21725" y="9.58536" width="5.56529" height="3.458" rx="0.236413" fill="black"/>
        </svg>
    `,
    "icon-fast-travel": `
        <svg class="icon icon-fast-travel" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1467_6643)">
            <rect x="1" y="1" width="22" height="22" rx="2" fill="white" stroke="black"/>
            <path d="M19.5938 11.7969L12 18.1406V13.1934L6.07812 18.1406V5.45312L12 10.3994V5.45312L19.5938 11.7969Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1467_6643">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-gobble-gum": `
        <svg class="icon icon-gobble-gum" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1468_6690)">
            <path d="M15.6875 18.5996L15.7529 18.6055C15.9033 18.6303 16.0292 18.7395 16.0723 18.8896L17.291 23.1396C17.3256 23.2604 17.3012 23.3909 17.2256 23.4912C17.15 23.5913 17.0317 23.6504 16.9062 23.6504H7.28125C7.15954 23.6504 7.04465 23.5942 6.96875 23.499C6.89295 23.4039 6.86457 23.2797 6.8916 23.1611L7.86035 18.9111L7.88086 18.8457C7.94212 18.6989 8.08658 18.5996 8.25 18.5996H15.6875Z" fill="white" stroke="black" stroke-width="0.8" stroke-linejoin="round"/>
            <path d="M8.09375 22.625L8.9375 18.8125H15L16.0312 22.625H13.2188L12.9062 20.9688H10.9062L10.5938 22.625H8.09375Z" fill="black"/>
            <circle cx="11.9844" cy="11.0781" r="8.25937" fill="white" stroke="black" stroke-width="1.2"/>
            <path d="M6.76953 9.55469C7.58286 9.55469 8.24219 10.214 8.24219 11.0273C8.24219 11.8407 7.58286 12.5 6.76953 12.5C5.95621 12.5 5.29688 11.8407 5.29688 11.0273C5.29688 10.214 5.95621 9.55469 6.76953 9.55469ZM18.0352 9.77344C18.719 9.77344 19.2734 10.3278 19.2734 11.0117C19.2734 11.6956 18.719 12.25 18.0352 12.25C17.3513 12.25 16.7969 11.6956 16.7969 11.0117C16.7969 10.3278 17.3513 9.77344 18.0352 9.77344ZM10.5273 8.17188C11.4658 8.17188 12.2266 8.93264 12.2266 9.87109C12.2266 10.8095 11.4658 11.5703 10.5273 11.5703C9.58889 11.5703 8.82812 10.8095 8.82812 9.87109C8.82812 8.93264 9.58889 8.17188 10.5273 8.17188ZM14.6094 8.375C15.4033 8.375 16.0469 9.01859 16.0469 9.8125C16.0469 10.6064 15.4033 11.25 14.6094 11.25C13.8155 11.25 13.1719 10.6064 13.1719 9.8125C13.1719 9.01859 13.8155 8.375 14.6094 8.375Z" fill="black"/>
            <circle cx="16.3594" cy="12.9219" r="2.21563" fill="black" stroke="white" stroke-width="0.4"/>
            <circle cx="7.6875" cy="13.0938" r="2.04375" fill="black" stroke="white" stroke-width="0.4"/>
            <circle cx="12.1484" cy="12.1797" r="2.04375" fill="black" stroke="white" stroke-width="0.4"/>
            <circle cx="10.125" cy="14.9375" r="2.6875" fill="black" stroke="white" stroke-width="0.5"/>
            <circle cx="13.7344" cy="15.3594" r="2.60938" fill="black" stroke="white" stroke-width="0.5"/>
            <path d="M15.3125 0.380859L15.374 0.385742C15.5143 0.40752 15.6348 0.503196 15.6865 0.638672L16.749 3.41992C16.7959 3.54281 16.7787 3.68073 16.7041 3.78906C16.6295 3.89748 16.5066 3.96289 16.375 3.96289H7.59375C7.47226 3.96289 7.35716 3.90736 7.28125 3.8125C7.20537 3.71764 7.17649 3.59313 7.20312 3.47461L7.82812 0.693359L7.84961 0.62793C7.91066 0.480738 8.05498 0.380859 8.21875 0.380859H15.3125Z" fill="white" stroke="black" stroke-width="0.8" stroke-linejoin="round"/>
            <path d="M8.46875 2.90625L8.78125 1.40625H14.8125L15.4375 2.90625H8.46875Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1468_6690">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-mystery-box": `
        <svg class="icon icon-mystery-box" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.03125 16.5312L4.125 12.875H19.7812L21.6562 16.5312L20.2812 20.9688H3.46875L2.03125 16.5312Z" fill="white" stroke="black" stroke-width="0.5"/>
            <path d="M4.59375 15.2812L5.375 13.0312H18.3438L19.375 15.2812H4.59375Z" fill="white" stroke="black" stroke-width="0.5"/>
            <path d="M2.1875 11.7188L4.3125 8.9375H19.4688L21.6562 11.7188L21.2812 13.125H2.6875L2.1875 11.7188Z" fill="white" stroke="black" stroke-width="0.5"/>
            <path d="M2.1875 16.5H21.5938" stroke="black" stroke-width="0.5"/>
            <path d="M2.1875 11.7656H21.5938" stroke="black" stroke-width="0.5"/>
            <path d="M13.6249 14.1562H10.4999V13.9062C10.4999 13.1219 10.1371 11.1656 11.6669 9.63574L11.6786 9.62402L11.6913 9.61426C12.6419 8.88304 13.1169 8.24521 13.3544 7.80371C13.4732 7.58268 13.5341 7.40914 13.5643 7.2959C13.5794 7.2393 13.5869 7.1974 13.5907 7.17188C13.5926 7.1591 13.5932 7.14996 13.5936 7.14551V7.14453L13.5946 7.12793L13.5975 7.11133C13.6474 6.83949 13.6293 6.43758 13.4325 6.11426C13.2474 5.81017 12.8776 5.53125 12.1249 5.53125C11.4122 5.53129 10.9818 5.90403 10.7186 6.39551C10.4485 6.90001 10.3651 7.51799 10.3749 7.93164L10.3807 8.1875H6.94519L6.93738 7.94531C6.91007 7.07135 7.13465 5.76474 7.90417 4.66895C8.68336 3.5594 10.0075 2.68753 12.1249 2.6875C14.2205 2.6875 15.5418 3.36998 16.329 4.25977C17.1092 5.14161 17.3406 6.19987 17.3124 6.91602V6.91699C17.2713 7.85371 17.0014 8.54209 16.6122 9.07617C16.2266 9.60513 15.7334 9.96938 15.2714 10.2734C14.7948 10.5871 14.3808 10.8215 14.0721 11.1152C13.7815 11.3918 13.6101 11.6997 13.6249 12.1484V14.1562Z" fill="white" stroke="black" stroke-width="0.5"/>
            <rect x="10.5" y="14.935" width="3.125" height="3.13" fill="white" stroke="black" stroke-width="0.5"/>
        </svg>
    `,
    "icon-pack-a-punch": `
        <svg class="icon icon-pack-a-punch" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1468_6786)">
            <circle cx="12" cy="12" r="11.35" fill="white" stroke="black" stroke-width="1.3"/>
            <path d="M17.25 4.6875V7.03125L13.8398 7.52344C14.9168 8.15189 15.6406 9.31941 15.6406 10.6562C15.6406 12.1071 14.7879 13.3582 13.5566 13.9375H14.9375L16.5312 11.1562H18.8125L17.1875 16.7188L17.8438 18.9688H17.1875L15.875 16.9375H7.96875L6.59375 18.9688H5.90625L6.59375 16.7188L5.21875 11.1562H7.28125L8.875 13.9375H10.4746C9.24331 13.3582 8.39062 12.1071 8.39062 10.6562C8.39062 9.31737 9.11662 8.14827 10.1963 7.52051L6.65625 7.03125V4.6875L10.6094 3.96875H13.4688L17.25 4.6875ZM12.0156 8.03125C10.5659 8.03125 9.39062 9.2065 9.39062 10.6562C9.39062 12.106 10.5659 13.2812 12.0156 13.2812C13.4654 13.2812 14.6406 12.106 14.6406 10.6562C14.6406 9.2065 13.4654 8.03125 12.0156 8.03125Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1468_6786">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-perks": `
        <svg class="icon icon-perks" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <mask id="path-1-outside-1_1639_7493" maskUnits="userSpaceOnUse" x="5.60352" y="3.91113" width="13" height="20" fill="black">
            <rect fill="white" x="5.60352" y="3.91113" width="13" height="20"/>
            <path d="M16.4971 22.5625H7.50293L6.60352 21.2695H17.3965L16.4971 22.5625ZM17.3955 6.20312H17.3965V20.3701H6.60352V6.20312H6.60449L7.50293 4.91113H16.4971L17.3955 6.20312Z"/>
            </mask>
            <path d="M16.4971 22.5625H7.50293L6.60352 21.2695H17.3965L16.4971 22.5625ZM17.3955 6.20312H17.3965V20.3701H6.60352V6.20312H6.60449L7.50293 4.91113H16.4971L17.3955 6.20312Z" fill="white"/>
            <path d="M16.4971 22.5625V23.5625C16.8244 23.5625 17.1311 23.4023 17.318 23.1335L16.4971 22.5625ZM7.50293 22.5625L6.68201 23.1335C6.86895 23.4023 7.17557 23.5625 7.50293 23.5625V22.5625ZM6.60352 21.2695V20.2695C6.23117 20.2695 5.88966 20.4764 5.71722 20.8064C5.54478 21.1364 5.56997 21.5349 5.7826 21.8406L6.60352 21.2695ZM17.3965 21.2695L18.2174 21.8406C18.43 21.5349 18.4552 21.1364 18.2828 20.8064C18.1103 20.4764 17.7688 20.2695 17.3965 20.2695V21.2695ZM17.3955 6.20312L16.5745 6.77404C16.7614 7.04285 17.0681 7.20312 17.3955 7.20312V6.20312ZM17.3965 6.20312H18.3965C18.3965 5.65084 17.9488 5.20312 17.3965 5.20312V6.20312ZM17.3965 20.3701V21.3701C17.9488 21.3701 18.3965 20.9224 18.3965 20.3701H17.3965ZM6.60352 20.3701H5.60352C5.60352 20.9224 6.05123 21.3701 6.60352 21.3701V20.3701ZM6.60352 6.20312V5.20312C6.05123 5.20312 5.60352 5.65084 5.60352 6.20312H6.60352ZM6.60449 6.20312V7.20312C6.9319 7.20312 7.23857 7.04285 7.4255 6.77404L6.60449 6.20312ZM7.50293 4.91113V3.91113C7.17552 3.91113 6.86885 4.07141 6.68192 4.34021L7.50293 4.91113ZM16.4971 4.91113L17.3181 4.34021C17.1312 4.07141 16.8245 3.91113 16.4971 3.91113V4.91113ZM16.4971 22.5625V21.5625H7.50293V22.5625V23.5625H16.4971V22.5625ZM7.50293 22.5625L8.32385 21.9915L7.42443 20.6985L6.60352 21.2695L5.7826 21.8406L6.68201 23.1335L7.50293 22.5625ZM6.60352 21.2695V22.2695H17.3965V21.2695V20.2695H6.60352V21.2695ZM17.3965 21.2695L16.5756 20.6985L15.6762 21.9915L16.4971 22.5625L17.318 23.1335L18.2174 21.8406L17.3965 21.2695ZM17.3955 6.20312V7.20312H17.3965V6.20312V5.20312H17.3955V6.20312ZM17.3965 6.20312H16.3965V20.3701H17.3965H18.3965V6.20312H17.3965ZM17.3965 20.3701V19.3701H6.60352V20.3701V21.3701H17.3965V20.3701ZM6.60352 20.3701H7.60352V6.20312H6.60352H5.60352V20.3701H6.60352ZM6.60352 6.20312V7.20312H6.60449V6.20312V5.20312H6.60352V6.20312ZM6.60449 6.20312L7.4255 6.77404L8.32394 5.48205L7.50293 4.91113L6.68192 4.34021L5.78349 5.63221L6.60449 6.20312ZM7.50293 4.91113V5.91113H16.4971V4.91113V3.91113H7.50293V4.91113ZM16.4971 4.91113L15.6761 5.48205L16.5745 6.77404L17.3955 6.20312L18.2165 5.63221L17.3181 4.34021L16.4971 4.91113Z" fill="black" mask="url(#path-1-outside-1_1639_7493)"/>
            <circle cx="11.9999" cy="11.5131" r="3.7499" fill="black"/>
            <rect x="7.05326" y="3.1128" width="9.89349" height="1.49941" rx="0.749704" fill="white" stroke="black" stroke-width="0.899408"/>
            <path d="M12.7598 1.49777C12.9709 0.928577 13.6035 0.637861 14.1729 0.848358L15.4805 1.33273C16.0497 1.54386 16.3405 2.17639 16.1299 2.74582L15.8271 3.56223H11.9951L12.7598 1.49777Z" fill="black"/>
            <path d="M13.5586 2.21985C13.6546 1.9612 13.9424 1.82916 14.2012 1.92493L14.7578 2.13098C15.0167 2.22689 15.1485 2.51468 15.0527 2.77356L14.7607 3.56262H13.0615L13.5586 2.21985Z" fill="white"/>
            <rect x="13.8975" y="2.47607" width="0.780544" height="1.1939" rx="0.1" transform="rotate(20.3287 13.8975 2.47607)" fill="black"/>
        </svg>
    `,
    "icon-power-door": `
        <svg class="icon icon-power-door" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M22.2812 20.9062H23.7227V22.125H4.71875V20.9062H6.125V0.5625H22.2812V20.9062Z" fill="black"/>
            <rect x="7.21875" y="1.6875" width="13.9688" height="19.3125" fill="white"/>
            <path d="M20.1875 21V3.09375L19.3086 2.9375H8.28125V21H20.1875Z" fill="black"/>
            <mask id="path-4-outside-1_1468_6836" maskUnits="userSpaceOnUse" x="11.6562" y="0.21875" width="9" height="24" fill="black">
            <rect fill="white" x="11.6562" y="0.21875" width="9" height="24"/>
            <path d="M19.0938 3.9375V20.9375L13.6562 22.3125V2.21875L19.0938 3.9375ZM15.2344 10.9688C14.8806 10.9688 14.5938 11.3885 14.5938 11.9062C14.5938 12.424 14.8806 12.8438 15.2344 12.8438C15.5882 12.8438 15.875 12.424 15.875 11.9062C15.875 11.3885 15.5882 10.9688 15.2344 10.9688Z"/>
            </mask>
            <path d="M19.0938 3.9375V20.9375L13.6562 22.3125V2.21875L19.0938 3.9375ZM15.2344 10.9688C14.8806 10.9688 14.5938 11.3885 14.5938 11.9062C14.5938 12.424 14.8806 12.8438 15.2344 12.8438C15.5882 12.8438 15.875 12.424 15.875 11.9062C15.875 11.3885 15.5882 10.9688 15.2344 10.9688Z" fill="white"/>
            <path d="M19.0938 3.9375H20.2937V3.05829L19.4554 2.7933L19.0938 3.9375ZM19.0938 20.9375L19.3879 22.1009L20.2937 21.8718V20.9375H19.0938ZM13.6562 22.3125H12.4562V23.8537L13.9504 23.4759L13.6562 22.3125ZM13.6562 2.21875L14.0179 1.07455L12.4562 0.580918V2.21875H13.6562ZM19.0938 3.9375H17.8938V20.9375H19.0938H20.2937V3.9375H19.0938ZM19.0938 20.9375L18.7996 19.7741L13.3621 21.1491L13.6562 22.3125L13.9504 23.4759L19.3879 22.1009L19.0938 20.9375ZM13.6562 22.3125H14.8563V2.21875H13.6562H12.4562V22.3125H13.6562ZM13.6562 2.21875L13.2946 3.36295L18.7321 5.0817L19.0938 3.9375L19.4554 2.7933L14.0179 1.07455L13.6562 2.21875ZM15.2344 10.9688V9.76875C14.5452 9.76875 14.0557 10.1784 13.7906 10.5663C13.5215 10.9601 13.3937 11.4374 13.3937 11.9062H14.5938H15.7938C15.7938 11.8573 15.8094 11.8659 15.7722 11.9204C15.739 11.9689 15.5698 12.1687 15.2344 12.1687V10.9688ZM14.5938 11.9062H13.3937C13.3937 12.3751 13.5215 12.8524 13.7906 13.2462C14.0557 13.6341 14.5452 14.0437 15.2344 14.0437V12.8438V11.6438C15.5698 11.6438 15.739 11.8436 15.7722 11.8921C15.8094 11.9466 15.7938 11.9552 15.7938 11.9062H14.5938ZM15.2344 12.8438V14.0437C15.9236 14.0437 16.4131 13.6341 16.6781 13.2462C16.9472 12.8524 17.075 12.3751 17.075 11.9062H15.875H14.675C14.675 11.9552 14.6594 11.9466 14.6966 11.8921C14.7298 11.8436 14.899 11.6438 15.2344 11.6438V12.8438ZM15.875 11.9062H17.075C17.075 11.4374 16.9472 10.9601 16.6781 10.5663C16.4131 10.1784 15.9236 9.76875 15.2344 9.76875V10.9688V12.1687C14.899 12.1687 14.7298 11.9689 14.6966 11.9204C14.6594 11.8659 14.675 11.8573 14.675 11.9062H15.875Z" fill="black" mask="url(#path-4-outside-1_1468_6836)"/>
            <path d="M10.9188 5.58789C11.1411 5.58789 11.3451 5.7107 11.449 5.90723C11.5529 6.10373 11.5399 6.34166 11.4149 6.52539L8.05353 11.4629H9.76251C10.0056 11.4629 10.2246 11.6092 10.3172 11.834C10.4097 12.0587 10.3577 12.3171 10.1854 12.4883L2.90411 19.707C2.70256 19.9069 2.38818 19.9384 2.15118 19.7822C1.91432 19.6261 1.81884 19.3255 1.92267 19.0615L3.75568 14.4121H2.32501C2.13072 14.4121 1.94829 14.3185 1.83575 14.1602C1.72322 14.0018 1.69471 13.7987 1.75861 13.6152L4.41486 5.99023L4.45294 5.90332C4.55626 5.71109 4.75802 5.58789 4.98126 5.58789H10.9188Z" fill="white" stroke="black" stroke-width="1.2" stroke-linejoin="round"/>
        </svg>
    `,
    "icon-traps": `
        <svg class="icon icon-traps" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1461_13272)">
            <mask id="path-1-outside-1_1461_13272" maskUnits="userSpaceOnUse" x="-0.0769196" y="4.67902" width="25" height="17" fill="black">
            <rect fill="white" x="-0.0769196" y="4.67902" width="25" height="17"/>
            <path d="M5.07433 5.67916L3.54241 9.13564C3.49391 9.14576 3.44557 9.15667 3.39741 9.16836C3.15143 9.22859 2.935 9.30397 2.74474 9.39097L2.36058 6.90764L1.19702 10.9637C1.13524 11.1409 1.08345 11.3215 1.04189 11.5045L1.02981 11.5465L1.03306 11.5447C0.864269 12.3191 0.867615 13.205 1.20023 14.1387C1.35387 14.7904 1.92127 15.5494 3.07033 16.3757C4.42704 17.3513 6.55818 18.372 9.50671 19.3436C9.49463 19.2591 9.48853 19.1739 9.48845 19.0886C9.48845 18.5212 9.75042 18.0111 10.1592 17.6736L9.97001 15.6878L8.50423 17.4394C8.0679 17.2748 7.63563 17.0997 7.20779 16.9142L7.0707 13.2811L5.51057 16.0981C5.08915 15.8727 4.69747 15.6439 4.33507 15.4126L4.12003 11.2281L2.77545 14.2515C2.4276 13.9445 2.12682 13.6361 1.87154 13.3285C1.67431 12.3983 1.85239 11.5596 2.15712 10.8924L2.36546 10.7715C3.10217 10.5161 4.01593 10.4162 5.08436 10.4842C6.60554 10.581 8.45417 11.0301 10.5753 11.9157C10.5799 11.3073 10.9334 10.7766 11.444 10.5149L11.1839 8.07083L9.78318 10.059C9.33332 9.89168 8.89902 9.74621 8.48136 9.62166L8.28338 6.42752L6.76987 9.20544C6.22223 9.10492 5.71436 9.04576 5.24944 9.02373L5.07423 5.67902L5.07433 5.67916ZM20.0891 7.07039L19.3467 10.3366C18.8853 10.2788 18.3762 10.2494 17.8207 10.254L16.9107 7.16613L16.0707 10.3711C15.6366 10.4232 15.1818 10.4936 14.7083 10.5826L13.8246 8.49872L13.0614 10.6245C13.475 10.9119 13.7477 11.3899 13.7477 11.9276C13.7477 12.0395 13.7358 12.1488 13.7133 12.2544C15.908 11.7631 17.7696 11.6425 19.2609 11.8036C20.3251 11.9183 21.2085 12.1725 21.8909 12.5495L22.0758 12.7043C22.2625 13.4137 22.2952 14.2707 21.9423 15.1538C21.6384 15.4132 21.2895 15.6658 20.8945 15.909L20.0844 12.7007L19.1601 16.7876C18.7646 16.9533 18.3409 17.1117 17.8887 17.2616L16.9721 14.3999L16.0763 17.7773C15.6245 17.887 15.1701 17.9857 14.7134 18.0734L13.6629 15.9621L12.9718 18.2855C13.0948 18.5354 13.1588 18.8102 13.1587 19.0887C13.1587 19.3469 13.1037 19.6021 12.9971 19.8373C16.2696 19.3795 18.6751 18.7136 20.2421 17.9521C21.5152 17.3335 22.2035 16.6821 22.4659 16.0661C22.9526 15.2026 23.1068 14.3304 23.0723 13.5385L23.0752 13.5409L23.0705 13.4972C23.0607 13.3097 23.0404 13.123 23.0097 12.9378L22.5538 8.74312L21.7525 11.1247C21.5798 11.0066 21.3793 10.8956 21.1472 10.7942C21.1026 10.7749 21.0566 10.756 21.0099 10.7375L20.0891 7.07044V7.07039ZM12.1614 11.2098C11.7598 11.2098 11.4437 11.5259 11.4437 11.9276C11.4437 12.0917 11.4971 12.2408 11.587 12.3606C11.9465 12.3634 12.3053 12.392 12.6606 12.4463C12.7958 12.3165 12.8793 12.1334 12.8793 11.9276C12.8793 11.5261 12.563 11.2098 12.1614 11.2098V11.2098ZM11.5734 13.2299C11.526 13.2298 11.479 13.2302 11.4324 13.2311C10.874 13.2424 10.3826 13.3303 10.0275 13.4625C9.7908 13.5508 9.61764 13.6591 9.5233 13.7516C9.42896 13.8441 9.41293 13.8982 9.41293 13.9547C9.41293 14.0674 9.58999 14.3468 10.0756 14.5981C10.5611 14.8494 11.2795 15.0495 12.0735 15.1071C12.8677 15.1648 13.5833 15.0675 14.0568 14.891C14.2935 14.8028 14.4667 14.6945 14.561 14.602C14.6554 14.5096 14.6713 14.4554 14.6713 14.399C14.6713 14.286 14.4943 14.0067 14.0087 13.7555C13.5232 13.5041 12.8049 13.3041 12.0107 13.2466C11.8652 13.236 11.7193 13.2304 11.5734 13.2299ZM11.3091 15.8889L11.1715 17.2604C11.2217 17.2562 11.2723 17.2534 11.3236 17.2534C11.5737 17.2534 11.8127 17.3045 12.0307 17.3964L12.1724 15.9833C11.883 15.9687 11.5947 15.9372 11.309 15.8889L11.3091 15.8889ZM11.3236 18.122C10.7845 18.122 10.357 18.5496 10.357 19.0886C10.357 19.6275 10.7846 20.0551 11.3236 20.0551C11.8624 20.0551 12.2901 19.6274 12.2901 19.0886C12.2901 18.5497 11.8625 18.122 11.3235 18.122H11.3236Z"/>
            </mask>
            <path d="M5.07433 5.67916L3.54241 9.13564C3.49391 9.14576 3.44557 9.15667 3.39741 9.16836C3.15143 9.22859 2.935 9.30397 2.74474 9.39097L2.36058 6.90764L1.19702 10.9637C1.13524 11.1409 1.08345 11.3215 1.04189 11.5045L1.02981 11.5465L1.03306 11.5447C0.864269 12.3191 0.867615 13.205 1.20023 14.1387C1.35387 14.7904 1.92127 15.5494 3.07033 16.3757C4.42704 17.3513 6.55818 18.372 9.50671 19.3436C9.49463 19.2591 9.48853 19.1739 9.48845 19.0886C9.48845 18.5212 9.75042 18.0111 10.1592 17.6736L9.97001 15.6878L8.50423 17.4394C8.0679 17.2748 7.63563 17.0997 7.20779 16.9142L7.0707 13.2811L5.51057 16.0981C5.08915 15.8727 4.69747 15.6439 4.33507 15.4126L4.12003 11.2281L2.77545 14.2515C2.4276 13.9445 2.12682 13.6361 1.87154 13.3285C1.67431 12.3983 1.85239 11.5596 2.15712 10.8924L2.36546 10.7715C3.10217 10.5161 4.01593 10.4162 5.08436 10.4842C6.60554 10.581 8.45417 11.0301 10.5753 11.9157C10.5799 11.3073 10.9334 10.7766 11.444 10.5149L11.1839 8.07083L9.78318 10.059C9.33332 9.89168 8.89902 9.74621 8.48136 9.62166L8.28338 6.42752L6.76987 9.20544C6.22223 9.10492 5.71436 9.04576 5.24944 9.02373L5.07423 5.67902L5.07433 5.67916ZM20.0891 7.07039L19.3467 10.3366C18.8853 10.2788 18.3762 10.2494 17.8207 10.254L16.9107 7.16613L16.0707 10.3711C15.6366 10.4232 15.1818 10.4936 14.7083 10.5826L13.8246 8.49872L13.0614 10.6245C13.475 10.9119 13.7477 11.3899 13.7477 11.9276C13.7477 12.0395 13.7358 12.1488 13.7133 12.2544C15.908 11.7631 17.7696 11.6425 19.2609 11.8036C20.3251 11.9183 21.2085 12.1725 21.8909 12.5495L22.0758 12.7043C22.2625 13.4137 22.2952 14.2707 21.9423 15.1538C21.6384 15.4132 21.2895 15.6658 20.8945 15.909L20.0844 12.7007L19.1601 16.7876C18.7646 16.9533 18.3409 17.1117 17.8887 17.2616L16.9721 14.3999L16.0763 17.7773C15.6245 17.887 15.1701 17.9857 14.7134 18.0734L13.6629 15.9621L12.9718 18.2855C13.0948 18.5354 13.1588 18.8102 13.1587 19.0887C13.1587 19.3469 13.1037 19.6021 12.9971 19.8373C16.2696 19.3795 18.6751 18.7136 20.2421 17.9521C21.5152 17.3335 22.2035 16.6821 22.4659 16.0661C22.9526 15.2026 23.1068 14.3304 23.0723 13.5385L23.0752 13.5409L23.0705 13.4972C23.0607 13.3097 23.0404 13.123 23.0097 12.9378L22.5538 8.74312L21.7525 11.1247C21.5798 11.0066 21.3793 10.8956 21.1472 10.7942C21.1026 10.7749 21.0566 10.756 21.0099 10.7375L20.0891 7.07044V7.07039ZM12.1614 11.2098C11.7598 11.2098 11.4437 11.5259 11.4437 11.9276C11.4437 12.0917 11.4971 12.2408 11.587 12.3606C11.9465 12.3634 12.3053 12.392 12.6606 12.4463C12.7958 12.3165 12.8793 12.1334 12.8793 11.9276C12.8793 11.5261 12.563 11.2098 12.1614 11.2098V11.2098ZM11.5734 13.2299C11.526 13.2298 11.479 13.2302 11.4324 13.2311C10.874 13.2424 10.3826 13.3303 10.0275 13.4625C9.7908 13.5508 9.61764 13.6591 9.5233 13.7516C9.42896 13.8441 9.41293 13.8982 9.41293 13.9547C9.41293 14.0674 9.58999 14.3468 10.0756 14.5981C10.5611 14.8494 11.2795 15.0495 12.0735 15.1071C12.8677 15.1648 13.5833 15.0675 14.0568 14.891C14.2935 14.8028 14.4667 14.6945 14.561 14.602C14.6554 14.5096 14.6713 14.4554 14.6713 14.399C14.6713 14.286 14.4943 14.0067 14.0087 13.7555C13.5232 13.5041 12.8049 13.3041 12.0107 13.2466C11.8652 13.236 11.7193 13.2304 11.5734 13.2299ZM11.3091 15.8889L11.1715 17.2604C11.2217 17.2562 11.2723 17.2534 11.3236 17.2534C11.5737 17.2534 11.8127 17.3045 12.0307 17.3964L12.1724 15.9833C11.883 15.9687 11.5947 15.9372 11.309 15.8889L11.3091 15.8889ZM11.3236 18.122C10.7845 18.122 10.357 18.5496 10.357 19.0886C10.357 19.6275 10.7846 20.0551 11.3236 20.0551C11.8624 20.0551 12.2901 19.6274 12.2901 19.0886C12.2901 18.5497 11.8625 18.122 11.3235 18.122H11.3236Z" fill="#F8F8F8"/>
            <path d="M5.07433 5.67916L3.54241 9.13564C3.49391 9.14576 3.44557 9.15667 3.39741 9.16836C3.15143 9.22859 2.935 9.30397 2.74474 9.39097L2.36058 6.90764L1.19702 10.9637C1.13524 11.1409 1.08345 11.3215 1.04189 11.5045L1.02981 11.5465L1.03306 11.5447C0.864269 12.3191 0.867615 13.205 1.20023 14.1387C1.35387 14.7904 1.92127 15.5494 3.07033 16.3757C4.42704 17.3513 6.55818 18.372 9.50671 19.3436C9.49463 19.2591 9.48853 19.1739 9.48845 19.0886C9.48845 18.5212 9.75042 18.0111 10.1592 17.6736L9.97001 15.6878L8.50423 17.4394C8.0679 17.2748 7.63563 17.0997 7.20779 16.9142L7.0707 13.2811L5.51057 16.0981C5.08915 15.8727 4.69747 15.6439 4.33507 15.4126L4.12003 11.2281L2.77545 14.2515C2.4276 13.9445 2.12682 13.6361 1.87154 13.3285C1.67431 12.3983 1.85239 11.5596 2.15712 10.8924L2.36546 10.7715C3.10217 10.5161 4.01593 10.4162 5.08436 10.4842C6.60554 10.581 8.45417 11.0301 10.5753 11.9157C10.5799 11.3073 10.9334 10.7766 11.444 10.5149L11.1839 8.07083L9.78318 10.059C9.33332 9.89168 8.89902 9.74621 8.48136 9.62166L8.28338 6.42752L6.76987 9.20544C6.22223 9.10492 5.71436 9.04576 5.24944 9.02373L5.07423 5.67902L5.07433 5.67916ZM20.0891 7.07039L19.3467 10.3366C18.8853 10.2788 18.3762 10.2494 17.8207 10.254L16.9107 7.16613L16.0707 10.3711C15.6366 10.4232 15.1818 10.4936 14.7083 10.5826L13.8246 8.49872L13.0614 10.6245C13.475 10.9119 13.7477 11.3899 13.7477 11.9276C13.7477 12.0395 13.7358 12.1488 13.7133 12.2544C15.908 11.7631 17.7696 11.6425 19.2609 11.8036C20.3251 11.9183 21.2085 12.1725 21.8909 12.5495L22.0758 12.7043C22.2625 13.4137 22.2952 14.2707 21.9423 15.1538C21.6384 15.4132 21.2895 15.6658 20.8945 15.909L20.0844 12.7007L19.1601 16.7876C18.7646 16.9533 18.3409 17.1117 17.8887 17.2616L16.9721 14.3999L16.0763 17.7773C15.6245 17.887 15.1701 17.9857 14.7134 18.0734L13.6629 15.9621L12.9718 18.2855C13.0948 18.5354 13.1588 18.8102 13.1587 19.0887C13.1587 19.3469 13.1037 19.6021 12.9971 19.8373C16.2696 19.3795 18.6751 18.7136 20.2421 17.9521C21.5152 17.3335 22.2035 16.6821 22.4659 16.0661C22.9526 15.2026 23.1068 14.3304 23.0723 13.5385L23.0752 13.5409L23.0705 13.4972C23.0607 13.3097 23.0404 13.123 23.0097 12.9378L22.5538 8.74312L21.7525 11.1247C21.5798 11.0066 21.3793 10.8956 21.1472 10.7942C21.1026 10.7749 21.0566 10.756 21.0099 10.7375L20.0891 7.07044V7.07039ZM12.1614 11.2098C11.7598 11.2098 11.4437 11.5259 11.4437 11.9276C11.4437 12.0917 11.4971 12.2408 11.587 12.3606C11.9465 12.3634 12.3053 12.392 12.6606 12.4463C12.7958 12.3165 12.8793 12.1334 12.8793 11.9276C12.8793 11.5261 12.563 11.2098 12.1614 11.2098V11.2098ZM11.5734 13.2299C11.526 13.2298 11.479 13.2302 11.4324 13.2311C10.874 13.2424 10.3826 13.3303 10.0275 13.4625C9.7908 13.5508 9.61764 13.6591 9.5233 13.7516C9.42896 13.8441 9.41293 13.8982 9.41293 13.9547C9.41293 14.0674 9.58999 14.3468 10.0756 14.5981C10.5611 14.8494 11.2795 15.0495 12.0735 15.1071C12.8677 15.1648 13.5833 15.0675 14.0568 14.891C14.2935 14.8028 14.4667 14.6945 14.561 14.602C14.6554 14.5096 14.6713 14.4554 14.6713 14.399C14.6713 14.286 14.4943 14.0067 14.0087 13.7555C13.5232 13.5041 12.8049 13.3041 12.0107 13.2466C11.8652 13.236 11.7193 13.2304 11.5734 13.2299ZM11.3091 15.8889L11.1715 17.2604C11.2217 17.2562 11.2723 17.2534 11.3236 17.2534C11.5737 17.2534 11.8127 17.3045 12.0307 17.3964L12.1724 15.9833C11.883 15.9687 11.5947 15.9372 11.309 15.8889L11.3091 15.8889ZM11.3236 18.122C10.7845 18.122 10.357 18.5496 10.357 19.0886C10.357 19.6275 10.7846 20.0551 11.3236 20.0551C11.8624 20.0551 12.2901 19.6274 12.2901 19.0886C12.2901 18.5497 11.8625 18.122 11.3235 18.122H11.3236Z" stroke="black" stroke-width="2" stroke-linejoin="round" mask="url(#path-1-outside-1_1461_13272)"/>
            </g>
            <defs>
            <clipPath id="clip0_1461_13272">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-wall-buy": `
        <svg class="icon icon-wall-buy" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1468_6865)">
            <mask id="path-1-outside-1_1468_6865" maskUnits="userSpaceOnUse" x="0" y="4.1026" width="24" height="19" fill="black">
            <rect fill="white" y="4.1026" width="24" height="19"/>
            <path d="M19.8545 6.33698V7.02643C19.8648 7.03424 21.3447 8.15992 21.3447 8.40533C21.3446 8.65161 20.8027 9.03326 20.8027 9.03326V10.4249C19.9131 10.8122 19.4719 11.1766 19.0908 12.0381L21.8125 19.1797L16.5303 20.8546L14.9912 13.9219H10.6064C10.5089 13.9219 10.4254 13.8511 10.4092 13.7549L10.0703 11.7501L9.60938 11.2862H7.29492V10.794H2.46777V9.04596H2V7.54303L2.70215 6.53326L17.6387 6.50885L18.3281 6.1026L19.8545 6.33698ZM11.582 10.7569C11.234 10.7571 10.9521 11.0397 10.9521 11.3878V12.3682C10.9524 12.7161 11.2342 12.9979 11.582 12.9981H14.1143C14.4622 12.998 14.7439 12.7161 14.7441 12.3682V11.3878C14.7441 11.0396 14.4624 10.757 14.1143 10.7569H13.9072C13.9179 11.6037 13.7837 12.0524 13.0205 12.7022H11.8389C12.7143 12.3601 12.9435 11.989 12.6846 10.9698L12.627 10.7569H11.582Z"/>
            </mask>
            <path d="M19.8545 6.33698H21.3545C21.3545 5.59645 20.8141 4.96674 20.0821 4.85435L19.8545 6.33698ZM19.8545 7.02643H18.3545C18.3545 7.495 18.5735 7.93665 18.9464 8.22032L19.8545 7.02643ZM21.3447 8.40533L22.8447 8.40624V8.40533H21.3447ZM20.8027 9.03326L19.939 7.80694C19.5401 8.08791 19.3027 8.54534 19.3027 9.03326H20.8027ZM20.8027 10.4249L21.4015 11.8002C21.9488 11.5619 22.3027 11.0218 22.3027 10.4249H20.8027ZM19.0908 12.0381L17.719 11.4313C17.5591 11.7929 17.5484 12.2029 17.6892 12.5723L19.0908 12.0381ZM21.8125 19.1797L22.2659 20.6096C22.6592 20.4849 22.9838 20.2036 23.1633 19.832C23.3427 19.4603 23.3611 19.0312 23.2142 18.6456L21.8125 19.1797ZM16.5303 20.8546L15.0659 21.1796C15.1571 21.5905 15.4168 21.9442 15.7815 22.1543C16.1462 22.3644 16.5824 22.4116 16.9836 22.2844L16.5303 20.8546ZM14.9912 13.9219L16.4556 13.5968C16.3032 12.9104 15.6944 12.4219 14.9912 12.4219V13.9219ZM10.6064 13.9219L10.6059 15.4219H10.6064V13.9219ZM10.4092 13.7549L8.93016 14.0049L8.93017 14.005L10.4092 13.7549ZM10.0703 11.7501L11.5493 11.5001C11.4977 11.1946 11.3527 10.9125 11.1343 10.6928L10.0703 11.7501ZM9.60938 11.2862L10.6734 10.2289C10.3918 9.94554 10.0088 9.78619 9.60938 9.78619V11.2862ZM7.29492 11.2862H5.79492C5.79492 12.1146 6.46649 12.7862 7.29492 12.7862V11.2862ZM7.29492 10.794H8.79492C8.79492 9.96558 8.12335 9.29401 7.29492 9.29401V10.794ZM2.46777 10.794H0.967773C0.967773 11.6224 1.63935 12.294 2.46777 12.294V10.794ZM2.46777 9.04596H3.96777C3.96777 8.21753 3.2962 7.54596 2.46777 7.54596V9.04596ZM2 9.04596H0.5C0.5 9.87439 1.17157 10.546 2 10.546L2 9.04596ZM2 7.54303L0.768472 6.68668C0.593685 6.93804 0.5 7.23687 0.5 7.54303H2ZM2.70215 6.53326L2.6997 5.03327C2.20944 5.03407 1.75051 5.2744 1.47062 5.67691L2.70215 6.53326ZM17.6387 6.50885L17.6411 8.00885C17.9081 8.00841 18.1701 7.93672 18.4002 7.80119L17.6387 6.50885ZM18.3281 6.1026L18.5558 4.61998C18.214 4.56749 17.8646 4.63472 17.5666 4.81026L18.3281 6.1026ZM11.582 10.7569V9.2569L11.5812 9.2569L11.582 10.7569ZM10.9521 12.3682H9.45215L9.45215 12.3694L10.9521 12.3682ZM11.582 12.9981L11.5812 14.4981H11.582V12.9981ZM14.1143 12.9981V14.4981H14.1147L14.1143 12.9981ZM14.7441 12.3682L16.2441 12.3694V12.3682H14.7441ZM14.1143 10.7569L14.1147 9.2569H14.1143V10.7569ZM13.9072 10.7569V9.2569C13.5061 9.2569 13.1217 9.41753 12.8399 9.70292C12.5581 9.98832 12.4023 10.3747 12.4073 10.7757L13.9072 10.7569ZM13.0205 12.7022V14.2022C13.3769 14.2022 13.7216 14.0753 13.9929 13.8443L13.0205 12.7022ZM11.8389 12.7022L11.2928 11.3051C10.621 11.5677 10.2312 12.2712 10.3648 12.98C10.4984 13.6888 11.1176 14.2022 11.8389 14.2022V12.7022ZM12.6846 10.9698L14.1384 10.6004C14.1365 10.5929 14.1345 10.5854 14.1325 10.5779L12.6846 10.9698ZM12.627 10.7569L14.0749 10.365C13.8979 9.71105 13.3045 9.2569 12.627 9.2569V10.7569ZM19.8545 6.33698H18.3545V7.02643H19.8545H21.3545V6.33698H19.8545ZM19.8545 7.02643L18.9464 8.22032C18.9464 8.22034 18.9465 8.22037 18.9466 8.22044C18.9467 8.22053 18.9469 8.22067 18.9471 8.22087C18.9477 8.22129 18.9486 8.22196 18.9498 8.22288C18.9522 8.22472 18.9559 8.22757 18.9609 8.23137C18.9708 8.23898 18.9857 8.25039 19.0047 8.2651C19.0429 8.29456 19.0976 8.33709 19.1633 8.38885C19.2958 8.49325 19.4679 8.6313 19.6365 8.77351C19.8112 8.92085 19.9563 9.05092 20.0479 9.14331C20.097 9.19284 20.0991 9.20003 20.0787 9.17276C20.069 9.15975 20.0291 9.10579 19.9859 9.01924C19.9634 8.9741 19.9315 8.9033 19.9038 8.81115C19.8769 8.72135 19.8447 8.581 19.8447 8.40533H21.3447H22.8447C22.8447 8.04962 22.7226 7.78459 22.6703 7.67975C22.6054 7.54973 22.5337 7.44642 22.4835 7.37912C22.3822 7.24329 22.2686 7.12221 22.1788 7.03158C21.9925 6.84364 21.767 6.64578 21.5704 6.48005C21.1696 6.14205 20.7729 5.84036 20.7626 5.83254L19.8545 7.02643ZM21.3447 8.40533L19.8447 8.40443C19.8449 8.16704 19.908 7.99149 19.9465 7.90339C19.9867 7.81105 20.0275 7.75197 20.0437 7.7295C20.0737 7.6879 20.0845 7.68315 20.0513 7.71406C20.0252 7.73836 19.9933 7.7648 19.9648 7.78708C19.9516 7.79735 19.9415 7.80489 19.9362 7.80878C19.9337 7.81069 19.9324 7.81158 19.9328 7.81133C19.9329 7.81121 19.9335 7.81079 19.9345 7.81006C19.935 7.8097 19.9357 7.80926 19.9364 7.80874C19.9368 7.80848 19.9372 7.8082 19.9376 7.8079C19.9378 7.80775 19.938 7.80759 19.9382 7.80743C19.9384 7.80735 19.9385 7.80723 19.9386 7.80719C19.9388 7.80706 19.939 7.80694 20.8027 9.03326C21.6665 10.2596 21.6667 10.2595 21.6669 10.2593C21.667 10.2593 21.6671 10.2592 21.6673 10.2591C21.6675 10.2589 21.6678 10.2587 21.6681 10.2585C21.6686 10.2581 21.6692 10.2577 21.6699 10.2572C21.6711 10.2563 21.6725 10.2554 21.674 10.2543C21.6771 10.2521 21.6807 10.2495 21.6849 10.2465C21.6932 10.2405 21.7036 10.233 21.7158 10.224C21.7401 10.206 21.7724 10.1818 21.81 10.1525C21.8831 10.0955 21.9867 10.0111 22.0961 9.90924C22.1984 9.81396 22.3446 9.66762 22.4763 9.48519C22.5721 9.35236 22.8444 8.95758 22.8447 8.40624L21.3447 8.40533ZM20.8027 9.03326H19.3027V10.4249H20.8027H22.3027V9.03326H20.8027ZM20.8027 10.4249L20.204 9.04955C19.6947 9.27127 19.1882 9.53852 18.7414 9.94899C18.28 10.3728 17.9677 10.8691 17.719 11.4313L19.0908 12.0381L20.4626 12.645C20.595 12.3456 20.6939 12.229 20.7708 12.1584C20.8622 12.0744 21.0211 11.9658 21.4015 11.8002L20.8027 10.4249ZM19.0908 12.0381L17.6892 12.5723L20.4108 19.7139L21.8125 19.1797L23.2142 18.6456L20.4925 11.504L19.0908 12.0381ZM21.8125 19.1797L21.3591 17.7499L16.0769 19.4247L16.5303 20.8546L16.9836 22.2844L22.2659 20.6096L21.8125 19.1797ZM16.5303 20.8546L17.9946 20.5295L16.4556 13.5968L14.9912 13.9219L13.5269 14.247L15.0659 21.1796L16.5303 20.8546ZM14.9912 13.9219V12.4219H10.6064V13.9219V15.4219H14.9912V13.9219ZM10.6064 13.9219L10.607 12.4219C11.2435 12.4222 11.7829 12.8819 11.8882 13.5049L10.4092 13.7549L8.93017 14.005C9.06804 14.8204 9.77429 15.4216 10.6059 15.4219L10.6064 13.9219ZM10.4092 13.7549L11.8882 13.505L11.5493 11.5001L10.0703 11.7501L8.59129 12L8.93016 14.0049L10.4092 13.7549ZM10.0703 11.7501L11.1343 10.6928L10.6734 10.2289L9.60938 11.2862L8.54536 12.3435L9.0063 12.8074L10.0703 11.7501ZM9.60938 11.2862V9.78619H7.29492V11.2862V12.7862H9.60938V11.2862ZM7.29492 11.2862H8.79492V10.794H7.29492H5.79492V11.2862H7.29492ZM7.29492 10.794V9.29401H2.46777V10.794V12.294H7.29492V10.794ZM2.46777 10.794H3.96777V9.04596H2.46777H0.967773V10.794H2.46777ZM2.46777 9.04596V7.54596H2V9.04596V10.546H2.46777V9.04596ZM2 9.04596H3.5V7.54303H2H0.5V9.04596H2ZM2 7.54303L3.23153 8.39938L3.93368 7.38962L2.70215 6.53326L1.47062 5.67691L0.768472 6.68668L2 7.54303ZM2.70215 6.53326L2.7046 8.03326L17.6411 8.00885L17.6387 6.50885L17.6362 5.00885L2.6997 5.03327L2.70215 6.53326ZM17.6387 6.50885L18.4002 7.80119L19.0896 7.39494L18.3281 6.1026L17.5666 4.81026L16.8772 5.21651L17.6387 6.50885ZM18.3281 6.1026L18.1005 7.58522L19.6268 7.8196L19.8545 6.33698L20.0821 4.85435L18.5558 4.61998L18.3281 6.1026ZM11.582 10.7569L11.5812 9.2569C10.4032 9.25759 9.45215 10.2134 9.45215 11.3878H10.9521H12.4521C12.4521 11.866 12.0648 12.2566 11.5829 12.2569L11.582 10.7569ZM10.9521 11.3878H9.45215V12.3682H10.9521H12.4521V11.3878H10.9521ZM10.9521 12.3682L9.45215 12.3694C9.45303 13.5445 10.4053 14.4974 11.5812 14.4981L11.582 12.9981L11.5829 11.4981C12.063 11.4984 12.4518 11.8876 12.4521 12.3671L10.9521 12.3682ZM11.582 12.9981V14.4981H14.1143V12.9981V11.4981H11.582V12.9981ZM14.1143 12.9981L14.1147 14.4981C15.2914 14.4978 16.2433 13.5441 16.2441 12.3694L14.7441 12.3682L13.2441 12.3671C13.2445 11.8882 13.633 11.4982 14.1138 11.4981L14.1143 12.9981ZM14.7441 12.3682H16.2441V11.3878H14.7441H13.2441V12.3682H14.7441ZM14.7441 11.3878H16.2441C16.2441 10.2138 15.2935 9.25723 14.1147 9.2569L14.1143 10.7569L14.1138 12.2569C13.6312 12.2568 13.2441 11.8655 13.2441 11.3878H14.7441ZM14.1143 10.7569V9.2569H13.9072V10.7569V12.2569H14.1143V10.7569ZM13.9072 10.7569L12.4073 10.7757C12.4119 11.1352 12.3778 11.2067 12.3743 11.215C12.374 11.2158 12.34 11.3116 12.0481 11.5601L13.0205 12.7022L13.9929 13.8443C14.4642 13.4431 14.8789 12.9896 15.1338 12.3919C15.3855 11.8017 15.4132 11.2254 15.4071 10.738L13.9072 10.7569ZM13.0205 12.7022V11.2022H11.8389V12.7022V14.2022H13.0205V12.7022ZM11.8389 12.7022L12.3849 14.0993C12.8812 13.9053 13.6216 13.5575 14.0228 12.7725C14.42 11.9951 14.2855 11.1797 14.1384 10.6004L12.6846 10.9698L11.2308 11.3392C11.2543 11.4317 11.2682 11.5014 11.2762 11.5527C11.2842 11.6041 11.2848 11.6288 11.2848 11.6325C11.2848 11.6355 11.2844 11.6117 11.2932 11.5692C11.3025 11.5247 11.3203 11.4682 11.3514 11.4073C11.3826 11.3463 11.4192 11.2965 11.4533 11.2593C11.486 11.2236 11.5102 11.2061 11.5139 11.2035C11.5168 11.2014 11.5035 11.2111 11.465 11.2304C11.4266 11.2496 11.3712 11.2745 11.2928 11.3051L11.8389 12.7022ZM12.6846 10.9698L14.1325 10.5779L14.0749 10.365L12.627 10.7569L11.179 11.1488L11.2367 11.3617L12.6846 10.9698ZM12.627 10.7569V9.2569H11.582V10.7569V12.2569H12.627V10.7569Z" fill="black" mask="url(#path-1-outside-1_1468_6865)"/>
            <mask id="path-3-outside-2_1468_6865" maskUnits="userSpaceOnUse" x="1" y="5.1026" width="22" height="17" fill="black">
            <rect fill="white" x="1" y="5.1026" width="22" height="17"/>
            <path d="M19.8545 6.33698V7.02643C19.8648 7.03424 21.3447 8.15992 21.3447 8.40533C21.3446 8.65161 20.8027 9.03326 20.8027 9.03326V10.4249C19.9131 10.8122 19.4719 11.1766 19.0908 12.0381L21.8125 19.1797L16.5303 20.8546L14.9912 13.9219H10.6064C10.5089 13.9219 10.4254 13.8511 10.4092 13.7549L10.0703 11.7501L9.60938 11.2862H7.29492V10.794H2.46777V9.04596H2V7.54303L2.70215 6.53326L17.6387 6.50885L18.3281 6.1026L19.8545 6.33698ZM11.582 10.7569C11.234 10.7571 10.9521 11.0397 10.9521 11.3878V12.3682C10.9524 12.7161 11.2342 12.9979 11.582 12.9981H14.1143C14.4622 12.998 14.7439 12.7161 14.7441 12.3682V11.3878C14.7441 11.0396 14.4624 10.757 14.1143 10.7569H13.9072C13.9179 11.6037 13.7837 12.0524 13.0205 12.7022H11.8389C12.7143 12.3601 12.9435 11.989 12.6846 10.9698L12.627 10.7569H11.582Z"/>
            </mask>
            <path d="M19.8545 6.33698V7.02643C19.8648 7.03424 21.3447 8.15992 21.3447 8.40533C21.3446 8.65161 20.8027 9.03326 20.8027 9.03326V10.4249C19.9131 10.8122 19.4719 11.1766 19.0908 12.0381L21.8125 19.1797L16.5303 20.8546L14.9912 13.9219H10.6064C10.5089 13.9219 10.4254 13.8511 10.4092 13.7549L10.0703 11.7501L9.60938 11.2862H7.29492V10.794H2.46777V9.04596H2V7.54303L2.70215 6.53326L17.6387 6.50885L18.3281 6.1026L19.8545 6.33698ZM11.582 10.7569C11.234 10.7571 10.9521 11.0397 10.9521 11.3878V12.3682C10.9524 12.7161 11.2342 12.9979 11.582 12.9981H14.1143C14.4622 12.998 14.7439 12.7161 14.7441 12.3682V11.3878C14.7441 11.0396 14.4624 10.757 14.1143 10.7569H13.9072C13.9179 11.6037 13.7837 12.0524 13.0205 12.7022H11.8389C12.7143 12.3601 12.9435 11.989 12.6846 10.9698L12.627 10.7569H11.582Z" fill="black"/>
            <path d="M19.8545 6.33698H20.8545C20.8545 5.84329 20.4942 5.42349 20.0063 5.34856L19.8545 6.33698ZM19.8545 7.02643H18.8545C18.8545 7.33881 19.0005 7.63324 19.2491 7.82235L19.8545 7.02643ZM21.3447 8.40533L22.3447 8.40594V8.40533H21.3447ZM20.8027 9.03326L20.2269 8.21571C19.9609 8.40303 19.8027 8.70798 19.8027 9.03326H20.8027ZM20.8027 10.4249L21.2019 11.3417C21.5668 11.1829 21.8027 10.8228 21.8027 10.4249H20.8027ZM19.0908 12.0381L18.1763 11.6336C18.0697 11.8746 18.0625 12.148 18.1564 12.3943L19.0908 12.0381ZM21.8125 19.1797L22.1147 20.133C22.377 20.0498 22.5934 19.8623 22.713 19.6146C22.8326 19.3668 22.8449 19.0807 22.7469 18.8236L21.8125 19.1797ZM16.5303 20.8546L15.554 21.0713C15.6149 21.3452 15.788 21.581 16.0311 21.7211C16.2742 21.8611 16.565 21.8926 16.8325 21.8078L16.5303 20.8546ZM14.9912 13.9219L15.9674 13.7052C15.8658 13.2476 15.46 12.9219 14.9912 12.9219V13.9219ZM10.6064 13.9219L10.6061 14.9219H10.6064V13.9219ZM10.4092 13.7549L9.42316 13.9216L9.42317 13.9217L10.4092 13.7549ZM10.0703 11.7501L11.0563 11.5834C11.0219 11.3797 10.9253 11.1917 10.7797 11.0452L10.0703 11.7501ZM9.60938 11.2862L10.3187 10.5813C10.131 10.3924 9.87569 10.2862 9.60938 10.2862V11.2862ZM7.29492 11.2862H6.29492C6.29492 11.8385 6.74264 12.2862 7.29492 12.2862V11.2862ZM7.29492 10.794H8.29492C8.29492 10.2417 7.84721 9.79401 7.29492 9.79401V10.794ZM2.46777 10.794H1.46777C1.46777 11.3463 1.91549 11.794 2.46777 11.794V10.794ZM2.46777 9.04596H3.46777C3.46777 8.49367 3.02006 8.04596 2.46777 8.04596V9.04596ZM2 9.04596H1C1 9.59824 1.44772 10.046 2 10.046V9.04596ZM2 7.54303L1.17898 6.97213C1.06246 7.1397 1 7.33892 1 7.54303H2ZM2.70215 6.53326L2.70051 5.53327C2.37367 5.5338 2.06772 5.69402 1.88113 5.96236L2.70215 6.53326ZM17.6387 6.50885L17.6403 7.50885C17.8183 7.50856 17.993 7.46077 18.1463 7.37041L17.6387 6.50885ZM18.3281 6.1026L18.4799 5.11418C18.252 5.0792 18.0191 5.12401 17.8205 5.24104L18.3281 6.1026ZM11.582 10.7569V9.7569L11.5814 9.7569L11.582 10.7569ZM10.9521 12.3682H9.95215L9.95215 12.369L10.9521 12.3682ZM11.582 12.9981L11.5814 13.9981H11.582V12.9981ZM14.1143 12.9981V13.9981H14.1145L14.1143 12.9981ZM14.7441 12.3682L15.7441 12.369V12.3682H14.7441ZM14.1143 10.7569L14.1145 9.7569H14.1143V10.7569ZM13.9072 10.7569V9.7569C13.6398 9.7569 13.3836 9.86399 13.1957 10.0542C13.0078 10.2445 12.9039 10.5021 12.9073 10.7695L13.9072 10.7569ZM13.0205 12.7022V13.7022C13.2581 13.7022 13.4879 13.6176 13.6688 13.4636L13.0205 12.7022ZM11.8389 12.7022L11.4748 11.7708C11.027 11.9459 10.7671 12.4149 10.8562 12.8874C10.9452 13.36 11.358 13.7022 11.8389 13.7022V12.7022ZM12.6846 10.9698L13.6538 10.7235C13.6525 10.7185 13.6512 10.7135 13.6498 10.7085L12.6846 10.9698ZM12.627 10.7569L13.5922 10.4957C13.4742 10.0597 13.0786 9.7569 12.627 9.7569V10.7569ZM19.8545 6.33698H18.8545V7.02643H19.8545H20.8545V6.33698H19.8545ZM19.8545 7.02643L19.2491 7.82235C19.2508 7.82365 19.6073 8.09481 19.9588 8.39126C20.1372 8.54167 20.2957 8.68304 20.403 8.79135C20.4589 8.84774 20.4796 8.87391 20.4795 8.87382C20.4782 8.872 20.4732 8.86524 20.466 8.85397C20.459 8.84313 20.447 8.82346 20.4333 8.79599C20.4165 8.7623 20.3447 8.61691 20.3447 8.40533H21.3447H22.3447C22.3447 8.16308 22.2614 7.98014 22.2229 7.90299C22.176 7.80908 22.1229 7.73197 22.0827 7.67806C22.0017 7.56942 21.9066 7.46732 21.8236 7.38353C21.6531 7.21152 21.441 7.02496 21.2481 6.86229C20.8571 6.5326 20.4685 6.23702 20.4599 6.2305L19.8545 7.02643ZM21.3447 8.40533L20.3447 8.40473C20.3448 8.25673 20.3841 8.15067 20.4048 8.10327C20.4267 8.05304 20.4468 8.02536 20.4491 8.02212C20.4522 8.01785 20.4368 8.03829 20.3921 8.07993C20.3521 8.11716 20.3083 8.15325 20.2723 8.18131C20.2551 8.19477 20.2413 8.20508 20.2328 8.21132C20.2286 8.21441 20.2259 8.2164 20.2248 8.21719C20.2242 8.21759 20.2241 8.21767 20.2245 8.21743C20.2246 8.21731 20.2249 8.21711 20.2253 8.21682C20.2255 8.21668 20.2257 8.21652 20.226 8.21633C20.2261 8.21624 20.2263 8.21614 20.2264 8.21604C20.2265 8.21599 20.2266 8.2159 20.2266 8.21588C20.2268 8.2158 20.2269 8.21571 20.8027 9.03326C21.3786 9.85082 21.3787 9.85073 21.3788 9.85064C21.3789 9.85061 21.379 9.85052 21.3791 9.85046C21.3793 9.85033 21.3795 9.8502 21.3797 9.85006C21.3801 9.84978 21.3805 9.84948 21.3809 9.84915C21.3819 9.8485 21.3829 9.84774 21.3841 9.84689C21.3865 9.84519 21.3894 9.8431 21.3929 9.84064C21.3997 9.83572 21.4086 9.82928 21.4192 9.82145C21.4404 9.80585 21.4689 9.78442 21.5025 9.75825C21.5681 9.70706 21.6598 9.63234 21.7553 9.54338C21.8461 9.45882 21.9661 9.33766 22.0708 9.19257C22.1517 9.08055 22.3445 8.79402 22.3447 8.40594L21.3447 8.40533ZM20.8027 9.03326H19.8027V10.4249H20.8027H21.8027V9.03326H20.8027ZM20.8027 10.4249L20.4036 9.50799C19.9158 9.72035 19.4672 9.96117 19.0796 10.3172C18.6823 10.6822 18.4056 11.1152 18.1763 11.6336L19.0908 12.0381L20.0053 12.4427C20.1571 12.0996 20.2916 11.9197 20.4326 11.7901C20.5832 11.6518 20.8001 11.5167 21.2019 11.3417L20.8027 10.4249ZM19.0908 12.0381L18.1564 12.3943L20.8781 19.5359L21.8125 19.1797L22.7469 18.8236L20.0253 11.682L19.0908 12.0381ZM21.8125 19.1797L21.5103 18.2265L16.228 19.9013L16.5303 20.8546L16.8325 21.8078L22.1147 20.133L21.8125 19.1797ZM16.5303 20.8546L17.5065 20.6378L15.9674 13.7052L14.9912 13.9219L14.015 14.1387L15.554 21.0713L16.5303 20.8546ZM14.9912 13.9219V12.9219H10.6064V13.9219V14.9219H14.9912V13.9219ZM10.6064 13.9219L10.6068 12.9219C10.9986 12.9221 11.3304 13.205 11.3952 13.5882L10.4092 13.7549L9.42317 13.9217C9.52051 14.4973 10.0192 14.9217 10.6061 14.9219L10.6064 13.9219ZM10.4092 13.7549L11.3952 13.5883L11.0563 11.5834L10.0703 11.7501L9.0843 11.9167L9.42316 13.9216L10.4092 13.7549ZM10.0703 11.7501L10.7797 11.0452L10.3187 10.5813L9.60938 11.2862L8.90003 11.9911L9.36097 12.4549L10.0703 11.7501ZM9.60938 11.2862V10.2862H7.29492V11.2862V12.2862H9.60938V11.2862ZM7.29492 11.2862H8.29492V10.794H7.29492H6.29492V11.2862H7.29492ZM7.29492 10.794V9.79401H2.46777V10.794V11.794H7.29492V10.794ZM2.46777 10.794H3.46777V9.04596H2.46777H1.46777V10.794H2.46777ZM2.46777 9.04596V8.04596H2V9.04596V10.046H2.46777V9.04596ZM2 9.04596H3V7.54303H2H1V9.04596H2ZM2 7.54303L2.82102 8.11393L3.52317 7.10417L2.70215 6.53326L1.88113 5.96236L1.17898 6.97213L2 7.54303ZM2.70215 6.53326L2.70378 7.53326L17.6403 7.50885L17.6387 6.50885L17.637 5.50885L2.70051 5.53327L2.70215 6.53326ZM17.6387 6.50885L18.1463 7.37041L18.8358 6.96416L18.3281 6.1026L17.8205 5.24104L17.131 5.64729L17.6387 6.50885ZM18.3281 6.1026L18.1764 7.09102L19.7027 7.32539L19.8545 6.33698L20.0063 5.34856L18.4799 5.11418L18.3281 6.1026ZM11.582 10.7569L11.5814 9.7569C10.6802 9.75742 9.95215 10.4888 9.95215 11.3878H10.9521H11.9521C11.9521 11.5905 11.7879 11.7568 11.5826 11.7569L11.582 10.7569ZM10.9521 11.3878H9.95215V12.3682H10.9521H11.9521V11.3878H10.9521ZM10.9521 12.3682L9.95215 12.369C9.95283 13.2683 10.6816 13.9976 11.5814 13.9981L11.582 12.9981L11.5826 11.9981C11.7868 11.9982 11.952 12.1638 11.9521 12.3675L10.9521 12.3682ZM11.582 12.9981V13.9981H14.1143V12.9981V11.9981H11.582V12.9981ZM14.1143 12.9981L14.1145 13.9981C15.015 13.9979 15.7435 13.2681 15.7441 12.369L14.7441 12.3682L13.7441 12.3675C13.7443 12.1641 13.9094 11.9982 14.114 11.9981L14.1143 12.9981ZM14.7441 12.3682H15.7441V11.3878H14.7441H13.7441V12.3682H14.7441ZM14.7441 11.3878H15.7441C15.7441 10.4891 15.0164 9.75715 14.1145 9.7569L14.1143 10.7569L14.114 11.7569C13.9083 11.7568 13.7441 11.5902 13.7441 11.3878H14.7441ZM14.1143 10.7569V9.7569H13.9072V10.7569V11.7569H14.1143V10.7569ZM13.9072 10.7569L12.9073 10.7695C12.9121 11.1502 12.8791 11.3059 12.8342 11.4112C12.7915 11.5114 12.694 11.6668 12.3722 11.9408L13.0205 12.7022L13.6688 13.4636C14.1102 13.0878 14.4614 12.694 14.6739 12.1957C14.8842 11.7025 14.913 11.2104 14.9071 10.7443L13.9072 10.7569ZM13.0205 12.7022V11.7022H11.8389V12.7022V13.7022H13.0205V12.7022ZM11.8389 12.7022L12.2029 13.6336C12.6797 13.4473 13.2653 13.1559 13.5776 12.5449C13.8872 11.9391 13.795 11.2796 13.6538 10.7235L12.6846 10.9698L11.7154 11.216C11.7698 11.4301 11.7843 11.5577 11.7848 11.6291C11.7852 11.6913 11.7748 11.6776 11.7966 11.6348C11.819 11.591 11.8402 11.5853 11.8015 11.6125C11.7538 11.646 11.6582 11.6992 11.4748 11.7708L11.8389 12.7022ZM12.6846 10.9698L13.6498 10.7085L13.5922 10.4957L12.627 10.7569L11.6617 11.0181L11.7193 11.231L12.6846 10.9698ZM12.627 10.7569V9.7569H11.582V10.7569V11.7569H12.627V10.7569Z" fill="white" mask="url(#path-3-outside-2_1468_6865)"/>
            </g>
            <defs>
            <clipPath id="clip0_1468_6865">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-work-bench": `
        <svg class="icon icon-work-bench" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1468_10820)">
            <mask id="path-1-outside-1_1468_10820" maskUnits="userSpaceOnUse" x="-0.90625" y="5.32812" width="25" height="15" fill="black">
            <rect fill="white" x="-0.90625" y="5.32812" width="25" height="15"/>
            <path d="M22.4531 8.90625H22.9688V11.7031H22.4531V15.6562H21.75V11.7031H21.0312V10.6094H19.6562V11.3438H16.7188L19 19.1875H15.9062L14.8438 16.1875H5.9375L5.03125 19.1875H1.8125L4.0625 11.3438H1.09375V9.0625H19.6562V9.76562H21.0312V8.90625H21.75V7.32812H22.4531V8.90625Z"/>
            </mask>
            <path d="M22.4531 8.90625H22.9688V11.7031H22.4531V15.6562H21.75V11.7031H21.0312V10.6094H19.6562V11.3438H16.7188L19 19.1875H15.9062L14.8438 16.1875H5.9375L5.03125 19.1875H1.8125L4.0625 11.3438H1.09375V9.0625H19.6562V9.76562H21.0312V8.90625H21.75V7.32812H22.4531V8.90625Z" fill="white"/>
            <path d="M22.4531 8.90625H21.3531C21.3531 9.51376 21.8456 10.0062 22.4531 10.0062V8.90625ZM22.9688 8.90625H24.0688C24.0688 8.29874 23.5763 7.80625 22.9688 7.80625V8.90625ZM22.9688 11.7031V12.8031C23.5763 12.8031 24.0688 12.3106 24.0688 11.7031H22.9688ZM22.4531 11.7031V10.6031C21.8456 10.6031 21.3531 11.0956 21.3531 11.7031H22.4531ZM22.4531 15.6562V16.7563C23.0606 16.7563 23.5531 16.2638 23.5531 15.6562H22.4531ZM21.75 15.6562H20.65C20.65 16.2638 21.1425 16.7563 21.75 16.7563V15.6562ZM21.75 11.7031H22.85C22.85 11.0956 22.3575 10.6031 21.75 10.6031V11.7031ZM21.0312 11.7031H19.9312C19.9312 12.3106 20.4237 12.8031 21.0312 12.8031V11.7031ZM21.0312 10.6094H22.1313C22.1313 10.0019 21.6388 9.50938 21.0312 9.50938V10.6094ZM19.6562 10.6094V9.50938C19.0487 9.50938 18.5562 10.0019 18.5562 10.6094H19.6562ZM19.6562 11.3438V12.4437C20.2638 12.4437 20.7563 11.9513 20.7563 11.3438H19.6562ZM16.7188 11.3438V10.2438C16.3727 10.2438 16.0468 10.4066 15.839 10.6834C15.6312 10.9602 15.5659 11.3186 15.6625 11.6509L16.7188 11.3438ZM19 19.1875V20.2875C19.3461 20.2875 19.672 20.1246 19.8797 19.8478C20.0875 19.571 20.1529 19.2126 20.0562 18.8803L19 19.1875ZM15.9062 19.1875L14.8694 19.5547C15.0249 19.9939 15.4403 20.2875 15.9062 20.2875V19.1875ZM14.8438 16.1875L15.8806 15.8203C15.7251 15.3811 15.3097 15.0875 14.8438 15.0875V16.1875ZM5.9375 16.1875V15.0875C5.45251 15.0875 5.02475 15.4051 4.8845 15.8694L5.9375 16.1875ZM5.03125 19.1875V20.2875C5.51624 20.2875 5.944 19.9699 6.08425 19.5056L5.03125 19.1875ZM1.8125 19.1875L0.755142 18.8842C0.659911 19.2162 0.726131 19.5736 0.933968 19.8495C1.14181 20.1253 1.46713 20.2875 1.8125 20.2875V19.1875ZM4.0625 11.3438L5.11986 11.6471C5.21509 11.3151 5.14887 10.9576 4.94103 10.6818C4.73319 10.406 4.40787 10.2438 4.0625 10.2438V11.3438ZM1.09375 11.3438H-0.00625002C-0.00625002 11.9513 0.486237 12.4437 1.09375 12.4437L1.09375 11.3438ZM1.09375 9.0625V7.9625C0.486237 7.9625 -0.00625002 8.45499 -0.00625002 9.0625H1.09375ZM19.6562 9.0625H20.7563C20.7563 8.45499 20.2638 7.9625 19.6562 7.9625V9.0625ZM19.6562 9.76562H18.5562C18.5562 10.3731 19.0487 10.8656 19.6562 10.8656V9.76562ZM21.0312 9.76562V10.8656C21.6388 10.8656 22.1313 10.3731 22.1313 9.76562H21.0312ZM21.0312 8.90625V7.80625C20.4237 7.80625 19.9312 8.29874 19.9312 8.90625H21.0312ZM21.75 8.90625V10.0062C22.3575 10.0062 22.85 9.51376 22.85 8.90625H21.75ZM21.75 7.32812V6.22812C21.1425 6.22812 20.65 6.72061 20.65 7.32812H21.75ZM22.4531 7.32812H23.5531C23.5531 6.72061 23.0606 6.22812 22.4531 6.22812V7.32812ZM22.4531 8.90625V10.0062H22.9688V8.90625V7.80625H22.4531V8.90625ZM22.9688 8.90625H21.8687V11.7031H22.9688H24.0688V8.90625H22.9688ZM22.9688 11.7031V10.6031H22.4531V11.7031V12.8031H22.9688V11.7031ZM22.4531 11.7031H21.3531V15.6562H22.4531H23.5531V11.7031H22.4531ZM22.4531 15.6562V14.5563H21.75V15.6562V16.7563H22.4531V15.6562ZM21.75 15.6562H22.85V11.7031H21.75H20.65V15.6562H21.75ZM21.75 11.7031V10.6031H21.0312V11.7031V12.8031H21.75V11.7031ZM21.0312 11.7031H22.1313V10.6094H21.0312H19.9312V11.7031H21.0312ZM21.0312 10.6094V9.50938H19.6562V10.6094V11.7094H21.0312V10.6094ZM19.6562 10.6094H18.5562V11.3438H19.6562H20.7563V10.6094H19.6562ZM19.6562 11.3438V10.2438H16.7188V11.3438V12.4437H19.6562V11.3438ZM16.7188 11.3438L15.6625 11.6509L17.9438 19.4947L19 19.1875L20.0562 18.8803L17.775 11.0366L16.7188 11.3438ZM19 19.1875V18.0875H15.9062V19.1875V20.2875H19V19.1875ZM15.9062 19.1875L16.9431 18.8203L15.8806 15.8203L14.8438 16.1875L13.8069 16.5547L14.8694 19.5547L15.9062 19.1875ZM14.8438 16.1875V15.0875H5.9375V16.1875V17.2875H14.8438V16.1875ZM5.9375 16.1875L4.8845 15.8694L3.97825 18.8694L5.03125 19.1875L6.08425 19.5056L6.9905 16.5056L5.9375 16.1875ZM5.03125 19.1875V18.0875H1.8125V19.1875V20.2875H5.03125V19.1875ZM1.8125 19.1875L2.86986 19.4908L5.11986 11.6471L4.0625 11.3438L3.00514 11.0404L0.755142 18.8842L1.8125 19.1875ZM4.0625 11.3438V10.2438H1.09375V11.3438V12.4437H4.0625V11.3438ZM1.09375 11.3438H2.19375V9.0625H1.09375H-0.00625002V11.3438H1.09375ZM1.09375 9.0625V10.1625H19.6562V9.0625V7.9625H1.09375V9.0625ZM19.6562 9.0625H18.5562V9.76562H19.6562H20.7563V9.0625H19.6562ZM19.6562 9.76562V10.8656H21.0312V9.76562V8.66562H19.6562V9.76562ZM21.0312 9.76562H22.1313V8.90625H21.0312H19.9312V9.76562H21.0312ZM21.0312 8.90625V10.0062H21.75V8.90625V7.80625H21.0312V8.90625ZM21.75 8.90625H22.85V7.32812H21.75H20.65V8.90625H21.75ZM21.75 7.32812V8.42813H22.4531V7.32812V6.22812H21.75V7.32812ZM22.4531 7.32812H21.3531V8.90625H22.4531H23.5531V7.32812H22.4531Z" fill="black" mask="url(#path-1-outside-1_1468_10820)"/>
            <path d="M6.60938 14.0312L7.35938 11.2656H13.5L14.2656 14.0312H6.60938Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1468_10820">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-wunderfizz": `
        <svg class="icon icon-wunderfizz" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1624_4425)">
            <circle cx="12" cy="12" r="11.35" fill="white" stroke="black" stroke-width="1.3"/>
            <path d="M18.9062 16.5625L11.7188 21L4.53125 16.5625V6.125H18.9062V16.5625ZM16.6562 10.4062C16.5519 10.5693 16.4245 10.7096 16.293 10.8242C15.9832 11.094 15.5808 11.3005 15.1533 11.458C14.2917 11.7754 13.1544 11.9561 11.9375 11.9561C10.7206 11.9561 9.58327 11.7754 8.72168 11.458C8.29423 11.3005 7.89179 11.094 7.58203 10.8242C7.46347 10.7209 7.34819 10.5968 7.25 10.4541V16.625L11.7188 19.4375L16.75 16.625V10.4062H16.6562ZM11.9375 8.09375C9.64215 8.09375 7.78138 8.77936 7.78125 9.625C7.78131 10.0193 8.18706 10.3761 8.85156 10.6475C8.75808 10.5156 8.70705 10.3757 8.70703 10.2305C8.70714 9.4517 10.1534 8.82031 11.9375 8.82031C12.016 8.82031 12.0938 8.82182 12.1709 8.82422C12.1765 8.8032 12.1816 8.78147 12.1875 8.75977C12.2407 8.56357 12.3105 8.33588 12.3867 8.10254C12.2392 8.0967 12.0893 8.09375 11.9375 8.09375ZM14.835 9.08691C14.7483 9.19965 14.6589 9.31005 14.5723 9.41602C14.9469 9.64625 15.1679 9.92658 15.168 10.2305C15.1679 10.3759 15.1162 10.5155 15.0225 10.6475C15.6875 10.376 16.0937 10.0195 16.0938 9.625C16.0937 9.25648 15.7401 8.91852 15.1514 8.6543C15.0512 8.79742 14.9443 8.94478 14.835 9.08691ZM14.7266 6.77051C14.4373 6.62889 13.7349 6.39852 13.3506 6.69141C13.0383 6.89492 12.367 9.03844 12.3672 9.36426C12.3675 9.68957 12.4243 9.89476 12.707 10.0361C13.0021 10.1602 13.3668 10.1017 13.6211 9.98438C13.8755 9.86678 15.3828 8.0234 15.3828 7.57715C15.3823 6.99815 14.7315 6.77221 14.7266 6.77051ZM13.5234 7.28223C13.6365 7.01101 14.0103 6.90802 14.3584 7.05273C14.7066 7.19754 14.8969 7.5352 14.7842 7.80664C14.6713 8.07806 14.2975 8.1809 13.9492 8.03613C13.6011 7.89128 13.4107 7.55362 13.5234 7.28223Z" fill="black"/>
            </g>
            <defs>
            <clipPath id="clip0_1624_4425">
            <rect width="24" height="24" fill="white"/>
            </clipPath>
            </defs>
        </svg>
    `,
    "icon-domination-a": `
        <svg class="icon icon-domination-a" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="8.625" fill="#FF0000" stroke="#FF8080" stroke-width="0.75"/>
            <g filter="url(#filter0_d_1501_11345)">
            <path d="M12.0456 7.578L12.7596 8.208H11.1496L11.8776 7.578L10.4636 17H8.37761L10.4076 6.5H13.5856L15.6296 17H13.4456L12.0456 7.578ZM9.65161 13.22H14.3136V14.816H9.65161V13.22Z" fill="white"/>
            </g>
            <defs>
            <filter id="filter0_d_1501_11345" x="7.37762" y="5.5" width="9.25201" height="12.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset/>
            <feGaussianBlur stdDeviation="0.5"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1501_11345"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1501_11345" result="shape"/>
            </filter>
            </defs>
        </svg>
    `,
    "icon-hardpoint-1": `
        <svg class="icon icon-hardpoint-1" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="9" fill="white"/>
            <path d="M11.6855 8.974H11.4195L10.3275 9.45V7.63L11.8255 7H13.6175V17.5H11.6855V8.974Z" fill="black"/>
        </svg>
    `,
    "icon-main-spawn": `
        <svg class="icon icon-main-spawn"width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.8438 23H4.15625L5.15625 18.125H7.41016L7.5791 19.125H5.97168L5.38184 22H8.06445L8.06836 22.0215H15.876L15.8799 22H18.6182L18.0283 19.125H16.377L16.5498 18.125H18.8438L19.8438 23Z" fill="white"/>
            <path d="M9.336 20.5213L7.17188 7.71015L12.2195 6.07811L16.8281 7.71015L14.6131 20.5213H9.336Z" fill="white"/>
            <path d="M9.58594 4.87107V1.24997H14.4141V4.87107H9.58594Z" fill="white"/>
        </svg>
    `,
    "icon-domination": `
        <svg class="icon icon-domination" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5.78784 15.1392C5.8511 15.7077 6.53542 17.0816 7.95972 17.3423C7.95693 17.3403 7.95371 17.3384 7.95093 17.3364C8.04537 17.3556 8.14331 17.367 8.24292 17.3765C8.93934 17.4267 9.79317 17.2199 10.8152 16.5659C11.8335 16.0908 12.3095 15.9779 13.5994 16.4292C14.8894 16.8811 15.1613 19.2817 14.0076 19.5542C12.8534 19.8258 12.9199 19.0121 12.4451 19.2827C11.6377 19.5522 11.8963 21.9553 11.9011 21.9995C11.3732 20.5658 11.1956 19.9471 11.4265 19.2827C12.0988 17.6075 13.4644 18.8068 13.7361 18.603C14.0053 18.3973 13.3933 17.2658 11.8328 17.7886C10.2705 18.3123 9.93168 18.7393 8.16577 18.5357C6.39944 18.3318 5.50544 16.5488 5.78784 15.1392ZM12.906 17.8413C13.0969 17.8964 13.2432 17.9944 13.3542 18.104C13.4494 18.1981 13.5193 18.3026 13.5691 18.397C13.562 18.3988 13.5538 18.4001 13.5466 18.4019C13.3719 18.3237 13.1351 18.2339 12.8767 18.1939C12.606 18.152 12.3013 18.1635 12.0164 18.3062C11.8815 18.3738 11.7544 18.4703 11.6394 18.5982C11.2781 18.5844 10.9235 18.5422 10.5789 18.4741C10.6731 18.4287 10.7706 18.3817 10.8708 18.3335C11.1466 18.201 11.461 18.0576 11.8582 17.9234C11.8726 17.9235 11.8876 17.9243 11.9021 17.9243C12.2439 17.9243 12.5795 17.8953 12.906 17.8413ZM16.6677 15.6392C16.6699 15.7505 16.6591 15.8638 16.6326 15.981C16.5536 16.3282 16.3337 16.7364 15.8728 17.2944C15.8618 17.3078 15.8535 17.3235 15.8484 17.3394C15.5576 17.5473 15.249 17.7334 14.9265 17.8941C14.8964 17.6665 14.836 17.4364 14.7468 17.2222C15.4906 16.8301 16.1448 16.2893 16.6677 15.6392ZM4.63452 10.1128C4.27311 9.02571 4.56673 5.83391 7.8269 6.17336C6.31227 7.36324 6.86541 9.06814 8.52515 9.78273C8.56816 9.52535 8.62049 9.26995 8.6814 9.01906C8.24227 8.87688 7.82382 8.71148 7.43628 8.52296C7.30147 8.45727 7.2447 8.29456 7.3103 8.15968C7.37614 8.02545 7.53899 7.96943 7.67358 8.03468C8.03002 8.20807 8.41734 8.35887 8.82397 8.49171C8.95754 8.04738 9.12079 7.6177 9.31323 7.21144C9.3777 7.07644 9.54022 7.01853 9.67554 7.08253C9.81039 7.14679 9.86782 7.30865 9.80444 7.44386C9.62382 7.82519 9.47015 8.22919 9.34448 8.64699C9.99816 8.82442 10.6936 8.94672 11.4011 9.01222L11.1462 9.33156L11.1052 9.38332L11.1384 9.53273C10.4764 9.46046 9.82478 9.34015 9.20581 9.17238C9.14339 9.43242 9.08887 9.69704 9.04663 9.96437C9.34049 10.0437 9.65957 10.0958 9.99976 10.1128L14.7546 10.0444C14.7937 10.0445 14.8335 10.0487 14.8728 10.0503C14.8403 9.83282 14.7995 9.61691 14.7537 9.40382C14.0525 9.54436 13.316 9.61149 12.5769 9.61378L12.6365 9.39894L12.4031 9.06496C13.1642 9.07402 13.9176 9.01506 14.6267 8.87453C14.4901 8.37527 14.3155 7.89402 14.1023 7.44386C14.0385 7.30837 14.0958 7.14669 14.2312 7.08253C14.3665 7.01887 14.5282 7.07652 14.5925 7.21144C14.8224 7.69665 15.0102 8.21492 15.156 8.75246C15.5973 8.63626 16.0178 8.48863 16.405 8.30519C16.5403 8.24168 16.7021 8.29918 16.7664 8.4341C16.8305 8.5695 16.7726 8.73197 16.6375 8.7964C16.2147 8.99666 15.7592 9.15627 15.2839 9.28078C15.3437 9.55764 15.393 9.83909 15.4314 10.1226C16.7941 10.4242 18.1508 11.5875 18.5583 13.1011C19.0334 14.867 18.2863 16.9726 15.9773 17.3804C17.0635 16.2938 16.9856 15.2658 16.7244 14.5278C16.4296 13.8731 15.9761 13.4721 15.4275 13.2339C15.3741 13.6175 15.3 13.9958 15.2068 14.3638C15.3847 14.2974 15.5584 14.2251 15.7253 14.146C15.8607 14.0824 16.0234 14.1408 16.0876 14.2759C16.1515 14.4112 16.0928 14.5728 15.9578 14.6372C15.6607 14.7779 15.3468 14.8976 15.0222 15.0005C14.9002 15.3724 14.7573 15.732 14.5916 16.0728C14.5259 16.2076 14.3632 16.2642 14.2283 16.1987C14.0936 16.133 14.0377 15.9703 14.1033 15.8355C14.2063 15.6237 14.2994 15.403 14.3845 15.1773C13.4126 15.406 12.3621 15.4888 11.322 15.4448C10.725 15.4196 10.1278 15.3508 9.54761 15.2456C9.62579 15.4475 9.71081 15.645 9.80347 15.8355C9.86886 15.9702 9.81192 16.1329 9.67749 16.1987C9.54261 16.2642 9.37981 16.2076 9.31421 16.0728C9.16573 15.7675 9.03506 15.4473 8.92163 15.1167C8.14329 14.934 7.40689 14.6811 6.75659 14.3648C6.62195 14.299 6.56602 14.1363 6.63159 14.0015C6.69743 13.8671 6.86021 13.8101 6.99487 13.8755C7.51992 14.1309 8.1095 14.3408 8.73511 14.5064C8.59577 13.9886 8.49672 13.4497 8.43726 12.9019C6.55562 12.3512 4.94822 11.0546 4.63452 10.1128ZM5.12866 11.3023C5.32229 11.5095 5.5456 11.7198 5.79077 11.9282C5.83243 14.1383 7.04675 16.0613 8.83765 17.1011C8.83324 17.1016 8.82837 17.1025 8.82397 17.103C8.24095 17.1693 7.73684 17.0437 7.31909 16.8237C5.96163 15.5819 5.11019 13.7958 5.11011 11.8111C5.11012 11.6402 5.11625 11.4699 5.12866 11.3023ZM14.9001 13.0571C13.1902 12.6419 10.8567 13.3335 9.32104 13.1011C9.21495 13.085 9.10889 13.0639 9.00366 13.0425C9.07423 13.5947 9.18407 14.1357 9.34058 14.6499C9.98835 14.7847 10.6649 14.8731 11.3445 14.9019C12.469 14.9494 13.5896 14.8415 14.5896 14.563C14.7315 14.0795 14.8334 13.5733 14.9001 13.0571ZM13.9324 5.32668C16.6916 6.18991 18.6938 8.76731 18.6941 11.8111C18.6941 12.0991 18.6762 12.384 18.6414 12.6626C18.4885 12.2613 18.2702 11.8812 18.0085 11.5415C17.8978 8.99549 16.2298 6.85256 13.9333 6.04347C14.0004 5.81131 13.9912 5.57704 13.9324 5.32668ZM14.1433 3.04836C18.332 3.04868 21.2798 7.08385 18.6658 10.2486C18.7221 9.95241 18.4215 8.54973 17.2 7.26027C17.3336 5.77875 13.9951 5.16382 13.9402 5.15382C14.8222 4.47477 14.8901 3.65942 14.1433 3.04836ZM12.1189 9.60597C12.0795 9.60467 12.0401 9.60471 12.0007 9.60304C11.8816 9.598 11.7622 9.58837 11.6433 9.57961L11.8875 9.27589L12.1189 9.60597ZM12.0378 5.56203V8.7798L12.488 9.42433L12.4451 9.57961H12.2654L11.8943 9.04933L11.4646 9.58644H11.2908L11.2517 9.4175L11.7654 8.77492V5.56203L11.9021 5.42628L12.0378 5.56203ZM12.2136 3.14503C12.239 3.17024 12.2735 3.18402 12.3093 3.1841H12.8601C12.8634 3.18391 12.8677 3.18353 12.8708 3.18312L12.8738 3.18214C12.8765 3.18178 12.8799 3.18175 12.8826 3.18117L12.906 3.17336C12.9117 3.1709 12.9183 3.16783 12.9236 3.16457C12.933 3.15871 12.9423 3.15095 12.95 3.14308L13.0564 3.03664V3.11671C13.0565 3.15258 13.0712 3.18704 13.0964 3.21242L13.2322 3.34816C13.2852 3.40115 13.3715 3.40115 13.4246 3.34816L13.5603 3.21242L13.5691 3.20265C13.5885 3.17866 13.6003 3.14791 13.6003 3.11671V3.03664L13.7078 3.14503C13.7608 3.19781 13.8472 3.19795 13.9001 3.14503L13.9089 3.13429C13.9222 3.1178 13.9318 3.09829 13.9363 3.07863C14.3023 3.42315 14.46 3.72894 14.4089 4.06105C14.3818 4.23594 14.2969 4.41186 14.1687 4.59621C14.0458 4.77266 13.8791 4.96283 13.6775 5.17238C13.7817 5.49609 13.8091 5.75607 13.7332 6.00343C13.6564 6.25198 13.4773 6.47909 13.1941 6.74464C13.2104 7.12944 13.1692 7.41386 13.0476 7.65773C12.9227 7.90747 12.7156 8.10835 12.4187 8.33253L12.4001 8.34718H12.1736V7.73488H12.3777C12.4006 7.68492 13.0958 6.16976 13.1248 5.83351C13.1538 5.49418 13.1251 5.15812 13.1248 5.15382L13.3289 4.40675V3.65968L13.0564 3.79543C13.0559 3.80181 13.0007 4.51933 12.8533 4.9507C12.7709 5.19121 12.5904 5.54331 12.5808 5.56203C12.5834 5.54312 12.6323 5.18391 12.6492 4.9507C12.6815 4.50291 12.6495 3.80168 12.6492 3.79543H12.4451L12.3093 3.65968H11.5339L11.4265 3.79543H11.155C11.1548 3.80261 11.1287 4.71188 11.155 4.9507L11.2224 5.56203C11.2155 5.54853 11.034 5.19313 10.9509 4.9507C10.8034 4.51934 10.7473 3.80173 10.7468 3.79543L10.5437 3.65968L10.4753 4.40675L10.7468 5.15382C10.7465 5.1589 10.7187 5.61307 10.7468 5.90187C10.8201 6.65039 11.4086 7.70298 11.4265 7.73488H11.6296V8.34718H11.4031L11.3845 8.33253C11.0795 8.09054 10.8712 7.87893 10.7478 7.62843C10.6275 7.38397 10.5912 7.10823 10.6101 6.74464C10.3549 6.50893 10.1977 6.29846 10.1248 6.05128C10.0529 5.80688 10.0654 5.53422 10.1296 5.18214C9.66792 4.81051 9.42047 4.41758 9.39136 4.03664C9.36427 3.67624 9.53398 3.34307 9.86597 3.06789C9.86998 3.09588 9.88258 3.12347 9.90405 3.14503L9.91479 3.15382C9.96813 3.19706 10.0468 3.19463 10.0964 3.14503L10.2039 3.03664V3.11671C10.2039 3.15261 10.2186 3.18704 10.2439 3.21242L10.3796 3.34816C10.4326 3.40112 10.518 3.40105 10.571 3.34816L10.7078 3.21242L10.7166 3.20265C10.7359 3.17867 10.7468 3.14788 10.7468 3.11671V3.03664L10.8552 3.14503C10.8668 3.15646 10.8804 3.16495 10.8943 3.1714C10.8959 3.17219 10.8976 3.17362 10.8992 3.17433C10.9003 3.17471 10.902 3.17493 10.9031 3.17531L10.9236 3.18214C10.9253 3.18234 10.9278 3.18192 10.9294 3.18214C10.9356 3.18311 10.9426 3.18399 10.949 3.1841H11.4949C11.5305 3.18385 11.5654 3.17017 11.5906 3.14503L11.7546 2.98097H12.0496L12.2136 3.14503ZM9.90112 5.31789C9.86415 5.57673 9.85881 5.80988 9.90894 6.0298C8.8495 6.39512 7.921 7.04424 7.21558 7.88527C7.2042 7.73446 7.21529 7.58153 7.24976 7.43019C7.3261 7.09575 7.52405 6.68523 7.86206 6.35011C8.47139 5.89867 9.15947 5.54623 9.90112 5.31789ZM10.1589 2.18898C10.3659 2.01005 10.6767 1.95952 11.0251 2.0298H12.781C13.1693 1.9903 13.4541 2.01199 13.6355 2.17531C13.7983 2.32227 13.8604 2.56892 13.8699 2.92238L13.4246 2.47707C13.3784 2.4311 13.3063 2.42533 13.2537 2.45949L13.2478 2.46437L13.2371 2.47316L13.2322 2.47707L12.7966 2.91261H12.366L12.2019 2.74855C12.1767 2.72347 12.1418 2.70973 12.1062 2.70949H11.698C11.6713 2.70955 11.6447 2.71753 11.6228 2.73195L11.6179 2.73586L11.6072 2.74464L11.6023 2.74855L11.4382 2.91261H11.0076L10.571 2.47707C10.5249 2.43139 10.4537 2.42552 10.4011 2.45949L10.3953 2.46437L10.3845 2.47316L10.3796 2.47707L9.91675 2.93996C9.88314 2.60995 9.97093 2.35203 10.1589 2.18898Z" fill="white"/>
        </svg>
    `,
    "icon-hardpoint": `
        <svg class="icon icon-hardpoint" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.476 16.7911L18.2106 20.0634L12.0001 22L5.85613 20.0634L6.52394 16.7911L10.7591 15.7581C10.7764 15.9301 10.7947 16.1046 10.8138 16.2816L7.65922 17.0582L7.19175 19.5959L12.0001 20.9983L16.8082 19.5959L16.3407 17.0582L13.1697 16.2776L13.1763 15.7423L17.476 16.7911ZM10.9344 17.3334L9.80234 17.6258L9.72943 18.7945L12 19.3955L14.2705 18.7945L14.1978 17.6258L13.1564 17.3569L13.1637 16.7603L15.3612 17.333L15.4726 19.1361L12.0001 20.1301L8.52737 19.1361L8.63889 17.333L10.8661 16.7526C10.8878 16.943 10.9106 17.1366 10.9344 17.3334ZM11.2521 12.124L11.2877 12.1507H12.1804L12.217 12.1215L12.5144 11.8836H13.202V12.3168C13.202 12.3699 13.1809 12.4208 13.1433 12.4584L12.9339 12.6677L12.8681 18.2603H13.4692L13.2688 18.5274H10.7311L10.5976 18.2603H11.2637C10.9317 15.643 10.7734 13.651 10.7027 11.7119L11.2521 12.124ZM7.32531 12.1832L8.26025 14.988L5.45544 10.3133L7.32531 12.1832ZM15.8065 14.988L16.6747 12.1832L18.5445 10.3801L15.8065 14.988ZM8.52737 7.50852L9.92977 14.5205L7.12497 6.03934L8.52737 7.50852ZM14.0702 14.5205L15.4726 7.50852L16.875 6.10612L14.0702 14.5205ZM12.2108 2.00013C12.4232 2.00355 12.632 2.07232 12.793 2.21509C12.9463 2.35102 13.0439 2.54353 13.065 2.77738L13.0682 2.82472L13.0683 2.82811L13.1351 5.23223C13.1357 5.25234 13.1331 5.27247 13.1277 5.29184C12.6584 6.96906 12.584 7.95946 12.6643 9.75938L12.951 10.0461H13.6026C13.7132 10.0461 13.8029 10.1358 13.8029 10.2464L13.8031 11.2481C13.8031 11.3151 13.7696 11.3778 13.7139 11.415L13.4024 11.6226V11.6165H12.4206L12.384 11.6457L12.0866 11.8836H11.3766L10.6911 11.3694C10.637 9.64336 10.6486 7.93386 10.6642 5.8373L10.6655 5.81656C10.6663 5.80971 10.6675 5.80284 10.6689 5.79609C10.9271 4.61278 11.0781 3.9692 11.0649 2.83607C11.0646 2.80553 11.0712 2.77523 11.0844 2.74764C11.3234 2.24538 11.7859 1.99332 12.2108 2.00013Z" fill="white"/>
        </svg>
    `,
    "icon-search-and-destroy": `
        <svg class="icon icon-search-and-destroy" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8.6709 2.26278H15.3662V1.4659H18.3428V2.26278H19.8301L19.458 11.7218L18.874 12.7843L22.7549 17.9923L23.125 19.3741L20.627 21.8712H16.376V22.1358L16.2461 22.2608L15.5225 22.9571L15.3984 23.0753H14.127L14.0029 22.8731L13.9053 22.714H10.333L10.2588 22.8516L10.1387 23.0753H8.88379L8.76172 22.962L8.00977 22.2667L7.87402 22.1407V21.8712H3.25098L1.125 19.3741V17.9923L5.26953 12.7843L4.5791 11.7218L4.10059 2.26278H5.96094V1.4659H8.6709V2.26278ZM8.29883 21.9542L9.0498 22.6505H9.88477L10.0801 22.2882H14.1426L14.3652 22.6505H15.2275L15.9512 21.9542V19.339H14.9492V20.7022L14.3652 21.2872H9.88477L9.32812 20.7022V19.339H8.29883V21.9542ZM2.87891 18.2052H21.2646L18.0234 13.422H5.90723L2.87891 18.2052ZM20.2822 17.7003H3.80859L5.29688 15.5216H18.7676L20.2822 17.7003ZM18.502 15.1495L5.46777 15.0489L6.13184 13.9063H17.8105L18.502 15.1495ZM5.37598 11.0841L5.90723 12.0401H18.0234L18.6611 11.4561L18.9268 3.1661H5.11035L5.37598 11.0841ZM10.9287 6.46004H12.417L9.54785 9.86141L14.7021 5.98251H12.8955L14.3682 4.16219H17.4648L17.8105 4.5079V10.6456L17.3057 11.0968H15.6855L15.499 10.8048H8.53809L8.27246 11.0968H6.57129L6.09375 10.6456V4.5079L6.57129 4.16219H12.8623L10.9287 6.46004Z" fill="white"/>
        </svg>
    `,
    "icon-objective": `
        <svg class="icon icon-objective" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5.16364 20.6992V4.64989C5.16364 3.93149 4.58126 3.34911 3.86285 3.34911C3.14445 3.34911 2.56207 3.93149 2.56207 4.64989V20.6992C2.56207 21.4176 3.14445 22 3.86285 22C4.58126 22 5.16364 21.4176 5.16364 20.6992Z" fill="white"/>
            <path d="M6.88728 3.27138C6.88769 2.9288 7.09791 2.61812 7.42249 2.50853C12.8483 0.676579 15.0935 4.49071 20.2791 3.08807C20.8455 2.93486 21.438 3.33727 21.438 3.92403V13.3552C21.438 13.6982 21.2277 14.0094 20.9027 14.1191C15.4769 15.9506 13.2317 12.1359 8.04516 13.5398C7.47923 13.693 6.88716 13.2914 6.88655 12.7051C6.88329 9.56226 6.88354 6.41772 6.88728 3.27138Z" fill="white"/>
        </svg>
    `,
    "icon-point-of-interest": `
        <svg class="icon icon-point-of-interest" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20.0906 2.5V5.139H13.4606V22H10.5356V5.139H3.90557V2.5H20.0906Z" fill="white"/>
        </svg>
    `,
};

// categories.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

ATVI.components.mapguide.categories = (() => {
    /**
     * Represents a category for map markers.
     * @typedef {Object} Category
     * @property {string} name - Display name of the category.
     * @property {string} [iconUrl] - URL or SVG reference for the category icon.
     * @property {string} [iconSvgKey] - Key for SVG symbol defined in HTML.
     * @property {Array<number>} [iconOffset] - Optional offset for icon positioning [x, y].
     * @property {string} [parentCategory] - Optional parent category grouping.
     */

    /**
     * A collection of all categories keyed by their unique identifier from CMS dialog category values.
     * @type {Object<string, Category>}
     */
    const categories = {
        // Example entry:
        // layer_borders: {
        //     iconOffset: [0, 0],
        //     iconSvgKey: "icon-layers",
        //     iconUrl: "#icon-layers",
        //     name: "Borders",
        //     parentCategory: "Layers",
        // },

        // Parent Categories
        Contract: {
            // iconSvgKey: "icon-contract",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Contracts.svg",
            name: "Contract",
        },
        Objective: {
            // iconSvgKey: "icon-objective",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_Objective.svg",
            name: "Objective",
        },
        Perks: {
            iconSvgKey: "icon-perks",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Perks.svg",
            name: "Perks",
        },
        POI: {
            iconSvgKey: "icon-point-of-interest",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_POIs.svg",
            name: "POI",
        },
        Utility: {
            // iconSvgKey: "icon-utility",
            // iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_Utility.svg",
            name: "Utility",
        },
        Vehicle: {
            // iconSvgKey: "icon-vehicle",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Vehicle.svg",
            name: "Vehicle",
        },
        Exfils: {
            // iconSvgKey: "icon-exfil",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_generalextractionpoint.png",
            name: "Exfils",
        },

        // Layers
        layer_borders: {
            iconSvgKey: "icon-layers",
            iconUrl: "#icon-layers",
            name: "Borders",
            parentCategory: "Layers",
        },
        layer_grid: {
            iconSvgKey: "icon-layers",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Grid.svg",
            name: "Grid",
            parentCategory: "Layers",
        },
        layer_miniMap: {
            iconSvgKey: "icon-layers",
            iconUrl: "#icon-layers",
            name: "Mini Map",
            parentCategory: "Layers",
        },
        layer_mp_domination: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Layers_DominationZone_A.svg",
            name: "Domination Zone",
            parentCategory: "Layers",
        },
        layer_mp_hardpoint: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Layers_HardpointZone_1.svg",
            name: "Hardpoint Zone",
            parentCategory: "Layers",
        },
        layer_mp_searchAndDestroy: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Layers_SearchAndDestroyZone_A.svg",
            name: "Search and Destroy Zone",
            parentCategory: "Layers",
        },
        layer_threatArea: {
            iconUrl: "#icon-layers",
            name: "Threat Area",
            parentCategory: "Layers",
        },
        layer_train: {
            iconUrl: "#icon-layers",
            name: "Train",
            parentCategory: "Layers",
        },

        // General Categories
        poiLabel: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_POIs.svg",
            name: "POI Label Primary",
            parentCategory: "POI",
        },
        poiLabelSecondary: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_POIs.svg",
            name: "POI Label Secondary",
            parentCategory: "POI",
        },
        advancedIntel: {
            iconUrl: "advancedIntel",
            name: "Advanced Intel",
        },

        // Campaign Categories
        campaign_contract_dawgWalk: {
            name: "Dawg Walk",
            parentCategory: "Contract",
        },
        campaign_contract_guildCheckpoint: {
            name: "Guild Checkpoint",
            parentCategory: "Contract",
        },
        campaign_contract_guildConvoy: {
            name: "Guild Convoy",
            parentCategory: "Contract",
        },
        campaign_contract_guildDrone: {
            name: "Guild Drone",
            parentCategory: "Contract",
        },
        campaign_contract_guildStronghold: {
            name: "Guild Stronghold",
            parentCategory: "Contract",
        },
        campaign_contract_gunshipCommander: {
            name: "Gunship Commander",
            parentCategory: "Contract",
        },
        campaign_contract_powerSupply: {
            name: "Power Supply",
            parentCategory: "Contract",
        },
        campaign_contract_quarantineZone: {
            name: "Quarantine Zone",
            parentCategory: "Contract",
        },
        campaign_contract_vtolTakedown: {
            name: "VTOL Takedown",
            parentCategory: "Contract",
        },
        campaign_objective_activity: {
            name: "Activity",
            parentCategory: "Objective",
        },
        campaign_objective_assignment: {
            iconUrl: "assignment",
            name: "Assignment",
            parentCategory: "Objective",
        },
        campaign_objective_camp: {
            name: "Camp",
            parentCategory: "Objective",
        },
        campaign_objective_cradleEvent: {
            name: "Cradle Event",
            parentCategory: "Objective",
        },
        campaign_objective_missionObjective: {
            iconUrl: "missionObjective",
            name: "Mission Objective",
            parentCategory: "Objective",
        },
        campaign_objective_storyMission: {
            iconUrl: "storyMission",
            name: "Story Mission",
            parentCategory: "Objective",
        },
        campaign_utility_ammoCache: {
            name: "Ammo Cache",
            parentCategory: "Utility",
        },
        campaign_utility_escape: {
            name: "Escape",
            parentCategory: "Utility",
        },
        campaign_utility_exfil: {
            name: "Exfil",
            parentCategory: "Utility",
        },
        campaign_utility_supplyDrop: {
            name: "Supply Drop",
            parentCategory: "Utility",
        },
        campaign_utility_supplyRun: {
            name: "Supply Run",
            parentCategory: "Utility",
        },
        campaign_utility_supplySite: {
            name: "Supply Site",
            parentCategory: "Utility",
        },
        campaign_vehicle_cargoTruck: {
            name: "Cargo Truck",
            parentCategory: "Vehicle",
        },
        campaign_vehicle_chopper: {
            name: "Chopper",
            parentCategory: "Vehicle",
        },
        campaign_vehicle_dirtBike: {
            name: "Dirt Bike",
            parentCategory: "Vehicle",
        },
        campaign_vehicle_ltv: {
            name: "LTV",
            parentCategory: "Vehicle",
        },
        campaign_vehicle_polarisRZR: {
            name: "Polaris RZR",
            parentCategory: "Vehicle",
        },
        campaign_vehicle_rhib: {
            name: "RHIB",
            parentCategory: "Vehicle",
        },

        // Multiplayer Categories
        multiplayer_mainSpawnLocation: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_MainSpawnLocations.svg",
            name: "Main Spawn Location",
        },
        multiplayer_objective_domination: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_Objective_Domination.svg",
            name: "Domination",
            parentCategory: "Objective",
        },
        multiplayer_objective_hardpoint: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_Objective_Hardpoint.svg",
            name: "Hardpoint",
            parentCategory: "Objective",
        },
        multiplayer_objective_searchAndDestroy: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Marker_Objective_SearchAndDestroy.svg",
            name: "Search and Destroy",
            parentCategory: "Objective",
        },

        // Warzone Categories
        warzone_ammoCache: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/AmmoCache.svg",
            name: "Ammo Cache",
        },
        warzone_buyStation: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/BuyStation.svg",
            name: "Buy Station",
        },
        warzone_contract_bigGameBounty: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/BigGameBounty.svg",
            name: "Big Game Bounty",
            parentCategory: "Contract",
        },
        warzone_contract_bounty: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Bounty.svg",
            name: "Bounty",
            parentCategory: "Contract",
        },
        warzone_contract_mostWanted: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/MostWanted.svg",
            name: "Most Wanted",
            parentCategory: "Contract",
        },
        warzone_contract_recon: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Recon.svg",
            name: "Recon",
            parentCategory: "Contract",
        },
        warzone_contract_scavenger: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Scavenger.svg",
            name: "Scavenger",
            parentCategory: "Contract",
        },
        warzone_contract_searchAndDestroy: {
            name: "Search and Destroy",
            parentCategory: "Contract",
        },
        warzone_contract_supplyRun: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/SupplyRun.svg",
            name: "Supply Run",
            parentCategory: "Contract",
        },
        warzone_train: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Train.svg",
            name: "Train",
        },
        warzone_vehicle_cargoTruck: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/CargoTruck.svg",
            name: "Cargo Truck",
            parentCategory: "Vehicle",
        },
        warzone_vehicle_helicopter: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Helicopter.svg",
            name: "Helicopter",
            parentCategory: "Vehicle",
        },
        warzone_vehicle_ltv: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ltv.svg",
            name: "LTV",
            parentCategory: "Vehicle",
        },
        warzone_vehicle_polarisRzrProR4: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/RZRPro.svg",
            name: "Polaris RZR Pro R4",
            parentCategory: "Vehicle",
        },
        warzone_vehicle_polarisSportsmanXp1000: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ATV.svg",
            name: "Polaris Sportsman XP1000",
            parentCategory: "Vehicle",
        },
        warzone_vehicle_triumph: {
        	iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Triumph.svg",
        	name: "Triumph",
        	parentCategory: "Vehicle",
        },

        // Zombies Categories
        zombies_ammo: {
            iconSvgKey: "icon-ammo",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Ammo.svg",
            name: "Ammo",
        },
        zombies_armorVests: {
            iconSvgKey: "icon-armor",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Armor.svg",
            name: "Armor Vests",
        },
        zombies_arsenals: {
            //iconSvgKey: "icon-arsenal",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_zm_arsenal.png",
            //iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Arsenal.svg",
            name: "Arsenals",
        },
        zombies_craftingTables: {
            iconSvgKey: "icon-crafting-table",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/CraftingTable.svg",
            name: "Crafting Tables",
        },
        zombies_doorBuys: {
            iconSvgKey: "icon-door-buy",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/DoorBuy.svg",
            name: "Door Buys",
        },
        zombies_exfil: {
            //iconSvgKey: "icon-exfil-radio",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_zm_exfil.png",
            //iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ExfilRadio.svg",
            name: "Exfil",
        },
        zombies_fastTravel: {
            iconSvgKey: "icon-fast-travel",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/FastTravel.svg",
            name: "Fast Travel",
        },
        zombies_gobbleGumMachines: {
            iconSvgKey: "icon-gobble-gum",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/GobbleGum.svg",
            name: "Gobble Gum Machines",
        },
        zombies_mysteryBoxes: {
            iconSvgKey: "icon-mystery-box",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/MysteryBox.svg",
            name: "Mystery Boxes",
        },
        zombies_packAPunch: {
            iconSvgKey: "icon-pack-a-punch",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/PackAPunch.svg",
            name: "Pack-A-Punch",
        },
        zombies_perk_deadshotDaiquiri: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_deadshot_lg.png",
            name: "Deadshot Daiquiri",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_deathPerception: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_deathperception_lg.png",
            name: "Death Perception",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_doubleTap: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_double_tap_lg.png",
            name: "Double Tap",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_elementalPop: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_elemental_pop_lg.png",
            name: "Elemental Pop",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_juggernog: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_juggernaut_lg.png",
            name: "Juggernog",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_meleeMacchiato: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_melee_macchiato_lg.png",
            name: "Melee Macchiato",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_muleKick: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_mulekick_lg.png",
            name: "Mule Kick",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_phdFlopper: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_phdslider_lg.png",
            name: "PhD Flopper",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_quickRevive: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_quickrevive_lg.png",
            name: "Quick Revive",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_speedCola: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_speedloader_lg.png",
            name: "Speed Cola",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_staminUp: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_zm_staminup_lg.png",
            name: "Stamin-Up",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_vultureAid: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_vulture_aid_lg.png",
            name: "Vulture Aid",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_perk_wispTea: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_perks_wisp_tea_lg.png",
            name: "Wisp Tea",
            parentCategory: "Perks",
            iconOffset: [5, 8],
        },
        zombies_powerDoors: {
            iconSvgKey: "icon-power-door",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/PowerDoor.svg",
            name: "Power Doors",
        },
        zombies_traps: {
            iconSvgKey: "icon-traps",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Traps.svg",
            name: "Traps",
        },
        zombies_wallBuys: {
            iconSvgKey: "icon-wall-buy",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/WallBuy.svg",
            name: "Wall Buys",
            iconOffset: [0, 0],
        },
        zombies_workBenches: {
            iconSvgKey: "icon-work-bench",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/WorkBench.svg",
            name: "Work Benches",
        },
        zombies_wunderfizzMachine: {
            iconSvgKey: "icon-wunderfizz",
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/Wunderfizz.svg",
            name: "Wunderfizz Machine",
        },

        // CODM
        codm_buyStation: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_general_buystation.png",
            name: "Buy Station",
        },
        codm_highValueItem: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_general_highvalueitems.png",
            name: "High Value Item",
        },
        codm_radiationZone: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_general_radiationzone.png",
            name: "Radiation Zone",
        },
        codm_uavTower: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_general_uavtower.png",
            name: "UAV Tower",
        },
        codm_contract_corporateRivalry: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_contracts_corporaterivalry.png",
            name: "Corporate Rivalry",
            parentCategory: "Contract",
        },
        codm_exfil_boat: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_boatextractionpoint.png",
            name: "Boat Exfil",
            parentCategory: "Exfils",
        },
        codm_exfil_general: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_generalextractionpoint.png",
            name: "General Exfil",
            parentCategory: "Exfils",
        },
        codm_exfil_helicopter: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_helicopterextractionpoint.png",
            name: "Helicopter Exfil",
            parentCategory: "Exfils",
        },
        codm_exfil_lever: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_leverextractionpoint.png",
            name: "Lever Exfil",
            parentCategory: "Exfils",
        },
        codm_exfil_payment: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_paymentextractionpoint.png",
            name: "Payment Exfil",
            parentCategory: "Exfils",
        },
        codm_exfil_train: {
            iconUrl: "https://www.callofduty.com/cdn/blog/guides/maps/assets/icons/ui_icon_codm_exfils_trainextractionpoint.png",
            name: "Train Exfil",
            parentCategory: "Exfils",
        },
    };

    //-- Order of categories for different map types
    const order = {
        zombies: [
            "zombies_packAPunch",
            "zombies_wallBuys",
            "zombies_ammo",
            "Perks",
            "zombies_wunderfizzMachine",
            "zombies_mysteryBoxes",
            "zombies_gobbleGumMachines",
            "zombies_armorVests",
            "zombies_arsenals",
            "zombies_craftingTables",
            "zombies_workBenches",
            "zombies_doorBuys",
            "zombies_powerDoors",
            "zombies_traps",
            "zombies_fastTravel",
            "zombies_exfil",
            "POI",
        ],
        multiplayer: ["multiplayer_mainSpawnLocation", "POI", "Objective"],
        warzone: [],
        campaign: [],
    };

    /**
     * Retrieves an array of category objects in the order specified for a given map type.
     *
     * @function getOrderedCategories
     * @memberof ATVI.components.mapguide.categories
     * @param {string} mapType - The key representing the map type (e.g., "zombies", "multiplayer", "warzone").
     * @returns {Array<Category>} An array of category objects in the specified order. Returns an empty array if no order is defined.
     */
    const getOrderedCategories = (mapType) => {
        const categoryKeys = order[mapType] || [];
        return categoryKeys;
        //return categoryKeys.map((key) => ATVI.components.mapguide.categories.getCategory(key));
    };

    return {
        /**
         * Get a category by its key.
         * @function
         * @memberof ATVI.components.mapguide.categories
         * @param {string} key - The unique key for the category.
         * @returns {Category|null} The category object or null if not found.
         */
        getCategory: (key) => categories[key] || null,

        /**
         * Get all categories as an array.
         * @function
         * @memberof ATVI.components.mapguide.categories
         * @returns {Array<Category>} Array of all category objects.
         */
        getAll: () => Object.values(categories),

        /**
         * Find a category by its display name.
         * @function
         * @memberof ATVI.components.mapguide.categories
         * @param {string} name - The display name of the category.
         * @returns {Category|null} The category object or null if not found.
         */
        getByName: (name) => Object.values(categories).find((cat) => cat.name === name) || null,

        /**
         * Get SVG markup for a category if iconSvgKey exists.
         * @param {string} key - Category key.
         * @returns {string|null} SVG string or null.
         */
        getCategoryIconSvg: (key) => {
            const icons = ATVI.components.mapguide.icons;
            const category = categories[key];
            if (category && category.iconSvgKey && icons[category.iconSvgKey]) {
                return icons[category.iconSvgKey];
            }
            return null;
        },

        /**
         * Sorts overlay categories and their nested overlays based on the order defined in the order array.
         *
         * @function sortOverlaysByMultiplayer
         * @param {Object} overlays - The overlays object where keys are category names and values are nested objects of markers.
         * @param {Array<string>} order - Array of category keys defining the desired order.
         * @param {Object} categories - The categories object for mapping keys to display names.
         * @returns {Object} A new overlays object sorted according to order, preserving nested structure.
         *
         * @example
         * const sorted = sortOverlaysByOrder(overlays, orderType, categories);
         */
        sortOverlaysByOrder: (overlays, orderType) => {
            let order = getOrderedCategories(orderType);
            // Map category keys to display names
            const keyToNameMap = Object.keys(categories).reduce((map, key) => {
                map[key] = categories[key].name;
                return map;
            }, {});

            // Track which overlay names have been added
            const added = new Set();

            // Sort top-level overlays based on order
            const sortedEntries = order
                .map((key) => {
                    const name = keyToNameMap[key] || key; // fallback to key if no mapping
                    if (overlays[name]) {
                        added.add(name);
                        return [name, overlays[name]];
                    }
                    return null;
                })
                .filter((entry) => entry !== null);

            // Append remaining overlays not in order
            Object.keys(overlays).forEach((name) => {
                if (!added.has(name)) {
                    sortedEntries.push([name, overlays[name]]);
                }
            });

            // Sort nested overlays alphabetically (or preserve original order)
            const sortedWithNested = sortedEntries.map(([name, nested]) => {
                const sortedNested = Object.keys(nested)
                    .sort((a, b) => a.localeCompare(b)) // alphabetical sort
                    .reduce((obj, nestedKey) => {
                        obj[nestedKey] = nested[nestedKey];
                        return obj;
                    }, {});
                return [name, sortedNested];
            });

            return Object.fromEntries(sortedWithNested);
            /*
            console.log(overlays, orderType);
            let order = getOrderedCategories(orderType);
            console.log(order);
            // Map category keys to display names
            // const keyToNameMap = Object.keys(categories).reduce((map, key) => {
            //     map[key] = categories[key].name;
            //     return map;
            // }, {});
            console.log("category keys: ", Object.keys(categories));

            // let mapObject = {};
            const keyToNameMap = Object.keys(categories).map((key) => {
                console.log("categories[key]", key, categories[key]);
                return categories[key].name;
                // mapObject[key] = categories[key].name;
                //return map;
            });
            // console.log("keyToNameMap", keyToNameMap);

            // Sort top-level overlays based on order
            const sortedTopLevel = order
                .map((key) => {
                    const name = keyToNameMap[key] || key; // fallback to key if no mapping
                    return overlays[name] ? [name, overlays[name]] : null;
                })
                .filter((entry) => entry !== null);

            // Sort nested overlays alphabetically (or keep original order)
            // const sortedWithNested = sortedTopLevel.map(([name, nested]) => {
            //     const sortedNested = Object.keys(nested)
            //         .sort((a, b) => a.localeCompare(b)) // alphabetical sort
            //         .reduce((obj, nestedKey) => {
            //             obj[nestedKey] = nested[nestedKey];
            //             return obj;
            //         }, {});
            //     return [name, sortedNested];
            // });

            return Object.fromEntries(sortedTopLevel);
            */
        },
    };
})();

// helpers.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

/**
 * MapGuide Helpers Module
 * Provides utility functions for ID generation, string formatting, overlay merging, and viewport checks.
 * @namespace ATVI.components.mapguide.helpers
 */
ATVI.components.mapguide.helpers = (() => {
    let idCounter = 0;

    const helpers = {
        /**
         * Generate a unique ID string with an optional prefix.
         * @function
         * @memberof ATVI.components.mapguide.helpers
         * @param {string} [prefix="id"] - Prefix for the generated ID.
         * @returns {string} A unique ID string (e.g., "id-1636589123456-0").
         * @example
         * const uniqueId = ATVI.components.mapguide.helpers.generateUniqueId("marker");
         * console.log(uniqueId); // "marker-1636589123456-0"
         */
        generateUniqueId: (prefix = "id") => {
            return `${prefix}-${Date.now()}-${idCounter++}`;
        },

        /**
         * Format a string into a valid HTML ID.
         * Converts to lowercase, removes invalid characters, replaces spaces with hyphens,
         * and ensures the ID starts with a letter.
         * @function
         * @memberof ATVI.components.mapguide.helpers
         * @param {string} str - The input string to format.
         * @returns {string} A formatted ID string.
         * @example
         * const id = ATVI.components.mapguide.helpers.formatToId(" My Custom ID! ");
         * console.log(id); // "my-custom-id"
         */
        formatToId: (str) => {
            return str
                .trim() // Remove leading/trailing spaces
                .toLowerCase() // Convert to lowercase
                .replace(/[^a-z0-9\s-_]/g, "") // Remove invalid characters
                .replace(/\s+/g, "-") // Replace spaces with hyphens
                .replace(/^-+/, "") // Remove leading hyphens
                .replace(/-+$/, "") // Remove trailing hyphens
                .replace(/^[^a-z]+/, "id-"); // Ensure starts with a letter
        },

        /**
         * Merge two overlay objects into one.
         * Each overlay is structured as:
         * {
         *   "CategoryName": {
         *     "SubCategoryName": [L.Marker, L.Marker, ...]
         *   }
         * }
         *
         * @function
         * @memberof ATVI.components.mapguide.helpers
         * @param {Overlay} overlayA - The first overlay object.
         * @param {Overlay} overlayB - The second overlay object.
         * @returns {Overlay} A merged overlay object containing all categories and subcategories.
         *
         * @example
         * const overlayA = {
         *   POI: {
         *     poiLabel: [{ id: "m1", name: "Marker 1", coordinates: { lat: 45, lng: -93 } }]
         *   }
         * };
         *
         * const overlayB = {
         *   Objective: {
         *     campaign_objective_storyMission: [{ id: "m2", name: "Story Mission", coordinates: { lat: 46, lng: -94 } }]
         *   }
         * };
         *
         * const merged = ATVI.components.mapguide.helpers.mergeOverlayObjects(overlayA, overlayB);
         * console.log(merged);
         * // {
         * //   POI: { poiLabel: [ { id: "m1", ... } ] },
         * //   Objective: { campaign_objective_storyMission: [ { id: "m2", ... } ] }
         * // }
         */

        mergeOverlayObjects: (overlayA, overlayB) => {
            const merged = {};

            // Helper to merge one overlay into the merged result
            function mergeInto(target, source) {
                Object.keys(source).forEach((category) => {
                    if (!target[category]) {
                        target[category] = {};
                    }

                    Object.keys(source[category]).forEach((subKey) => {
                        if (!target[category][subKey]) {
                            target[category][subKey] = [];
                        }

                        // Merge arrays
                        target[category][subKey] = target[category][subKey].concat(source[category][subKey]);
                    });
                });
            }

            mergeInto(merged, overlayA);
            mergeInto(merged, overlayB);

            return merged;
        },

        /**
         * Check if the current viewport is mobile or tablet landscape.
         * @function
         * @memberof ATVI.components.mapguide.helpers
         * @returns {boolean} True if mobile or tablet landscape view, false otherwise.
         * @example
         * if (ATVI.components.mapguide.helpers.isMobileView()) {
         *     console.log("Mobile view detected");
         * }
         */
        isMobileView: () => {
            const tabletLandscape = window.matchMedia("(max-width: 1024px) and (orientation: landscape)").matches;
            const mobile = window.matchMedia("(max-width: 768px)").matches;
            return mobile || tabletLandscape;
        },

        /**
         * Creates a DOM element with optional class, attributes, and text content.
         * @param {string} tag - The HTML tag name to create.
         * @param {string} className - Optional class name to assign.
         * @param {Object} attributes - Optional attributes as key-value pairs.
         * @param {string} textContent - Optional text content for the element.
         * @returns {HTMLElement} The created DOM element.
         */
        createElement: (tag, className, attributes = {}, textContent = "") => {
            const el = document.createElement(tag);
            if (className) el.className = className;
            Object.entries(attributes).forEach(([key, value]) => el.setAttribute(key, value));
            if (textContent) el.textContent = textContent;
            return el;
        },

        /**
         * Creates a label element containing an icon and a title.
         * @param {string} forId - The ID of the input element this label is for.
         * @param {string} iconClass - CSS class for the icon.
         * @param {string} iconHref - Href or source for the icon.
         * @param {string} titleText - Text content for the title.
         * @param {string} titleId - ID to assign to the title element.
         * @returns {HTMLElement} The constructed label element.
         */
        createLabelWithIconAndTitle: (forId, iconClass, iconHref, titleText, titleId) => {
            const label = helpers.createElement("label", "switch-label", { for: forId });
            const iconDiv = helpers.createIconDiv(iconClass, iconHref, titleText);
            const title = helpers.createElement("p", "category-title", { id: titleId }, titleText);
            label.appendChild(iconDiv);
            label.appendChild(title);
            return label;
        },

        /**
         * Creates a checkbox input element styled as a switch for UI toggling.
         *
         * @param {string} dataTarget - A unique identifier used to associate the switch with its label and data attributes.
         * @returns {HTMLInputElement} A configured checkbox input element with ARIA attributes and default checked state.
         */
        createSwitch: (dataTarget) => {
            const input = document.createElement("input");
            input.id = `${dataTarget}-switch`;
            input.type = "checkbox";
            input.role = "switch";
            input.checked = true;
            input.setAttribute("aria-checked", "true");
            input.setAttribute("data-target", dataTarget);
            input.setAttribute("aria-labelledby", `${dataTarget}-title`);

            return input;
        },

        /**
         * Creates a switch input element and attaches change event handlers.
         * @param {string} dataTarget - Data attribute target for the switch.
         * @param {Function[]} handlers - Array of event handler functions to attach.
         * @returns {HTMLElement} The switch input element with event listeners.
         */
        createSwitchWithHandlers: (dataTarget, handlers = []) => {
            const inputSwitch = helpers.createSwitch(dataTarget);
            handlers.forEach((handler) => inputSwitch.addEventListener("change", handler));
            return inputSwitch;
        },
        /**
         * Creates an expandable/collapsible button element for toggling subcategory visibility.
         *
         * @param {number} index - The index used to uniquely identify the button (not currently used but may support future enhancements).
         * @param {string} dataTarget - The ID of the element this button controls (used for accessibility).
         * @returns {HTMLButtonElement} The constructed button element with expand/collapse icons.
         */
        createExpandButton: (index, dataTarget) => {
            const button = document.createElement("button");
            button.className = "icon-btn expand-btn";
            button.setAttribute("aria-expanded", "false");
            button.setAttribute("aria-controls", dataTarget);
            button.setAttribute("aria-label", `Expand or collapse ${dataTarget} items`);

            ["expand-icon", "collapse-icon"].forEach((cls, i) => {
                const iconId = i === 0 ? "#icon-chevron-down" : "#icon-chevron-up";
                button.appendChild(helpers.createIconHref(cls, iconId));
            });

            return button;
        },
        /**
         * Creates an SVG element with a <use> reference to an icon.
         *
         * @param {string} className - The CSS class to apply to the SVG element.
         * @param {string} iconHref - The href value pointing to the icon definition (e.g., "#icon-name").
         * @returns {SVGElement} The constructed SVG element with the referenced icon.
         */
        createIconHref: (className, iconHref) => {
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.classList.add(className);

            const use = document.createElementNS("http://www.w3.org/2000/svg", "use");
            use.setAttribute("href", iconHref);

            svg.appendChild(use);
            return svg;
        },

        /**
         * Creates a <div> element containing either an SVG icon or an image icon.
         *
         * @param {string} className - The CSS class to apply to the container <div>.
         * @param {string} iconHref - The icon reference, either an SVG ID (e.g., "#icon-name") or an image URL.
         * @returns {HTMLDivElement} The constructed <div> element containing the icon.
         */
        createIconDiv: (className, iconHref, alt="") => {
            const div = document.createElement("div");
            div.className = className;

            if (!iconHref) {
                iconHref = "#icon-flag"; // default icon if none is provided
            }

            if (iconHref.startsWith("#") || iconHref.includes("#icon-")) {
                const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                svg.classList.add("icon");

                const use = document.createElementNS("http://www.w3.org/2000/svg", "use");
                use.setAttribute("href", iconHref);

                svg.appendChild(use);
                div.appendChild(svg);
            } else {
                const img = document.createElement("img");
                img.className = "icon";
                img.alt = alt;
                img.src = iconHref;
                div.appendChild(img);
            }

            return div;
        },
        /**
         * Creates a rich text component for the map marker drawer.
         * @param {Object} properties - Component properties including text, color, and text styling.
         * @returns {HTMLElement} The constructed rich text container element.
         */
        createMapRichTextComponent: (properties) => {
            const mapRichText = document.createElement("div");
            mapRichText.className = "map-rich-text";

            const cmpText = document.createElement("div");
            cmpText.className = "map-rich-text-component";
            cmpText.innerHTML = properties.text;

            if (properties.color) {
                cmpText.setAttribute("data-custom-accent-color", properties.color);
                const style = document.createElement("style");
                style.textContent = `
            .map-rich-text-component[data-custom-accent-color="${properties.color}"] {
                --custom-accent-color: ${properties.color};
            }
        `;
                cmpText.prepend(style);
            }

            if (properties.isBlackText === "true") {
                cmpText.classList.add("text-black");
            }

            mapRichText.appendChild(cmpText);
            return mapRichText;
        },
        /**
         * Creates an icon-text component for the map marker drawer.
         * @param {Object} properties - Component properties including image source, text, type, and styling.
         * @returns {HTMLElement} The constructed icon-text container element.
         */
        createMapIconTextComponent: (properties) => {
            const mapIconText = document.createElement("div");
            mapIconText.className = "map-icon-text";

            const component = document.createElement("div");
            component.className = "icon-text-component";
            component.setAttribute("data-type", properties.type);

            const img = document.createElement("img");
            img.className = "icon";
            img.src = properties.imgSrc;
            component.appendChild(img);

            if (properties.color) {
                component.setAttribute("data-custom-accent-color", properties.color);
                const style = document.createElement("style");
                style.textContent = `
            .icon-text-component[data-custom-accent-color="${properties.color}"] {
                --custom-accent-color: ${properties.color};
            }
        `;
                component.prepend(style);
            }

            const textContainer = document.createElement("div");
            textContainer.className = "map-rich-text-component text-container";
            textContainer.innerHTML = properties.text;

            if (properties.isBlackText === "true") {
                component.classList.add("text-black");
            }

            component.appendChild(textContainer);
            mapIconText.appendChild(component);
            return mapIconText;
        },
        /**
         * Builds the navigation controls for a media carousel.
         * @returns {HTMLElement} The constructed carousel navigation container.
         */
        buildCarouselNavigationElement: () => {
            const container = document.createElement("div");
            container.className = "carousel-navigation-container";

            const slideNav = document.createElement("div");
            slideNav.className = "slide-nav";
            container.appendChild(slideNav);

            const slideNumber = document.createElement("div");
            slideNumber.className = "slide-number";
            container.appendChild(slideNumber);

            const createArrowButton = (className, iconClass, text) => {
                const button = document.createElement("button");
                button.className = className;
                button.type = "button";

                const icon = document.createElement("span");
                icon.className = iconClass;
                icon.setAttribute("aria-hidden", "true");

                const label = document.createElement("span");
                label.className = "slick-sr-only";
                label.textContent = text;

                button.appendChild(icon);
                button.appendChild(label);
                return button;
            };

            container.appendChild(createArrowButton("custom-prev custom-arrow", "custom-prev-icon", "Previous"));
            container.appendChild(createArrowButton("custom-next custom-arrow", "custom-next-icon", "Next"));

            return container;
        },
        /**
         * Creates a media carousel component for map markers.
         * @param {Object} properties - Configuration object containing media items and optional image width.
         * @returns {HTMLElement|null} The constructed carousel component or null if no media items are found.
         */
        createMapMediaCarouselComponent: (properties) => {
            const { mediaItems, imgWidth } = properties;
            if (!mediaItems) return null;

            const sortedItemKeys = Object.keys(mediaItems)
                .filter((key) => key.startsWith("item"))
                .sort((a, b) => parseInt(a.replace("item", ""), 10) - parseInt(b.replace("item", ""), 10));

            if (sortedItemKeys.length === 0) return null;

            const uniqueId = helpers.generateUniqueId("map-media-carousel-component_");
            const component = helpers.createElement("div", `map-media-carousel-component ${uniqueId}`);
            const mediaCarousel = helpers.createElement("div", sortedItemKeys.length === 1 ? "media-item" : "media-carousel");

            if (sortedItemKeys.length === 1 && imgWidth && imgWidth !== "0") {
                const style = document.createElement("style");
                style.textContent = `.map-media-carousel-component.${uniqueId} { --max-img-width: ${imgWidth}px; }`;
                component.appendChild(style);
            }

            sortedItemKeys.forEach((key, index) => {
                const item = mediaItems[key];
                const slide = helpers.createElement("div", `slide-container align-${item.alignment || "left"}`);

                if (item.imgSrc && !item.mp4Video && !item.videoId) {
                    const img = helpers.createElement("img", "media-img");
                    if (index > 0) img.classList.add("hide");
                    img.src = item.imgSrc;
                    img.alt = item.altText;
                    slide.appendChild(img);
                } else if (item.mp4Video) {
                    const videoContainer = helpers.createElement("div", "media-video-container hide");
                    const video = helpers.createElement("video", "media-video", {
                        playsinline: "",
                        controls: "",
                        autoplay: item.autoplay,
                        muted: item.muted,
                        loop: item.loop,
                    });
                    const source = document.createElement("source");
                    source.src = item.mp4Video;
                    source.type = "video/mp4";
                    source.width = "1920px";
                    source.height = "1080px";
                    const fallbackText = helpers.createElement(
                        "p",
                        "",
                        {},
                        `Your browser doesn't support HTML video. Here is a <a href="\${source.src}">video</a> instead.`
                    );
                    video.appendChild(source);
                    video.appendChild(fallbackText);
                    videoContainer.appendChild(video);
                    slide.appendChild(videoContainer);
                }

                mediaCarousel.appendChild(slide);
            });

            component.appendChild(mediaCarousel);
            if (sortedItemKeys.length > 1) {
                const carouselNav = helpers.buildCarouselNavigationElement();
                component.appendChild(carouselNav);
            }

            const mapMediaCarousel = helpers.createElement("div", "map-media-carousel");
            mapMediaCarousel.appendChild(component);
            return mapMediaCarousel;
        },

        /**
         * Initializes slick carousels within a given container.
         * @param {HTMLElement} container - The DOM element containing carousel components.
         */
        initCarousel: (container) => {
            const $mediaCarouselCmp = $(container).find(".map-media-carousel-component");

            $mediaCarouselCmp.each(function (index, el) {
                const $cmp = $(el);
                const $carousel = $cmp.find(".media-carousel");

                let dataSliderIndex = $carousel.attr("data-map-grid-carousel-index");
                if (dataSliderIndex === undefined) {
                    $carousel.attr("data-map-grid-carousel-index", index);
                }

                if (dataSliderIndex && $carousel.hasClass("slick-initialized")) return;

                const settings = helpers.getCarouselSettings($cmp);
                $carousel.slick(settings);
                $carousel.find(".slick-slide .slide-container > .hide").removeClass("hide");
            });
        },

        /**
         * Retrieves slick carousel settings based on component configuration.
         * @param {jQuery} $cmp - jQuery object of the carousel component.
         * @returns {Object} Slick carousel configuration settings.
         */
        getCarouselSettings: ($cmp) => {
            const $carousel = $cmp.find(".media-carousel");
            const $pagination = $cmp.find(".carousel-navigation-container .slide-number");
            const $dots = $cmp.find(".carousel-navigation-container .slide-nav");
            const $next = $cmp.find(".carousel-navigation-container .custom-next");
            const $prev = $cmp.find(".carousel-navigation-container .custom-prev");
            const isRTL = ATVI.pageLocale === "ar";

            $carousel.on("init reInit afterChange", function (event, slick, currentSlide) {
                const i = (currentSlide || 0) + 1;
                $pagination.text(i + " of " + slick.slideCount);
            });

            $carousel.on("beforeChange", function (event, slick, currentSlide) {
                const currentVideo = $(slick.$slides[currentSlide]).find("video").get(0);
                if (currentVideo) currentVideo.pause();
            });

            $carousel.on("afterChange", function (event, slick, currentSlide) {
                const currentVideo = $(slick.$slides[currentSlide]).find("video").get(0);
                if (currentVideo) currentVideo.play();
            });

            return {
                dots: true,
                arrows: true,
                rtl: isRTL,
                appendDots: $dots,
                dotsClass: "custom-dots",
                prevArrow: $prev,
                nextArrow: $next,
                infinite: false,
            };
        },

        /**
         * Builds and populates the marker content panel with rich text, media carousel, and icon-text components.
         * @param {Object} data - Marker data containing id, name, iconUrl, coordinates, and content array.
         */
        buildMarkerContent: (data) => {
            const markerContent = helpers.isMobileView() ? document.getElementById("markerModal") : document.getElementById("markerContent");
            if (!markerContent) return;

            const markerIcon = markerContent.querySelector(".marker-icon");
            const markerTitle = markerContent.querySelector(".marker-content-header__title");
            const markerSubtitle = markerContent.querySelector(".marker-content-header__subtitle");
            const markerBody = markerContent.querySelector(".marker-content-body");
            const markerCopyBtn = markerContent.querySelector(".marker-content-header__actions .icon-marker-copy-btn");

            markerIcon.innerHTML = "";
            markerCopyBtn.setAttribute("data-marker-id", data.id);
            markerIcon.appendChild(helpers.createIconDiv("marker-icon", data.iconUrl));
            markerTitle.innerHTML = data.name;
            markerSubtitle.innerHTML = `x: ${data.props.x}, y: ${data.props.y}`;

            const existingCarousel = markerBody.querySelector(".media-carousel");
            if (existingCarousel) $(existingCarousel).slick("unslick");
            markerBody.innerHTML = "";

            if (Array.isArray(data.content)) {
                data.content.forEach((cmpProperties) => {
                    const type = cmpProperties["sling:resourceType"];
                    let component = null;

                    if (type === "atvi/callofduty/strategy-guide/components/maps/map-rich-text") {
                        component = helpers.createMapRichTextComponent(cmpProperties);
                    } else if (type === "atvi/callofduty/strategy-guide/components/maps/map-media-carousel") {
                        component = helpers.createMapMediaCarouselComponent(cmpProperties);
                        if (component) helpers.initCarousel(markerBody);
                    } else if (type === "atvi/callofduty/strategy-guide/components/maps/map-icon-text") {
                        component = helpers.createMapIconTextComponent(cmpProperties);
                    }

                    if (component instanceof HTMLElement) {
                        markerBody.appendChild(component);
                    }
                });
            } else {
                console.warn("No content found in marker data");
            }
        },
    };

    return helpers;
})();

/* Modified from https://cdn.rawgit.com/ardhi/Leaflet.MousePosition/master/src/L.Control.MousePosition.js */

(function () {
    function init(instance) {
        const L = instance.leaflet;

        L.Control.MousePosition = L.Control.extend({
            options: {
                position: "bottomright",
                separator: " ",
                emptyString: "",
                lngFirst: true,
                numDigits: 0,
                lngFormatter: function (lng) {
                    return "x:" + L.Util.formatNum(lng, 0);
                },
                latFormatter: function (lat) {
                    return "y:" + L.Util.formatNum(lat, 0);
                },
                prefix: "",
            },

            onAdd: function (map) {
                this._container = L.DomUtil.create("div", "leaflet-control-mouseposition");
                L.DomEvent.disableClickPropagation(this._container);
                map.on("mousemove", this._onMouseMove, this);
                this._container.innerHTML = this.options.emptyString;
                return this._container;
            },

            onRemove: function (map) {
                map.off("mousemove", this._onMouseMove);
            },

            _onMouseMove: function (e) {
                var lng = this.options.lngFormatter ? this.options.lngFormatter(e.latlng.lng) : L.Util.formatNum(e.latlng.lng, this.options.numDigits);
                var lat = this.options.latFormatter ? this.options.latFormatter(e.latlng.lat) : L.Util.formatNum(e.latlng.lat, this.options.numDigits);
                var value = this.options.lngFirst ? lng + this.options.separator + lat : lat + this.options.separator + lng;
                var prefixAndValue = this.options.prefix + " " + value;
                this._container.innerHTML = prefixAndValue;
            },
        });

        L.Map.mergeOptions({
            positionControl: false,
        });

        L.Map.addInitHook(function () {
            if (this.options.positionControl) {
                this.positionControl = new L.Control.MousePosition();
                this.addControl(this.positionControl);
            }
        });

        L.control.mousePosition = function (options) {
            return new L.Control.MousePosition(options);
        };
    }

    function onDocumentReady() {
        if (typeof window.onLeafletReady === "function") {
            window.onLeafletReady((instance) => {
                init(instance);
            });
        } else {
            console.error("Leaflet registry not found.");
        }
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})();

// modalManager.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

(function () {
    /**
     * @typedef {Object} ModalManagerOptions
     * @property {string} [modalSelector=".modal"] - CSS selector for all modals.
     * @property {string} [closeBtnSelector=".modal .close-btn"] - CSS selector for modal close buttons.
     * @property {function(HTMLElement):void} [onOpen] - Callback executed when a modal is opened.
     * @property {function(HTMLElement):void} [onClose] - Callback executed when a modal is closed.
     */

    /**
     * Class to manage multiple modals dynamically.
     * Handles open/close, focus trapping, and accessibility.
     * @class
     */
    class ModalManager {
        /**
         * @constructor
         * @param {ModalManagerOptions} [options={}] - Configuration options for the modal manager.
         */
        constructor(options = {}) {
            this.modalSelector = options.modalSelector || ".modal";
            this.closeBtnSelector = options.closeBtnSelector || ".modal .close-btn";
            this.onOpen = options.onOpen || null;
            this.onClose = options.onClose || null;
            this.focusableElementsSelector = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
            this.modals = document.querySelectorAll(this.modalSelector);
            this.closeBtns = document.querySelectorAll(this.closeBtnSelector);
            this.lastFocusedElement = null;

            this.initEvents();
        }

        /**
         * Open a modal by element or ID.
         * @param {HTMLElement|string} modal - Modal element or its ID.
         */
        openModal(modal) {
            const modalEl = typeof modal === "string" ? document.getElementById(modal) : modal;
            if (!modalEl) return;

            document.body.classList.add("has-dialog");
            modalEl.classList.add("show");
            modalEl.style.display = "flex";
            this.lastFocusedElement = document.activeElement;

            const focusable = modalEl.querySelector(".close-btn");
            if (focusable) focusable.focus();

            this.trapFocus(modalEl);

            if (typeof this.onOpen === "function") {
                this.onOpen(modalEl);
            }
        }

        /**
         * Close a modal by element or ID.
         * @param {HTMLElement|string} modal - Modal element or its ID.
         */
        closeModal(modal) {
            const modalEl = typeof modal === "string" ? document.getElementById(modal) : modal;
            if (!modalEl) return;

            modalEl.classList.remove("show");
            setTimeout(() => {
                modalEl.style.display = "none";
                if (this.lastFocusedElement) this.lastFocusedElement.focus();

                if (typeof this.onClose === "function") {
                    this.onClose(modalEl);
                }
            }, 300);

            modalEl.removeEventListener("keydown", this.trapFocus);
        }

        /**
         * Trap keyboard focus within the modal.
         * @param {HTMLElement} modal - The modal element.
         */
        trapFocus(modal) {
            const focusableElements = modal.querySelectorAll(this.focusableElementsSelector);
            const firstEl = focusableElements[0];
            const lastEl = focusableElements[focusableElements.length - 1];

            modal.addEventListener("keydown", (e) => {
                if (e.key === "Tab") {
                    if (e.shiftKey) {
                        if (document.activeElement === firstEl) {
                            e.preventDefault();
                            lastEl.focus();
                        }
                    } else {
                        if (document.activeElement === lastEl) {
                            e.preventDefault();
                            firstEl.focus();
                        }
                    }
                }
            });
        }

        /**
         * Handle clicks outside any modal to close it.
         * @param {MouseEvent} e - The click event.
         */
        handleOutsideClick(e) {
            this.modals.forEach((modal) => {
                if (e.target === modal) this.closeModal(modal);
            });
        }

        /**
         * Handle Escape key to close any open modal.
         * @param {KeyboardEvent} e - The keydown event.
         */
        handleEscapeKey(e) {
            if (e.key === "Escape") {
                this.modals.forEach((modal) => {
                    if (modal.style.display === "flex") this.closeModal(modal);
                });
            }
        }

        /**
         * Initialize event listeners for all modals.
         */
        initEvents() {
            this.closeBtns.forEach((btn) => {
                btn.addEventListener("click", () => {
                    const modal = btn.closest(".modal");
                    this.closeModal(modal);
                });
            });

            window.addEventListener("click", (e) => this.handleOutsideClick(e));
            window.addEventListener("keydown", (e) => this.handleEscapeKey(e));
        }
    }

    function onDocumentReady() {
        const modalManager = new ModalManager({
            modalSelector: ".modal",
            closeBtnSelector: ".modal .close-btn",
            onClose: (modal) => {
                // make any actions inactive with tabindex="-1"
                const actions = modal.querySelectorAll(".marker-content-header__actions button");
                actions.forEach((action) => {
                    action.setAttribute("tabindex", "-1");
                });
            }
        });

        ATVI.components.mapguide.ModalManager = modalManager;
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);

    /*
        Example usage:
        const modalManager = new ATVI.components.mapguide.ModalManager({
            modalSelector: ".modal",
            closeBtnSelector: ".modal .close-btn",
            onOpen: (modal) => console.log(`Modal opened: ${modal.id}`),
            onClose: (modal) => console.log(`Modal closed: ${modal.id}`)
        });

        // Open modal by ID
        modalManager.openModal("markerModal");

        // Close modal by element
        const mediaModal = document.getElementById("mediaModal");
        modalManager.closeModal(mediaModal);
	*/
})();

ATVI.components.mapguide = ATVI.components.mapguide || {};

(function (ATVI) {
    const mobileDrawer = (ATVI.components.mapguide.mobileDrawer = {});

    /**
     * Creates a panel manager to handle expand, collapse, and switch operations
     * for mobile drawer panels.
     *
     * @param {HTMLElement} container - The container element that wraps all panels.
     * @returns {Object} An object with methods: expand, collapse, switchPanels, updateHeight.
     */
    function createPanelManager(container) {
        let activePanel = null;

        /**
         * Calculates the available height for the panel based on viewport.
         * @returns {number} Available height in pixels.
         */
        const getAvailableHeight = () => window.innerHeight - 60 - 60 - 72;

        /**
         * Handles height transition for the container.
         *
         * @param {number} fromHeight - Starting height in pixels.
         * @param {number} toHeight - Target height in pixels.
         * @param {Function} [callback] - Optional callback after transition ends.
         */
        const setHeightTransition = (fromHeight, toHeight, callback) => {
            container.style.maxHeight = fromHeight + "px";
            void container.offsetHeight; // Trigger reflow
            container.style.maxHeight = toHeight + "px";

            container.addEventListener("transitionend", function cleanup() {
                container.style.maxHeight = "none";
                container.removeEventListener("transitionend", cleanup);
                if (callback) callback();
            });
        };

        return {
            /**
             * Expands a panel and adjusts container height.
             * @param {HTMLElement} panel - The panel to expand.
             */
            expand(panel) {
                if (!panel) return;
                activePanel = panel;
                panel.hidden = false;
                panel.classList.add("active");
                const newHeight = Math.min(panel.scrollHeight, getAvailableHeight());
                setHeightTransition(container.scrollHeight, newHeight);
            },

            /**
             * Collapses a panel and adjusts container height.
             * @param {HTMLElement} panel - The panel to collapse.
             */
            collapse(panel) {
                if (!panel) return;
                activePanel = null;
                setHeightTransition(container.scrollHeight, 0, () => {
                    panel.hidden = true;
                    panel.classList.remove("active");
                });
            },

            /**
             * Switches from one panel to another with height transition.
             * @param {HTMLElement} fromPanel - The currently active panel.
             * @param {HTMLElement} toPanel - The panel to activate.
             */
            switchPanels(fromPanel, toPanel) {
                if (!fromPanel || !toPanel) return;
                activePanel = toPanel;
                fromPanel.hidden = true;
                fromPanel.classList.remove("active");
                toPanel.hidden = false;
                toPanel.classList.add("active");
                const newHeight = Math.min(toPanel.scrollHeight, getAvailableHeight());
                setHeightTransition(container.scrollHeight, newHeight);
            },

            /**
             * Updates container height dynamically on resize.
             */
            updateHeight() {
                if (activePanel) {
                    const newHeight = Math.min(activePanel.scrollHeight, getAvailableHeight());
                    container.style.maxHeight = newHeight + "px";
                }
            },

            /**
             * Returns the currently active panel.
             * @returns {HTMLElement|null} Active panel or null.
             */
            getActivePanel() {
                return activePanel;
            },
        };
    }

    /**
     * Initializes the mobile drawer functionality:
     * - Sets up tab click and keyboard navigation.
     * - Handles panel expand/collapse/switch.
     */
    function initMobileDrawer() {
        const panelsContainer = document.querySelector(".panels-container");
        const tabs = document.querySelectorAll('.mobile-drawer .bottom-bar [role="tab"]');
        const panelManager = createPanelManager(panelsContainer);

        /**
         * Activates a tab and its associated panel.
         * @param {HTMLElement} tab - The tab element to activate.
         */
        const activateTab = (tab) => {
            const panel = document.getElementById(tab.getAttribute("aria-controls"));
            const activeTab = document.querySelector('.mobile-drawer .bottom-bar [role="tab"][aria-selected="true"]');

            if (tab.getAttribute("aria-selected") === "true") {
                panelManager.collapse(panel);
                tab.setAttribute("aria-selected", "false");
                return;
            }

            if (!activeTab) {
                tab.setAttribute("aria-selected", "true");
                panelManager.expand(panel);
            } else {
                const fromPanel = document.getElementById(activeTab.getAttribute("aria-controls"));
                panelManager.switchPanels(fromPanel, panel);
                activeTab.setAttribute("aria-selected", "false");
                tab.setAttribute("aria-selected", "true");
            }

            panel.focus();
        };

        tabs.forEach((tab, index) => {
            tab.addEventListener("click", () => activateTab(tab));
            tab.addEventListener("keydown", (e) => handleTabNavigation(e, index, tabs));
        });

        // Debounced resize handling
        let resizeTimeout;
        window.addEventListener("resize", () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                panelManager.updateHeight();
            }, 150);
        });

        // Click outside to collapse
        document.addEventListener("click", (e) => {
            const drawer = document.querySelector(".mobile-drawer");
            const activePanel = panelManager.getActivePanel();
            if (activePanel && !drawer.contains(e.target)) {
                const activeTab = document.querySelector('.mobile-drawer .bottom-bar [role="tab"][aria-selected="true"]');
                if (activeTab) activeTab.setAttribute("aria-selected", "false");
                panelManager.collapse(activePanel);
            }
        });

        mobileDrawer.activateTab = activateTab;
    }

    /**
     * Handles keyboard navigation for tabs (Arrow keys, Home, End).
     *
     * @param {KeyboardEvent} e - The keyboard event.
     * @param {number} index - Current tab index.
     * @param {NodeList} tabs - List of all tab elements.
     */
    function handleTabNavigation(e, index, tabs) {
        let newIndex;
        switch (e.key) {
            case "ArrowLeft":
                newIndex = (index - 1 + tabs.length) % tabs.length;
                break;
            case "ArrowRight":
                newIndex = (index + 1) % tabs.length;
                break;
            case "Home":
                newIndex = 0;
                break;
            case "End":
                newIndex = tabs.length - 1;
                break;
            default:
                return;
        }
        tabs[newIndex].focus();
        e.preventDefault();
    }

    /**
     * Document ready handler.
     *
     */
    function onDocumentReady() {
        initMobileDrawer();
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})(ATVI);

// menuHandlers.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

(function () {
    // Cache DOM elements
    const mapOverlay = document.querySelector(".map-overlay");
    const mapOverlayMenu = document.querySelector(".map-overlay__menu");
    const readerDrawerExpandBtn = document.getElementById("readerDrawerExpandBtn");
    const drawer = document.getElementById("drawerContent");
    const markerContent = document.getElementById("markerContent");
    const showGuideBtn = document.getElementById("showGuideBtn");
    const showMarkerBtn = document.getElementById("showMarkerBtn");
    const markerMenuExpandBtn = document.getElementById("markerMenuExpandBtn");
    const markerMenu = document.getElementById("markerMenu");
    const showAllMarkersAndLayersBtn = document.getElementById("showAllMarkersAndLayersBtn");
    const hideAllMarkersAndLayersBtn = document.getElementById("hideAllMarkersAndLayersBtn");
    const showAllMarkersBtn = document.getElementById("showAllMarkersBtn");
    const hideAllMarkersBtn = document.getElementById("hideAllMarkersBtn");
    const showAllLayersBtn = document.getElementById("showAllLayersBtn");
    const hideAllLayersBtn = document.getElementById("hideAllLayersBtn");

    if (!mapOverlay) return;

    /**
     * Sets multiple attributes on an element.
     * @param {HTMLElement} el - The target element.
     * @param {Object<string,string>} attrs - Key-value pairs of attributes.
     */
    const setAttributes = (el, attrs) => {
        Object.entries(attrs).forEach(([key, value]) => el.setAttribute(key, value));
    };

    /**
     * Adds and removes classes from an element.
     * @param {HTMLElement} el - The target element.
     * @param {string[]} addClasses - Classes to add.
     * @param {string[]} removeClasses - Classes to remove.
     */
    const toggleClasses = (el, addClasses = [], removeClasses = []) => {
        addClasses.forEach((cls) => el.classList.add(cls));
        removeClasses.forEach((cls) => el.classList.remove(cls));
    };

    /**
     * Wraps a function in a click event handler that prevents default behavior.
     * @param {Function} fn - The function to execute on click.
     * @returns {(event: Event) => void} Event handler function.
     */
    const handleClick = (fn) => (event) => {
        event.preventDefault();
        fn();
    };

    /**
     * Creates a menu handler instance for managing map menu interactions.
     * @returns {Object} Menu handler instance with all menu methods.
     */
    function createMenuHandlers() {
        // Store marker settings keyed by parent ID
        const markerSettingsStore = {};

        function init() {
            initReaderDrawer();
            initMarkerMenu();
        }

        // --- Layer Visibility ---

        /**
         * Retrieves the layer group for a given category label.
         * @param {string} categoryLabel - The category label of the map layer.
         * @returns {Object|null} The layer group object or null if not found.
         */
        // const getLayerGroup = (categoryLabel) => {
        //     return MAP_MANAGER.getOverlay(categoryLabel);
        // };

        /**
         * Adds or removes a layer group from the map.
         * @param {string} categoryLabel - The category label of the map layer.
         * @param {boolean} shouldShow - Whether to show (true) or hide (false) the layer.
         * @returns {void}
         */
        const toggleCategoryLayer = (categoryLabel, shouldShow) => {
            const { MapManager: MAP_MANAGER } = ATVI.components.mapguide;
            const layerGroup = MAP_MANAGER.getOverlay(categoryLabel);
            if (!layerGroup) {
                // console.warn(`Layer group for category "${categoryLabel}" not found.`);
                return;
            }

            const map = MAP_MANAGER.getMap();
            if (!map) {
                // console.warn("Map instance not found.");
                return;
            }

            shouldShow ? map.addLayer(layerGroup) : map.removeLayer(layerGroup);
        };

        /**
         * Shows the category layer associated with the given category label.
         * @param {string} categoryLabel - The category label of the map layer to show.
         * @returns {void}
         */
        const showCategoryLayer = (categoryLabel) => toggleCategoryLayer(categoryLabel, true);

        /**
         * Hides the category layer associated with the given category label.
         * @param {string} categoryLabel - The category label of the map layer to hide.
         * @returns {void}
         */
        const hideCategoryLayer = (categoryLabel) => toggleCategoryLayer(categoryLabel, false);

        // --- Switches ---
        /**
         * Toggles a category or subcategory switch and updates its UI state.
         * @param {HTMLElement} listItem - The category-item or subcategory-item element.
         * @param {boolean} isOn - Whether to turn the switch on (true) or off (false).
         * @returns {void}
         */
        const toggleSwitch = (listItem, isOn) => {
            if (!listItem) return;

            const switchElement = listItem.querySelector("input[type='checkbox']");
            if (!switchElement) return;

            switchElement.checked = isOn;
            switchElement.setAttribute("aria-checked", String(isOn));
            listItem.classList.toggle("active", isOn);

            const layerName = listItem.getAttribute("data-layer-name") || listItem.querySelector(".category-title").innerText;
            isOn ? showCategoryLayer(layerName) : hideCategoryLayer(layerName);
        };

        /**
         * Turns the switch on for the given list item.
         * @param {HTMLElement} listItem - The category-item or subcategory-item element.
         * @returns {void}
         */
        const turnSwitchOn = (listItem) => toggleSwitch(listItem, true);

        /**
         * Turns the switch off for the given list item.
         * @param {HTMLElement} listItem - The category-item or subcategory-item element.
         * @returns {void}
         */
        const turnSwitchOff = (listItem) => toggleSwitch(listItem, false);

        // --- Expand/Collapse ---

        /**
         * Toggles the expansion state of a category item's sublist.
         * @param {HTMLElement} categoryItem - The category item containing the sublist.
         * @param {boolean} expand - Whether to expand (true) or collapse (false) the sublist.
         * @returns {void}
         */
        const toggleCategoryList = (categoryItem, expand) => {
            if (!categoryItem) return;

            const sublist = categoryItem.querySelector(".subcategory-list");
            const expandButton = categoryItem.querySelector(".expand-btn");

            if (!sublist || !expandButton) return;

            if (expand) {
                sublist.hidden = false;
                sublist.style.maxHeight = `${sublist.scrollHeight}px`;
                expandButton.setAttribute("aria-expanded", "true");
            } else {
                sublist.style.maxHeight = null;
                setTimeout(() => {
                    expandButton.setAttribute("aria-expanded", "false");
                    sublist.hidden = true;
                }, 200); // Match CSS transition duration
            }
        };

        /**
         * Handles the click event for expand/collapse buttons.
         * @param {Event} event - The click event.
         * @returns {void}
         */
        const handleExpandButtonClick = (event) => {
            const button = event.currentTarget;
            const categoryItem = button.closest(".category-item");
            const isExpanded = button.getAttribute("aria-expanded") === "true";

            toggleCategoryList(categoryItem, !isExpanded);
        };

        // --- Category/Subcategory Toggles ---
        /**
         * Toggle a category item and its paired mobile/desktop item.
         * @param {HTMLElement} categoryItem
         * @param {boolean} turnOn
         */
        function toggleCategoryItem(categoryItem, turnOn) {
            if (!categoryItem) return;
            const targetId = categoryItem.querySelector("input[type='checkbox']").getAttribute("data-target");
            const target2Id = targetId.endsWith("-mobile") ? targetId.replace("-mobile", "") : `${targetId}-mobile`;
            const category2Toggle = document.querySelector(`input[data-target="${target2Id}"]`);
            const isLayerItem = targetId.startsWith("subcat-layer-") || targetId.startsWith("layer-");
            const category2Item = isLayerItem ? category2Toggle?.closest(".subcategory-item") : category2Toggle?.closest(".category-item");
            if (turnOn) {
                turnSwitchOn(categoryItem);
                turnSwitchOn(category2Item);
            } else {
                turnSwitchOff(categoryItem);
                turnSwitchOff(category2Item);
            }
        }

        /**
         * Toggle a subcategory item and its paired mobile/desktop item.
         * @param {HTMLElement} subcategoryItem
         * @param {boolean} turnOn
         */
        function toggleSubcategoryItem(subcategoryItem, turnOn) {
            if (!subcategoryItem) return;
            const targetId = subcategoryItem.querySelector("input[type='checkbox']").getAttribute("data-target");
            const target2Id = targetId.endsWith("-mobile") ? targetId.replace("-mobile", "") : `${targetId}-mobile`;

            const subcategory2Toggle = document.querySelector(`input[data-target="${target2Id}"]`);
            const isLayerItem = targetId.startsWith("subcat-layer-") || targetId.startsWith("layer-");
            const subcategory2Item = isLayerItem ? subcategory2Toggle?.closest(".category-item") : subcategory2Toggle?.closest(".subcategory-item");

            if (turnOn) {
                turnSwitchOn(subcategoryItem);
                turnSwitchOn(subcategory2Item);
            } else {
                turnSwitchOff(subcategoryItem);
                turnSwitchOff(subcategory2Item);
            }
        }

        // --- Enable/Disable Category ---
        /**
         * Updates UI for a category or subcategory item.
         * @param {HTMLElement} categoryItem - The parent category item.
         * @param {HTMLElement} subItem - The subcategory item (or category itself for mobile).
         * @param {HTMLInputElement} input - The checkbox input element.
         * @param {boolean} isDisabled - Whether to disable the input.
         * @param {boolean} isChecked - Whether the input should be checked.
         */
        const updateUI = (categoryItem, subItem, input, isDisabled, isChecked) => {
            input.disabled = isDisabled;
            input.checked = isChecked;
            subItem.classList.toggle("disabled", isDisabled);

            const layerName = subItem.getAttribute("data-layer-name") || subItem.querySelector(".category-title").innerText;
            if (isDisabled) {
                hideCategoryLayer(layerName);
                turnSwitchOff(categoryItem);
            } else if (isChecked) {
                showCategoryLayer(layerName);
            }
        };

        /**
         * Retrieves sublist items for a given category ID.
         * @param {string} categoryId - The category ID.
         * @returns {NodeListOf<Element>} List of subcategory items.
         */
        const getSublistItems = (categoryId) => {
            const sublist = document.getElementById(categoryId);
            return sublist ? sublist.querySelectorAll(".subcategory-item") : [];
        };

        /**
         * Save sublist settings and disable them when parent closes.
         * @param {HTMLElement} categoryItem - Parent category item.
         */
        const disableCategory = (categoryItem) => {
            if (!categoryItem) return;

            const categoryId = categoryItem.querySelector(".category-row input[type='checkbox']").getAttribute("data-target");
            const category2Id = categoryId.endsWith("-mobile") ? categoryId.replace("-mobile", "") : `${categoryId}-mobile`;

            const sublistItems = getSublistItems(categoryId);
            const sublistItems2 = getSublistItems(category2Id);

            const settings = [];

            sublistItems.forEach((item) => {
                const input = item.querySelector("input[type='checkbox']");
                settings.push({
                    id: input.getAttribute("data-target"),
                    checked: input.checked,
                    disabled: true,
                });
                updateUI(categoryItem, item, input, true, input.checked);
            });

            sublistItems2.forEach((item2) => {
                const input2 = item2.querySelector("input[type='checkbox']");
                const category2Item = item2.closest(".category-item");
                updateUI(category2Item, item2, input2, true, input2.checked);
            });

            markerSettingsStore[categoryId] = settings;
        };

        /**
         * Load saved sublist settings and enable them when parent opens.
         * @param {HTMLElement} categoryItem - Category parent item.
         */
        const enableCategory = (categoryItem) => {
            if (!categoryItem) return;

            const categoryId = categoryItem.querySelector("input[type='checkbox']").getAttribute("data-target");
            const category2Id = categoryId.endsWith("-mobile") ? categoryId.replace("-mobile", "") : `${categoryId}-mobile`;
            const savedSettings = markerSettingsStore[categoryId] || markerSettingsStore[category2Id];

            if (savedSettings) {
                savedSettings.forEach((saved) => {
                    const input = document.querySelector(`input[data-target="${saved.id}"]`);
                    const item = input.closest(".subcategory-item");
                    updateUI(categoryItem, item || categoryItem, input, false, saved.checked);

                    const saved2Id = saved.id.endsWith("-mobile") ? saved.id.replace("-mobile", "") : `${saved.id}-mobile`;
                    const input2 = document.querySelector(`input[data-target="${saved2Id}"]`);
                    if (input2) {
                        const category2Item = input2.closest(".category-item");
                        const subItem2 = input2.closest(".subcategory-item");
                        updateUI(category2Item, subItem2 || category2Item, input2, false, saved.checked);
                    }
                });

                delete markerSettingsStore[categoryId];
            }

            turnSwitchOn(categoryItem);
        };

        // --- Bulk Actions ---

        /**
         * Toggles all items (categories and subcategories) within a given selector.
         * @param {string} selector - CSS selector for category checkboxes.
         * @param {boolean} isOn - Whether to turn switches on (true) or off (false).
         * @returns {void}
         */
        const toggleAllItems = (selector, isOn) => {
            document.querySelectorAll(selector).forEach((categoryToggle) => {
                const categoryItem = categoryToggle.closest(".category-item");
                isOn ? turnSwitchOn(categoryItem) : turnSwitchOff(categoryItem);

                const targetId = categoryToggle.getAttribute("data-target");
                const sublist = document.getElementById(targetId);

                if (sublist) {
                    sublist.querySelectorAll(".subcategory-item").forEach((item) => {
                        const input = item.querySelector("input[type='checkbox']");
                        const categoryId = input.getAttribute("data-target");

                        input.checked = isOn;
                        input.disabled = false;
                        item.classList.remove("disabled");
                        delete markerSettingsStore[categoryId];

                        isOn ? turnSwitchOn(item) : turnSwitchOff(item);
                    });
                }
            });
        };

        /**
         * Show all layers by toggling their switches on.
         */
        function showAllLayers() {
            toggleAllItems(".map-menu__marker-menu .layer-list .category-row > input[type='checkbox']", true);
        }

        /**
         * Hide all layers by toggling their switches off.
         */
        function hideAllLayers() {
            toggleAllItems(".map-menu__marker-menu .layer-list .category-row > input[type='checkbox']", false);
        }

        /**
         * Show all markers by toggling their switches on.
         */
        function showAllMarkers() {
            toggleAllItems(".map-menu__marker-menu .category-list .category-row > input[type='checkbox']", true);
        }

        /**
         * Hide all markers by toggling their switches off.
         */
        function hideAllMarkers() {
            toggleAllItems(".map-menu__marker-menu .category-list .category-row > input[type='checkbox']", false);
        }

        // --- Drawer ---
        /**
         * Open the reader drawer.
         */
        const openDrawer = () => {
            toggleClasses(mapOverlay, ["drawer-open"], ["drawer-collapsed"]);
            mapOverlayMenu.classList.add("drawer-open");
            setAttributes(readerDrawerExpandBtn, { "aria-expanded": "true" });
            setAttributes(drawer, { "aria-hidden": "false" });
            readerDrawerExpandBtn.focus();
        };

        /**
         * Close the reader drawer.
         */
        const closeDrawer = () => {
            toggleClasses(mapOverlay, ["drawer-collapsed"], ["drawer-open"]);
            mapOverlayMenu.classList.remove("drawer-open");
            setAttributes(readerDrawerExpandBtn, { "aria-expanded": "false" });
            setAttributes(drawer, { "aria-hidden": "true" });
            toggleMarkerActions(true);
            readerDrawerExpandBtn.focus();
        };

        /**
         * Displays guide content and hides marker content.
         */
        const showGuideContent = () => {
            toggleClasses(mapOverlay, ["guide-open"], ["marker-open"]);
            setAttributes(showGuideBtn, { "aria-expanded": "true" });
            setAttributes(showMarkerBtn, { "aria-expanded": "false" });
            toggleMarkerActions(true);
        };

        /**
         * Displays marker content and hides guide content.
         */
        const showMarkerContent = () => {
            toggleClasses(mapOverlay, ["marker-open"], ["guide-open"]);
            setAttributes(showGuideBtn, { "aria-expanded": "false" });
            setAttributes(showMarkerBtn, { "aria-expanded": "true" });
            toggleMarkerActions(false);
        };

        /**
         * Enable or disable marker action buttons for accessiblity when markerContent is shown/hidden
         * @param isDisabled - Boolean indicating whether to disable (true) or enable (false) marker action buttons.
         */
        const toggleMarkerActions = (isDisabled) => {
            markerContent.querySelectorAll("button").forEach((btn) => {
                btn.setAttribute("tabindex", isDisabled ? "-1" : "0");
            });
            // document.querySelectorAll("#markerContent .marker-content-header__actions button").forEach((btn) => {
            //     btn.disabled = isDisabled;
            //     btn.setAttribute("tabindex", isDisabled ? "-1" : "0");
            // });
        };

        // --- Marker Menu ---
        /**
         * Open the marker menu.
         */
        const openMarkerMenu = () => {
            mapOverlay.classList.remove("marker-collapsed");
            setAttributes(markerMenuExpandBtn, { "aria-expanded": "true" });
            setAttributes(markerMenu, { "aria-hidden": "false" });
            markerMenuExpandBtn.focus();
        };

        /**
         * Close the marker menu.
         */
        const closeMarkerMenu = () => {
            mapOverlay.classList.add("marker-collapsed");
            setAttributes(markerMenuExpandBtn, { "aria-expanded": "false" });
            setAttributes(markerMenu, { "aria-hidden": "true" });
            document.querySelectorAll(".map-menu__marker-menu .category-item").forEach((categoryItem) => toggleCategoryList(categoryItem, false));
            markerMenuExpandBtn.focus();
        };

        /**
         * Handle marker menu toggle.
         * @param {Event} event
         */
        const handleMarkerMenuToggle = handleClick(() => {
            const isExpanded = markerMenuExpandBtn.getAttribute("aria-expanded") === "true";
            isExpanded ? closeMarkerMenu() : openMarkerMenu();
        });

        /**
         * Copies a marker-specific link to the clipboard and displays a tooltip notification.
         * @async
         * @param {Event} event - The click event triggered by the copy button.
         * @returns {Promise<void>} Resolves when the copy operation completes.
         * @description
         * This function:
         *  Builds a URL with the marker ID as a query parameter.
         *  Attempts to copy the URL to the clipboard.
         *  Displays success or failure feedback in the tooltip.
         */
        async function copyMarkerLink(event) {
            event.preventDefault();

            const button = event.currentTarget;
            let tooltip = button.querySelector(".tooltip");

            // Create tooltip if it doesn't exist
            if (!tooltip) {
                tooltip = document.createElement("span");
                tooltip.className = "tooltip";
                tooltip.textContent = "Link copied.";
                button.appendChild(tooltip);
            }

            const markerId = button.getAttribute("data-marker-id");
            const baseUrl = window.location.href.split(/[?#]/)[0]; // Remove query params and hash
            const textToCopy = `${baseUrl}?markerId=${markerId}`;

            try {
                await navigator.clipboard.writeText(textToCopy);
                tooltip.textContent = "Link copied.";
            } catch (err) {
                tooltip.textContent = "Failed to copy link.";
            }

            // Show tooltip briefly
            tooltip.classList.add("show");
            setTimeout(() => tooltip.classList.remove("show"), 1500);
        }

        /**
         * Handles analytics for toggle switches.
         * @param {Event} event
         */
        function handleChangeToggleSwitchAnalytics(event) {
            if (!digitalData || !dataLayer) return;
            const switchedOn = event.target.checked;
            const pageName = digitalData.page.pageInfo.pageName;
            const ariaLabelledBy = event.target.getAttribute("aria-labelledby");
            const layerName = document.getElementById(ariaLabelledBy).textContent.trim().toLowerCase();

            dataLayer.push({
                action: `maps:${layerName}`,
                category: `interaction:${pageName}`,
                event: "interaction",
                label: switchedOn ? "reveal" : "hide",
                link_text: layerName,
                link_url: "internal link",
                module: "map",
            });
        }

        /**
         * Handles toggle switch changes for categories and subcategories.
         * @param {Event} event
         */
        function handleChangeToggleSwitch(event) {
            const switchedOn = event.target.checked;
            const inputElement = event.target;
            const subcategoryItem = inputElement.closest(".subcategory-item");
            const categoryItem = inputElement.closest(".category-item");

            if (subcategoryItem) {
                toggleSubcategoryItem(subcategoryItem, switchedOn);
                return;
            }

            if (categoryItem) {
                const sublist = categoryItem.querySelector(".subcategory-list");
                if (sublist) {
                    switchedOn ? enableCategory(categoryItem) : disableCategory(categoryItem);
                } else {
                    toggleCategoryItem(categoryItem, switchedOn);
                }
            }
        }

        // --- Initialization ---
        /**
         * Initializes reader drawer functionality.
         */
        const initReaderDrawer = () => {
            readerDrawerExpandBtn.addEventListener(
                "click",
                handleClick(() => {
                    const isExpanded = readerDrawerExpandBtn.getAttribute("aria-expanded") === "true";
                    isExpanded ? closeDrawer() : openDrawer();
                })
            );

            showGuideBtn.addEventListener("click", handleClick(showGuideContent));
            showMarkerBtn.addEventListener("click", handleClick(showMarkerContent));

            document.addEventListener("keydown", (e) => {
                if (e.key === "Escape" && !mapOverlay.classList.contains("drawer-collapsed")) {
                    closeDrawer();
                }
            });
        };
        /**
         * Initializes marker menu functionality.
         */
        const initMarkerMenu = () => {
            markerMenuExpandBtn.addEventListener("click", handleMarkerMenuToggle);

            // Attach other event listeners (copy link, show/hide markers/layers, etc.)
            document.querySelectorAll(".marker-content-header__actions .icon-marker-copy-btn").forEach((btn) => btn.addEventListener("click", copyMarkerLink));

            document.querySelectorAll(".map-menu__marker-menu .expand-btn").forEach((btn) => btn.addEventListener("click", handleExpandButtonClick));

            showAllMarkersAndLayersBtn?.addEventListener("click", () => {
                showAllMarkers();
                showAllLayers();
            });

            hideAllMarkersAndLayersBtn?.addEventListener("click", () => {
                hideAllMarkers();
                hideAllLayers();
            });

            showAllMarkersBtn?.addEventListener("click", () => {
                showAllMarkers();
            });

            hideAllMarkersBtn?.addEventListener("click", () => {
                hideAllMarkers();
            });

            showAllLayersBtn?.addEventListener("click", () => {
                showAllLayers();
            });

            hideAllLayersBtn?.addEventListener("click", () => {
                hideAllLayers();
            });

            document.querySelectorAll(".map-menu__marker-menu input[type='checkbox']").forEach((input) => {
                input.addEventListener("change", handleChangeToggleSwitchAnalytics);
                input.addEventListener("change", handleChangeToggleSwitch);
            });
        };

        return {
            init,
            handleExpandButtonClick,
            openDrawer,
            showMarkerContent,
            handleChangeToggleSwitchAnalytics,
            handleChangeToggleSwitch,
        };
    }

    function onDocumentReady() {
        let menuHandlers = createMenuHandlers();
        menuHandlers.init();
        ATVI.components.mapguide.menuHandlers = menuHandlers;
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})();

// mapManager.js
// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};

(function () {
    /**
     * @typedef {Object} MapOptions
     * @property {string} mapId - ID of the map container element.
     * @property {string} [layerListSelector=".layer-list ul.subcategory-list li"] - Selector for layer list items.
     */
    function createMapManager(options) {
        const mapId = options.mapId || "map";
        const layerListSelector = options.layerListSelector || ".layer-list ul.subcategory-list li";
        const layerGroups = {};
        const helpers = {};
        let map = null;

        function init() {
            if (typeof window.onLeafletReady === "function") {
                window.onLeafletReady((instance) => {
                    loadMap(instance);
                });
            } else {
                console.error("Leaflet registry not found.");
            }
        }

        function getMap() {
            return map;
        }

        function getOverlays() {
            return layerGroups;
        }

        function getOverlay(label) {
            if (!label) return null;
            return layerGroups[label] || null;
        }

        function getDrawerOffset() {
            const drawer = document.getElementById("drawerContent");
            const overlayWidth = drawer ? drawer.offsetWidth : 0;
            return overlayWidth ? [overlayWidth / 2, 0] : [0, 0];
        }

        function panToOffset(latlng, offset) {
            const map = getMap();

            if (!map || !latlng) return;

            const effectiveOffset = offset || getDrawerOffset();
            const targetPoint = map.project(latlng).subtract(effectiveOffset);
            const targetLatLng = map.unproject(targetPoint);
            map.panTo(targetLatLng);
        }

        function addLayers(L, bounds, useMapTiles) {
            const map = getMap();
            const layerList = document.querySelectorAll(layerListSelector);
            layerList.forEach((layerItem) => {
                const layerName = layerItem.getAttribute("data-layer-name");
                const layerUrl = layerItem.getAttribute("data-layer-url");
                if (!layerUrl) return;

                const layer = useMapTiles ? L.tileLayer(layerUrl) : L.imageOverlay(layerUrl, bounds);
                layerGroups[layerName] = layer;
                layer.addTo(map);
            });
        }

        /**
         * Generate grid labels overlay.
         * @param {Object} L - Leaflet instance.
         * @param {number} rows - Number of grid rows.
         * @param {number} cols - Number of grid columns.
         * @param {number} imageWidth - Image width.
         * @param {number} imageHeight - Image height.
         * @returns {Object|null} Leaflet layer group or null.
         */
        function generateGridLabels(L, rows, cols, imageWidth, imageHeight) {
            if (!rows || !cols) return null;
            const grid = L.layerGroup();
            const labels = L.layerGroup();
            const cellWidth = imageWidth / cols;
            const cellHeight = imageHeight / rows;

            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const x1 = c * cellWidth;
                    const y1 = r * cellHeight;
                    const x2 = x1 + cellWidth;
                    const y2 = y1 + cellHeight;

                    L.rectangle(
                        [
                            [y1, x1],
                            [y2, x2],
                        ],
                        { color: "#F3F4F5", weight: 1, fillOpacity: 0, interactive: false }
                    ).addTo(grid);

                    const colLabel = String.fromCharCode(65 + c); // A, B, C...
                    const rowLabel = r; // 0, 1, 2...
                    const label = `${colLabel}${rowLabel}`;
                    const topLeft = [y1, x1];

                    const marker = L.marker(topLeft, {
                        icon: L.divIcon({ className: "grid-label", html: label, iconAnchor: [0, 0] }),
                        interactive: false,
                    });

                    labels.addLayer(marker);
                }
            }
            return L.layerGroup([grid, labels]);
        }

        function loadMap(instance) {
            const L = instance.leaflet;
            const mapElement = document.getElementById(mapId);
            if (!mapElement) {
                console.error(`No map element found with ID '${mapId}'.`);
                return;
            }

            // helpers
            helpers.yx = L.latLng;
            helpers.xy = (x, y) => (Array.isArray(x) ? helpers.yx(x[1], x[0]) : helpers.yx(y, x));

            // Get map properties
            const baseMapLayer = mapElement.getAttribute("data-baselayer");
            const imageWidth = parseInt(mapElement.getAttribute("data-width"), 10);
            const imageHeight = parseInt(mapElement.getAttribute("data-height"), 10);
            const rows = parseInt(mapElement.getAttribute("data-grid-rows"), 10);
            const cols = parseInt(mapElement.getAttribute("data-grid-cols"), 10);
            const mapMaxZoom = parseInt(mapElement.getAttribute("data-max-zoom"), 10) || 3;
            const mapMinZoom = parseInt(mapElement.getAttribute("data-min-zoom"), 10) || 0;

            if (!baseMapLayer) {
                console.error("Map is missing the base layer.");
                return;
            }

            const southWest = helpers.xy(0, imageHeight);
            const northEast = helpers.xy(imageWidth, 0);
            const bounds = L.latLngBounds(southWest, northEast);
            const center = [imageHeight / 2, imageWidth / 2];
            const scale = Math.pow(2, -mapMaxZoom);
            const crs = L.CRS.Simple;
            crs.transformation = new L.Transformation(scale, 0, scale, 0);

            // Create the map instance
            map = new L.Map(mapId, {
                maxZoom: mapMaxZoom,
                minZoom: mapMinZoom,
                scrollWheelZoom: true, // Enable scroll zoom
                wheelPxPerZoomLevel: 80, // Slower zoom (default is 60)
                zoomSnap: 0.5, // Allows fractional zoom steps
                zoomDelta: 0.5, // Smaller zoom increments per wheel event
                crs: crs,
                attributionControl: false,
                zoomControl: false,
            });

            L.control.attribution({ prefix: "" }).addTo(map);
            L.control.zoom({ position: "topright" }).addTo(map);

            // Add the base layer
            const useMapTiles = /\/\{z\}\/\{x\}\/\{y\}\.[a-z]+$/.test(baseMapLayer);
            if (useMapTiles) {
                L.tileLayer(baseMapLayer, {
                    id: "basemap",
                    bounds: bounds,
                    maxNativeZoom: mapMaxZoom,
                    minZoom: mapMinZoom,
                    maxZoom: mapMaxZoom,
                    tileSize: 256,
                    noWrap: true,
                    attribution: "/TM/ 2025 Activision Publishing, Inc.",
                }).addTo(map);
            } else {
                L.imageOverlay(baseMapLayer, bounds, {
                    id: "basemap",
                    attribution: "/TM/ 2025 Activision Publishing, Inc.",
                }).addTo(map);
            }

            // Add additional layers
            addLayers(L, bounds, useMapTiles);

            const gridLayer = generateGridLabels(L, rows, cols, imageWidth, imageHeight);
            if (gridLayer) {
                layerGroups["grid"] = gridLayer;
                gridLayer.addTo(map);
            }

            // PLUGINS
            // Plugin - Mouse position
            L.control.mousePosition().addTo(map);

            // Show map
            const initZoom = mapMaxZoom > 2 ? 2 : mapMaxZoom;
            const offset = getDrawerOffset();
            map.setView(center, initZoom);
            map.panBy(new L.Point(-offset[0], -offset[1]), { animate: false });

            // Add the map to the global window object
            window.leafletInstance.map = map;
        }

        return {
            init,
            getMap,
            getOverlays,
            getOverlay,
            helpers,
            getDrawerOffset,
            panToOffset,
            layerGroups,
        };
    }

    function onDocumentReady() {
        const mapManager = createMapManager({ mapId: "map" });
        mapManager.init();
        ATVI.components.mapguide.MapManager = mapManager;
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})();

// markerManager.js

// Ensure namespace exists
window.ATVI = window.ATVI || {};
ATVI.components = ATVI.components || {};
ATVI.components.mapguide = ATVI.components.mapguide || {};
// var layerName = layerItem.getAttribute("data-layer-name");
(function () {
    function initMobileScrollbar(modal) {
        if (!modal) return;
        const scrollableEl = modal.querySelector(".marker-content");

        const simpleBarInstance = SimpleBar.instances.get(scrollableEl);
        if (simpleBarInstance) {
            simpleBarInstance.recalculate();
        } else {
            // edge condition where SimpleBar instance doesn't exist but is still active
            // remove items that get duplicated on init
            if (scrollableEl && scrollableEl.dataset.simplebar !== undefined) {
                modal.querySelector(".simplebar-track").remove();
                scrollableEl.removeAttribute("data-simplebar");
            }
            // Initialize scrollbar
            if (scrollableEl) {
                new SimpleBar(scrollableEl, {
                    autoHide: false,
                });
            }
        }
    }

    function createMarkerManager() {
        const {
            api: API,
            helpers: HELPERS,
            categories: CATEGORIES,
            MapManager: MAP_MANAGER,
            ModalManager: MODAL_MANAGER,
            menuHandlers: MENU_HANDLERS,
        } = ATVI.components.mapguide;
        const LAYER_GROUPS = MAP_MANAGER.layerGroups;

        function init() {
            if (typeof window.onLeafletReady === "function") {
                window.onLeafletReady((instance) => {
                    addMarkersToMap(instance);
                });
            } else {
                console.error("Leaflet registry not found.");
            }
        }

        //- ELEMENTS
        /**
         * Creates a colored marker icon.
         * @param {Object} opts - Options for the marker icon.
         * @param {number} opts.iconWidth - Width of the icon in pixels.
         * @param {number} opts.iconHeight - Height of the icon in pixels.
         * @param {string} opts.fillColor - Hex color string for the fill color, e.g. "#000000".
         * @param {string} opts.strokeColor - Hex color string for the stroke color, e.g. "#FFFFFF".
         * @param {string} opts.iconUrl - Optional URL for an image to overlay on the marker.
         * @param {Array} opts.iconOffset - Offset for the icon image, e.g. [5, 5].
         * @param {Array} opts.iconSize - Size of the icon image [x,y], e.g. ["24px", "24px"].
         * @returns {L.DivIcon} - The marker icon.
         */
        function createColorMarker(opts = {}) {
            // console.log("createColorMarker", opts);
            const L = leafletInstance.leaflet;
            const { icons: ICONS } = ATVI.components.mapguide;

            const {
                fillColor = "#000000",
                strokeColor = "#FFFFFF",
                iconWidth = 30,
                iconHeight = 40,
                iconOffset = [5, 5], // [0, 0]
                iconUrl,
                iconKey,
                iconSize = ["24px", "24px"],
                label = "marker",
            } = opts;

            function buildSvgTemplate() {
                const baseSvg = `
                    <svg width="${iconWidth}" height="${iconHeight}" viewBox="0 0 34 45" fill="none">
                        <path d="M17 1C25.8523 1 33 8.14772 33 17C33 19.3249 31.9671 22.1033 30.5459 24.8652C29.1081 27.6594 27.2012 30.5697 25.3115 33.1963C23.4192 35.8266 21.5292 38.1924 20.1133 39.8994C19.4049 40.7534 18.8147 41.4442 18.4004 41.9219C18.1932 42.1607 18.0297 42.3462 17.918 42.4727C17.8622 42.5358 17.8193 42.5843 17.79 42.6172C17.7754 42.6336 17.7635 42.6457 17.7559 42.6543C17.7521 42.6585 17.7491 42.6618 17.7471 42.6641C17.7461 42.6651 17.7457 42.6664 17.7451 42.667L17.7441 42.668L17 43.4961L16.2559 42.668C16.2553 42.6673 16.2539 42.6652 16.2529 42.6641C16.2509 42.6618 16.2479 42.6585 16.2441 42.6543C16.2365 42.6457 16.2246 42.6336 16.21 42.6172C16.1807 42.5843 16.1378 42.5358 16.082 42.4727C15.9703 42.3462 15.8068 42.1607 15.5996 41.9219C15.1853 41.4442 14.5951 40.7534 13.8867 39.8994C12.4708 38.1924 10.5808 35.8266 8.68848 33.1963C6.79882 30.5697 4.89192 27.6594 3.4541 24.8652C2.03289 22.1033 1 19.3249 1 17C1 8.14772 8.14772 1 17 1Z"
                        fill="${fillColor}" stroke="${strokeColor}" stroke-width="2"/>
                `;

                const iconSvg = ICONS[iconKey] || "";
                if (iconSvg) {
                    return `${baseSvg}${iconSvg}</svg>`;
                }

                if (iconUrl) {
                    const imageOverlay = `<image alt="${label}" href="${iconUrl}" x="${iconOffset[0]}" y="${iconOffset[1]}" width="${iconSize[0]}" height="${iconSize[1]}" />`;
                    return `${baseSvg}${iconSvg}${imageOverlay}</svg>`;
                }
                return `${baseSvg}</svg>`;
            }

            return L.divIcon({
                className: "color-marker",
                html: buildSvgTemplate(),
                iconSize: [iconWidth, iconHeight],
                iconAnchor: [iconWidth / 2, iconHeight],
                alt: label,
            });
        }
        /**
         * Creates a subcategory menu item element with label and toggle switch.
         *
         * @param {string} labelText - The text to display in the label.
         * @param {string} dataTarget - The unique identifier used for switch and title elements.
         * @param {string} iconHref - The URL of the icon to display.
         * @returns {HTMLElement} The constructed <li> element representing the subcategory item.
         */
        function createSubcategoryItem(labelText, dataTarget, iconHref) {
            const li = HELPERS.createElement("li", "subcategory-item subcategory-row active");
            li.appendChild(HELPERS.createElement("span", "spacer"));

            const label = HELPERS.createLabelWithIconAndTitle(`${dataTarget}-switch`, "subcategory-icon", iconHref, labelText, `${dataTarget}-title`);
            const inputSwitch = HELPERS.createSwitchWithHandlers(dataTarget, [
                MENU_HANDLERS.handleChangeToggleSwitchAnalytics,
                MENU_HANDLERS.handleChangeToggleSwitch,
            ]);

            li.appendChild(label);
            li.appendChild(inputSwitch);
            return li;
        }

        /**
         * Builds a category menu item with optional expandable subcategories.
         *
         * @param {string} category - The name of the category.
         * @param {Object} subcategories - An object mapping subcategory names to their data arrays.
         * @param {number} index - The index used for generating unique IDs.
         * @param {string} str - An optional string to append to the category ID.
         * @returns {HTMLElement} The constructed <li> element representing the category item.
         */
        function buildMenuItem(category, subcategories, index, str) {
            // console.log("buildMenuItem", category, subcategories, index, str);
            const subIsParent = Object.keys(subcategories).length === 1 && Object.keys(subcategories)[0] === category;
            const categoryIdString = HELPERS.formatToId(category);
            const dataTarget = str ? `${categoryIdString}-${str}` : categoryIdString;

            const li = HELPERS.createElement("li", "category-item active");
            const row = HELPERS.createElement("div", "category-row");

            const button = subcategories.length === 0 || subIsParent ? HELPERS.createElement("span", "spacer") : HELPERS.createExpandButton(index, dataTarget);

            if (button !== null && button.tagName === "BUTTON") {
                button.addEventListener("click", MENU_HANDLERS.handleExpandButtonClick);
            }

            const iconSvg = subIsParent
                ? CATEGORIES.getCategoryIconSvg(category) //subcategories[Object.keys(subcategories)[0]][0].options.iconSvg
                : CATEGORIES.getCategoryIconSvg(CATEGORIES.getByName(category)?.iconSvgKey);
            const iconUrl = subIsParent ? subcategories[Object.keys(subcategories)[0]][0].options.iconUrl : CATEGORIES.getByName(category)?.iconUrl;
            // console.log("subcat opts", subcategories[Object.keys(subcategories)[0]][0].options);
            // console.log("iconSvg", iconSvg);
            //HELPERS.findByNestedName(ATVI.components.mapguide.categories, category).value.iconUrl;

            const label = HELPERS.createLabelWithIconAndTitle(`${dataTarget}-switch`, "category-icon", iconUrl, category, `${dataTarget}-title`);
            const inputSwitch = HELPERS.createSwitchWithHandlers(dataTarget, [
                MENU_HANDLERS.handleChangeToggleSwitchAnalytics,
                MENU_HANDLERS.handleChangeToggleSwitch,
            ]);

            row.appendChild(button);
            row.appendChild(label);
            row.appendChild(inputSwitch);
            li.appendChild(row);

            if (!subIsParent) {
                const subcatList = HELPERS.createElement("ul", "subcategory-list", { id: dataTarget });
                subcatList.hidden = true;

                Object.entries(subcategories).forEach(([subcategory, subcategoryData]) => {
                    const subcategoryId = HELPERS.formatToId(subcategory);
                    const subItem = createSubcategoryItem(subcategory, `${subcategoryId}-${dataTarget}`, subcategoryData[0].options.iconUrl);
                    subcatList.appendChild(subItem);
                });

                li.appendChild(subcatList);
            }

            return li;
        }

        //- EVENT LISTENERS
        function handleMarkerClick(e) {
            const id = e.target.options.id;
            if (!id) return;

            MAP_MANAGER.panToOffset(e.latlng);

            API.getMarkerDetails(id)
                .then((details) => {
                    if (!details) return;
                    // console.log("Marker details:", details);
                    details.props = e.target.options.props;
                    details.iconUrl = e.target.options.iconUrl;

                    HELPERS.buildMarkerContent(details);

                    if (HELPERS.isMobileView()) {
                        const markerModal = document.getElementById("markerModal");
                        initMobileScrollbar(markerModal);
                        //modalManager.openModal("markerModal");
                        MODAL_MANAGER.openModal("markerModal");
                    } else {
                        const mapOverlay = document.querySelector(".map-overlay");
                        if (!mapOverlay.classList.contains("marker-initialized")) {
                            mapOverlay.classList.add("marker-initialized");
                        }
                        if (!mapOverlay.classList.contains("reader-collapsed")) {
                            MENU_HANDLERS.openDrawer();
                        }
                        if (mapOverlay.classList.contains("guide-open")) {
                            MENU_HANDLERS.showMarkerContent();
                        }
                    }
                    // make marker actions active with tabindex="0"
                    const markerActions = document.querySelectorAll(".marker-content-header__actions button");
                    markerActions.forEach((action) => {
                        action.setAttribute("tabindex", "0");
                    });
                })
                .catch((error) => {
                    console.error("Error fetching marker details:", error);
                });
        }

        function handleMarkerClickAnalytics(e) {
            if (!window.digitalData || !window.dataLayer) return;

            const pageName = digitalData.page.pageInfo.pageName;
            const markerData = e.target.options.props;

            if (markerData) {
                dataLayer.push({
                    action: "maps:marker-" + markerData.mapId,
                    category: "interaction:" + pageName,
                    event: "interaction",
                    label: "internal link",
                    link_text: markerData.name?.toLowerCase() || "unknown",
                    link_url: "internal link",
                    module: "map",
                });
            }
        }

        function addMarkersToMap(instance) {
            const L = instance.leaflet;
            const map = MAP_MANAGER.getMap();
            const pagePath = document.getElementById("map").getAttribute("data-pagePath");

            if (!map) return;

            API.getMapData(pagePath)
                .then((markers) => {
                    // console.log("Adding markers to map:", markers);
                    if (!markers) return;
                    const mapMode = document.querySelector(".map-overlay").getAttribute("data-map-mode");
                    const overlays = {};

                    markers.features.forEach((feature) => {
                        // console.log("feature", feature);
                        const coords = feature.geometry.coordinates;
                        const props = feature.properties;
                        const latlng = MAP_MANAGER.helpers.xy(coords);
                        const category = CATEGORIES.getCategory(props.category) || {};
                        // if no category, skip this marker
                        if (!category) {
                            console.warn(`No category found for marker ${props.mapId}. Skipping.`);
                            return;
                        }
                        // console.log(category);
                        const categoryName = category.name;
                        // props.category ? CATEGORIES[props.category].name : null;
                        const markerParentCategory = category.parentCategory || categoryName;
                        const iconKey = category.iconSvgKey || null;
                        const iconSvg = CATEGORIES.getCategoryIconSvg(category.iconSvgKey) || null;
                        const iconUrl = category.iconUrl;
                        const iconOffset = category.iconOffset;

                        if (!category) return;

                        overlays[markerParentCategory] = overlays[markerParentCategory] || {};
                        overlays[markerParentCategory][categoryName] = overlays[markerParentCategory][categoryName] || [];

                        let marker;
                        if (categoryName.startsWith("POI Label")) {
                            const textOnlyIcon = L.divIcon({
                                className: `text-marker ${categoryName === "POI Label Primary" ? "text-marker-primary" : "text-marker-secondary"}`,
                                html: `<span class='text-content' aria-label='${props.name}'>${props.name}</span>`,
                            });
                            marker = L.marker(latlng, { icon: textOnlyIcon, id: props.mapId, props, iconUrl, iconSvg });
                        } else {
                            const iconOptions = { iconKey, iconSvg, iconUrl, iconOffset, label: props.name };
                            marker = L.marker(latlng, { icon: createColorMarker(iconOptions), id: props.mapId, props, iconUrl });
                        }

                        // marker event handlers
                        if (marker) {
                            marker.on("add", function () {
                                this.getElement().setAttribute("data-marker-id", props.mapId);
                                this.getElement().setAttribute("aria-label", props.name);

                            });
                            marker.on("click", handleMarkerClickAnalytics);
                            marker.on("click", handleMarkerClick);
                            marker.on("mouseover", function () {
                                this.setZIndexOffset(1000);
                            });
                            marker.on("mouseout", function () {
                                this.setZIndexOffset(0);
                            });

                            overlays[markerParentCategory][categoryName].push(marker);
                        }
                    });

                    let sortedOverlays = null;
                    if (mapMode) {
                        sortedOverlays = CATEGORIES.sortOverlaysByOrder(overlays, mapMode);
                        // console.log("sortedOverlays", sortedOverlays);
                    }

                    Object.keys(sortedOverlays || overlays).forEach((parentCategory, index) => {
                        const categoryList = document.querySelectorAll(".map-menu__marker-menu .category-list");
                        const item = buildMenuItem(parentCategory, overlays[parentCategory], index);
                        const mobileItem = buildMenuItem(parentCategory, overlays[parentCategory], index, "mobile");

                        categoryList[0].appendChild(item);
                        categoryList[1].appendChild(mobileItem);

                        Object.keys(overlays[parentCategory]).forEach((category) => {
                            const group = L.layerGroup(overlays[parentCategory][category]);
                            LAYER_GROUPS[category] = group;
                            group.addTo(map);
                        });
                    });

                    document.getElementById("map").setAttribute("data-map-markers-initialized", "true");
                })
                .catch((error) => {
                    console.error("Error adding markers:", error);
                });
        }

        return {
            init: init,
            createColorMarker,
        };
    }
    function onDocumentReady() {
        const markerManager = createMarkerManager();
        markerManager.init();
        ATVI.components.mapguide.MarkerManager = markerManager;
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})();

// onMapReady.js
(function () {
    /**
     * Updates the "Skip to Main Content" link to point to the Guide.
     */
    function updateSkipToMainLink() {
        const skipLink = document.querySelector("a.skip-to-main-content-link");
        if (!skipLink) return;

        skipLink.href = "";
        skipLink.textContent = "Skip to Guide";
        skipLink.addEventListener("click", handleSkipLinkClick);
    }

    /**
     * Handles click on the updated skip link.
     */
    function handleSkipLinkClick(event) {
        event.preventDefault();
        const { helpers: HELPERS, menuHandlers: MENU_HANDLERS, mobileDrawer: MOBILE_DRAWER } = ATVI.components.mapguide;

        if (HELPERS.isMobileView()) {
            const guideTab = document.getElementById("tab-guide");
            MOBILE_DRAWER.activateTab(guideTab);
        } else {
            MENU_HANDLERS.openDrawer();
        }
    }

    /**
     * Loads marker settings based on URL parameters.
     */
    function loadMarkerFromParams(markerId) {
        if (!markerId) return;

        const markerElement = document.querySelector(`[data-marker-id="${markerId}"]`);
        if (markerElement) {
            markerElement.click();
        } else {
            console.warn("Marker element not found for ID:", markerId);
        }
    }

    // Restore layers from hash on load
    function loadLayersFromParams(layers) {
        if (!layers) return;
        const { MapManager: MAP_MANAGER } = ATVI.components.mapguide;

        const map = MAP_MANAGER.getMap();
        const overlays = MAP_MANAGER.getOverlays();

        var layerNames = layers.split(",");
        layerNames.forEach(function (name) {
            if (overlays[name]) map.addLayer(overlays[name]);
            if (baseLayers[name]) map.addLayer(baseLayers[name]);
        });
    }
    /**
     * Observes map initialization and triggers parameter loading.
     */
    function observeMapInitialization(markerId) {
        const mapElement = document.getElementById("map");
        if (!mapElement) return;

        const observer = new MutationObserver((mutations) => {
            for (const mutation of mutations) {
                if (mutation.type === "attributes" && mutation.attributeName.startsWith("data-")) {
                    if (mapElement.hasAttribute("data-map-markers-initialized")) {
                        loadMarkerFromParams(markerId);
                        observer.disconnect();
                        break;
                    }
                }
            }
        });

        observer.observe(mapElement, { attributes: true });
    }

    /**
     * Main document ready handler.
     */
    async function init(instance) {
        const L = instance.leaflet;
        updateSkipToMainLink();
        const urlParams = new URLSearchParams(window.location.search);
        const hasMarkerParam = urlParams.has("markerId");
        const hasLayersParam = urlParams.has("layers");

        if (hasLayersParam) {
            loadLayersFromParams(urlParams.get("layers"));
        }

        if (hasMarkerParam) {
            observeMapInitialization(urlParams.get("markerId"));
        }

        // TODO: Handle local storage settings or load defaults if needed.
    }

    function onDocumentReady() {
        if (typeof window.onLeafletReady === "function") {
            window.onLeafletReady((instance) => {
                init(instance);
            });
        } else {
            console.error("Leaflet registry not found.");
        }
    }

    document.readyState !== "loading" ? onDocumentReady() : document.addEventListener("DOMContentLoaded", onDocumentReady);
})();

